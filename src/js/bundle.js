//Mithril 1.1.6
//The MIT License (MIT)
//Copyright (c) 2017 Leo Horie
;(function(){"use strict"
function Vnode(tag,key,attrs0,children,text,dom){return{tag:tag,key:key,attrs:attrs0,children:children,text:text,dom:dom,domSize:undefined,state:undefined,_state:undefined,events:undefined,instance:undefined,skip:false}}
Vnode.normalize=function(node){if(Array.isArray(node))return Vnode("[",undefined,undefined,Vnode.normalizeChildren(node),undefined,undefined)
if(node!=null&&typeof node!=="object")return Vnode("#",undefined,undefined,node===false?"":node,undefined,undefined)
return node}
Vnode.normalizeChildren=function normalizeChildren(children){for(var i=0;i<children.length;i++){children[i]=Vnode.normalize(children[i])}
return children}
var selectorParser=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g
var selectorCache={}
var hasOwn={}.hasOwnProperty
function isEmpty(object){for(var key in object)if(hasOwn.call(object,key))return false
return true}
function compileSelector(selector){var match,tag="div",classes=[],attrs={}
while(match=selectorParser.exec(selector)){var type=match[1],value=match[2]
if(type===""&&value!=="")tag=value
else if(type==="#")attrs.id=value
else if(type===".")classes.push(value)
else if(match[3][0]==="["){var attrValue=match[6]
if(attrValue)attrValue=attrValue.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")
if(match[4]==="class")classes.push(attrValue)
else attrs[match[4]]=attrValue===""?attrValue:attrValue||true}}
if(classes.length>0)attrs.className=classes.join(" ")
return selectorCache[selector]={tag:tag,attrs:attrs}}
function execSelector(state,attrs,children){var hasAttrs=false,childList,text
var className=attrs.className||attrs.class
if(!isEmpty(state.attrs)&&!isEmpty(attrs)){var newAttrs={}
for(var key in attrs){if(hasOwn.call(attrs,key)){newAttrs[key]=attrs[key]}}
attrs=newAttrs}
for(var key in state.attrs){if(hasOwn.call(state.attrs,key)){attrs[key]=state.attrs[key]}}
if(className!==undefined){if(attrs.class!==undefined){attrs.class=undefined
attrs.className=className}
if(state.attrs.className!=null){attrs.className=state.attrs.className+" "+className}}
for(var key in attrs){if(hasOwn.call(attrs,key)&&key!=="key"){hasAttrs=true
break}}
if(Array.isArray(children)&&children.length===1&&children[0]!=null&&children[0].tag==="#"){text=children[0].children}else{childList=children}
return Vnode(state.tag,attrs.key,hasAttrs?attrs:undefined,childList,text)}
function hyperscript(selector){var attrs=arguments[1],start=2,children
if(selector==null||typeof selector!=="string"&&typeof selector!=="function"&&typeof selector.view!=="function"){throw Error("The selector must be either a string or a component.");}
if(typeof selector==="string"){var cached=selectorCache[selector]||compileSelector(selector)}
if(attrs==null){attrs={}}else if(typeof attrs!=="object"||attrs.tag!=null||Array.isArray(attrs)){attrs={}
start=1}
if(arguments.length===start+1){children=arguments[start]
if(!Array.isArray(children))children=[children]}else{children=[]
while(start<arguments.length)children.push(arguments[start++])}
var normalized=Vnode.normalizeChildren(children)
if(typeof selector==="string"){return execSelector(cached,attrs,normalized)}else{return Vnode(selector,attrs.key,attrs,normalized)}}
hyperscript.trust=function(html){if(html==null)html=""
return Vnode("<",undefined,undefined,html,undefined,undefined)}
hyperscript.fragment=function(attrs1,children){return Vnode("[",attrs1.key,attrs1,Vnode.normalizeChildren(children),undefined,undefined)}
var m=hyperscript
var PromisePolyfill=function(executor){if(!(this instanceof PromisePolyfill))throw new Error("Promise must be called with `new`")
if(typeof executor!=="function")throw new TypeError("executor must be a function")
var self=this,resolvers=[],rejectors=[],resolveCurrent=handler(resolvers,true),rejectCurrent=handler(rejectors,false)
var instance=self._instance={resolvers:resolvers,rejectors:rejectors}
var callAsync=typeof setImmediate==="function"?setImmediate:setTimeout
function handler(list,shouldAbsorb){return function execute(value){var then
try{if(shouldAbsorb&&value!=null&&(typeof value==="object"||typeof value==="function")&&typeof(then=value.then)==="function"){if(value===self)throw new TypeError("Promise can't be resolved w/ itself")
executeOnce(then.bind(value))}
else{callAsync(function(){if(!shouldAbsorb&&list.length===0)console.error("Possible unhandled promise rejection:",value)
for(var i=0;i<list.length;i++)list[i](value)
resolvers.length=0,rejectors.length=0
instance.state=shouldAbsorb
instance.retry=function(){execute(value)}})}}
catch(e){rejectCurrent(e)}}}
function executeOnce(then){var runs=0
function run(fn){return function(value){if(runs++>0)return
fn(value)}}
var onerror=run(rejectCurrent)
try{then(run(resolveCurrent),onerror)}catch(e){onerror(e)}}
executeOnce(executor)}
PromisePolyfill.prototype.then=function(onFulfilled,onRejection){var self=this,instance=self._instance
function handle(callback,list,next,state){list.push(function(value){if(typeof callback!=="function")next(value)
else try{resolveNext(callback(value))}catch(e){if(rejectNext)rejectNext(e)}})
if(typeof instance.retry==="function"&&state===instance.state)instance.retry()}
var resolveNext,rejectNext
var promise=new PromisePolyfill(function(resolve,reject){resolveNext=resolve,rejectNext=reject})
handle(onFulfilled,instance.resolvers,resolveNext,true),handle(onRejection,instance.rejectors,rejectNext,false)
return promise}
PromisePolyfill.prototype.catch=function(onRejection){return this.then(null,onRejection)}
PromisePolyfill.resolve=function(value){if(value instanceof PromisePolyfill)return value
return new PromisePolyfill(function(resolve){resolve(value)})}
PromisePolyfill.reject=function(value){return new PromisePolyfill(function(resolve,reject){reject(value)})}
PromisePolyfill.all=function(list){return new PromisePolyfill(function(resolve,reject){var total=list.length,count=0,values=[]
if(list.length===0)resolve([])
else for(var i=0;i<list.length;i++){(function(i){function consume(value){count++
values[i]=value
if(count===total)resolve(values)}
if(list[i]!=null&&(typeof list[i]==="object"||typeof list[i]==="function")&&typeof list[i].then==="function"){list[i].then(consume,reject)}
else consume(list[i])})(i)}})}
PromisePolyfill.race=function(list){return new PromisePolyfill(function(resolve,reject){for(var i=0;i<list.length;i++){list[i].then(resolve,reject)}})}
if(typeof window!=="undefined"){if(typeof window.Promise==="undefined")window.Promise=PromisePolyfill
var PromisePolyfill=window.Promise}else if(typeof global!=="undefined"){if(typeof global.Promise==="undefined")global.Promise=PromisePolyfill
var PromisePolyfill=global.Promise}else{}
var buildQueryString=function(object){if(Object.prototype.toString.call(object)!=="[object Object]")return""
var args=[]
for(var key0 in object){destructure(key0,object[key0])}
return args.join("&")
function destructure(key0,value){if(Array.isArray(value)){for(var i=0;i<value.length;i++){destructure(key0+"["+i+"]",value[i])}}
else if(Object.prototype.toString.call(value)==="[object Object]"){for(var i in value){destructure(key0+"["+i+"]",value[i])}}
else args.push(encodeURIComponent(key0)+(value!=null&&value!==""?"="+encodeURIComponent(value):""))}}
var FILE_PROTOCOL_REGEX=new RegExp("^file://","i")
var _8=function($window,Promise){var callbackCount=0
var oncompletion
function setCompletionCallback(callback){oncompletion=callback}
function finalizer(){var count=0
function complete(){if(--count===0&&typeof oncompletion==="function")oncompletion()}
return function finalize(promise0){var then0=promise0.then
promise0.then=function(){count++
var next=then0.apply(promise0,arguments)
next.then(complete,function(e){complete()
if(count===0)throw e})
return finalize(next)}
return promise0}}
function normalize(args,extra){if(typeof args==="string"){var url=args
args=extra||{}
if(args.url==null)args.url=url}
return args}
function request(args,extra){var finalize=finalizer()
args=normalize(args,extra)
var promise0=new Promise(function(resolve,reject){if(args.method==null)args.method="GET"
args.method=args.method.toUpperCase()
var useBody=(args.method==="GET"||args.method==="TRACE")?false:(typeof args.useBody==="boolean"?args.useBody:true)
if(typeof args.serialize!=="function")args.serialize=typeof FormData!=="undefined"&&args.data instanceof FormData?function(value){return value}:JSON.stringify
if(typeof args.deserialize!=="function")args.deserialize=deserialize
if(typeof args.extract!=="function")args.extract=extract
args.url=interpolate(args.url,args.data)
if(useBody)args.data=args.serialize(args.data)
else args.url=assemble(args.url,args.data)
var xhr=new $window.XMLHttpRequest(),aborted=false,_abort=xhr.abort
xhr.abort=function abort(){aborted=true
_abort.call(xhr)}
xhr.open(args.method,args.url,typeof args.async==="boolean"?args.async:true,typeof args.user==="string"?args.user:undefined,typeof args.password==="string"?args.password:undefined)
if(args.serialize===JSON.stringify&&useBody&&!(args.headers&&args.headers.hasOwnProperty("Content-Type"))){xhr.setRequestHeader("Content-Type","application/json; charset=utf-8")}
if(args.deserialize===deserialize&&!(args.headers&&args.headers.hasOwnProperty("Accept"))){xhr.setRequestHeader("Accept","application/json, text/*")}
if(args.withCredentials)xhr.withCredentials=args.withCredentials
for(var key in args.headers)if({}.hasOwnProperty.call(args.headers,key)){xhr.setRequestHeader(key,args.headers[key])}
if(typeof args.config==="function")xhr=args.config(xhr,args)||xhr
xhr.onreadystatechange=function(){if(aborted)return
if(xhr.readyState===4){try{var response=(args.extract!==extract)?args.extract(xhr,args):args.deserialize(args.extract(xhr,args))
if((xhr.status>=200&&xhr.status<300)||xhr.status===304||FILE_PROTOCOL_REGEX.test(args.url)){resolve(cast(args.type,response))}
else{var error=new Error(xhr.responseText)
for(var key in response)error[key]=response[key]
reject(error)}}
catch(e){reject(e)}}}
if(useBody&&(args.data!=null))xhr.send(args.data)
else xhr.send()})
return args.background===true?promise0:finalize(promise0)}
function jsonp(args,extra){var finalize=finalizer()
args=normalize(args,extra)
var promise0=new Promise(function(resolve,reject){var callbackName=args.callbackName||"_mithril_"+Math.round(Math.random()*1e16)+"_"+callbackCount++
var script=$window.document.createElement("script")
$window[callbackName]=function(data){script.parentNode.removeChild(script)
resolve(cast(args.type,data))
delete $window[callbackName]}
script.onerror=function(){script.parentNode.removeChild(script)
reject(new Error("JSONP request failed"))
delete $window[callbackName]}
if(args.data==null)args.data={}
args.url=interpolate(args.url,args.data)
args.data[args.callbackKey||"callback"]=callbackName
script.src=assemble(args.url,args.data)
$window.document.documentElement.appendChild(script)})
return args.background===true?promise0:finalize(promise0)}
function interpolate(url,data){if(data==null)return url
var tokens=url.match(/:[^\/]+/gi)||[]
for(var i=0;i<tokens.length;i++){var key=tokens[i].slice(1)
if(data[key]!=null){url=url.replace(tokens[i],data[key])}}
return url}
function assemble(url,data){var querystring=buildQueryString(data)
if(querystring!==""){var prefix=url.indexOf("?")<0?"?":"&"
url+=prefix+querystring}
return url}
function deserialize(data){try{return data!==""?JSON.parse(data):null}
catch(e){throw new Error(data)}}
function extract(xhr){return xhr.responseText}
function cast(type0,data){if(typeof type0==="function"){if(Array.isArray(data)){for(var i=0;i<data.length;i++){data[i]=new type0(data[i])}}
else return new type0(data)}
return data}
return{request:request,jsonp:jsonp,setCompletionCallback:setCompletionCallback}}
var requestService=_8(window,PromisePolyfill)
var coreRenderer=function($window){var $doc=$window.document
var $emptyFragment=$doc.createDocumentFragment()
var nameSpace={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"}
var onevent
function setEventCallback(callback){return onevent=callback}
function getNameSpace(vnode){return vnode.attrs&&vnode.attrs.xmlns||nameSpace[vnode.tag]}
function createNodes(parent,vnodes,start,end,hooks,nextSibling,ns){for(var i=start;i<end;i++){var vnode=vnodes[i]
if(vnode!=null){createNode(parent,vnode,hooks,ns,nextSibling)}}}
function createNode(parent,vnode,hooks,ns,nextSibling){var tag=vnode.tag
if(typeof tag==="string"){vnode.state={}
if(vnode.attrs!=null)initLifecycle(vnode.attrs,vnode,hooks)
switch(tag){case"#":return createText(parent,vnode,nextSibling)
case"<":return createHTML(parent,vnode,nextSibling)
case"[":return createFragment(parent,vnode,hooks,ns,nextSibling)
default:return createElement(parent,vnode,hooks,ns,nextSibling)}}
else return createComponent(parent,vnode,hooks,ns,nextSibling)}
function createText(parent,vnode,nextSibling){vnode.dom=$doc.createTextNode(vnode.children)
insertNode(parent,vnode.dom,nextSibling)
return vnode.dom}
function createHTML(parent,vnode,nextSibling){var match1=vnode.children.match(/^\s*?<(\w+)/im)||[]
var parent1={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[match1[1]]||"div"
var temp=$doc.createElement(parent1)
temp.innerHTML=vnode.children
vnode.dom=temp.firstChild
vnode.domSize=temp.childNodes.length
var fragment=$doc.createDocumentFragment()
var child
while(child=temp.firstChild){fragment.appendChild(child)}
insertNode(parent,fragment,nextSibling)
return fragment}
function createFragment(parent,vnode,hooks,ns,nextSibling){var fragment=$doc.createDocumentFragment()
if(vnode.children!=null){var children=vnode.children
createNodes(fragment,children,0,children.length,hooks,null,ns)}
vnode.dom=fragment.firstChild
vnode.domSize=fragment.childNodes.length
insertNode(parent,fragment,nextSibling)
return fragment}
function createElement(parent,vnode,hooks,ns,nextSibling){var tag=vnode.tag
var attrs2=vnode.attrs
var is=attrs2&&attrs2.is
ns=getNameSpace(vnode)||ns
var element=ns?is?$doc.createElementNS(ns,tag,{is:is}):$doc.createElementNS(ns,tag):is?$doc.createElement(tag,{is:is}):$doc.createElement(tag)
vnode.dom=element
if(attrs2!=null){setAttrs(vnode,attrs2,ns)}
insertNode(parent,element,nextSibling)
if(vnode.attrs!=null&&vnode.attrs.contenteditable!=null){setContentEditable(vnode)}
else{if(vnode.text!=null){if(vnode.text!=="")element.textContent=vnode.text
else vnode.children=[Vnode("#",undefined,undefined,vnode.text,undefined,undefined)]}
if(vnode.children!=null){var children=vnode.children
createNodes(element,children,0,children.length,hooks,null,ns)
setLateAttrs(vnode)}}
return element}
function initComponent(vnode,hooks){var sentinel
if(typeof vnode.tag.view==="function"){vnode.state=Object.create(vnode.tag)
sentinel=vnode.state.view
if(sentinel.$$reentrantLock$$!=null)return $emptyFragment
sentinel.$$reentrantLock$$=true}else{vnode.state=void 0
sentinel=vnode.tag
if(sentinel.$$reentrantLock$$!=null)return $emptyFragment
sentinel.$$reentrantLock$$=true
vnode.state=(vnode.tag.prototype!=null&&typeof vnode.tag.prototype.view==="function")?new vnode.tag(vnode):vnode.tag(vnode)}
vnode._state=vnode.state
if(vnode.attrs!=null)initLifecycle(vnode.attrs,vnode,hooks)
initLifecycle(vnode._state,vnode,hooks)
vnode.instance=Vnode.normalize(vnode._state.view.call(vnode.state,vnode))
if(vnode.instance===vnode)throw Error("A view cannot return the vnode it received as argument")
sentinel.$$reentrantLock$$=null}
function createComponent(parent,vnode,hooks,ns,nextSibling){initComponent(vnode,hooks)
if(vnode.instance!=null){var element=createNode(parent,vnode.instance,hooks,ns,nextSibling)
vnode.dom=vnode.instance.dom
vnode.domSize=vnode.dom!=null?vnode.instance.domSize:0
insertNode(parent,element,nextSibling)
return element}
else{vnode.domSize=0
return $emptyFragment}}
function updateNodes(parent,old,vnodes,recycling,hooks,nextSibling,ns){if(old===vnodes||old==null&&vnodes==null)return
else if(old==null)createNodes(parent,vnodes,0,vnodes.length,hooks,nextSibling,ns)
else if(vnodes==null)removeNodes(old,0,old.length,vnodes)
else{if(old.length===vnodes.length){var isUnkeyed=false
for(var i=0;i<vnodes.length;i++){if(vnodes[i]!=null&&old[i]!=null){isUnkeyed=vnodes[i].key==null&&old[i].key==null
break}}
if(isUnkeyed){for(var i=0;i<old.length;i++){if(old[i]===vnodes[i])continue
else if(old[i]==null&&vnodes[i]!=null)createNode(parent,vnodes[i],hooks,ns,getNextSibling(old,i+1,nextSibling))
else if(vnodes[i]==null)removeNodes(old,i,i+1,vnodes)
else updateNode(parent,old[i],vnodes[i],hooks,getNextSibling(old,i+1,nextSibling),recycling,ns)}
return}}
recycling=recycling||isRecyclable(old,vnodes)
if(recycling){var pool=old.pool
old=old.concat(old.pool)}
var oldStart=0,start=0,oldEnd=old.length-1,end=vnodes.length-1,map
while(oldEnd>=oldStart&&end>=start){var o=old[oldStart],v=vnodes[start]
if(o===v&&!recycling)oldStart++,start++
else if(o==null)oldStart++
else if(v==null)start++
else if(o.key===v.key){var shouldRecycle=(pool!=null&&oldStart>=old.length-pool.length)||((pool==null)&&recycling)
oldStart++,start++
updateNode(parent,o,v,hooks,getNextSibling(old,oldStart,nextSibling),shouldRecycle,ns)
if(recycling&&o.tag===v.tag)insertNode(parent,toFragment(o),nextSibling)}
else{var o=old[oldEnd]
if(o===v&&!recycling)oldEnd--,start++
else if(o==null)oldEnd--
else if(v==null)start++
else if(o.key===v.key){var shouldRecycle=(pool!=null&&oldEnd>=old.length-pool.length)||((pool==null)&&recycling)
updateNode(parent,o,v,hooks,getNextSibling(old,oldEnd+1,nextSibling),shouldRecycle,ns)
if(recycling||start<end)insertNode(parent,toFragment(o),getNextSibling(old,oldStart,nextSibling))
oldEnd--,start++}
else break}}
while(oldEnd>=oldStart&&end>=start){var o=old[oldEnd],v=vnodes[end]
if(o===v&&!recycling)oldEnd--,end--
else if(o==null)oldEnd--
else if(v==null)end--
else if(o.key===v.key){var shouldRecycle=(pool!=null&&oldEnd>=old.length-pool.length)||((pool==null)&&recycling)
updateNode(parent,o,v,hooks,getNextSibling(old,oldEnd+1,nextSibling),shouldRecycle,ns)
if(recycling&&o.tag===v.tag)insertNode(parent,toFragment(o),nextSibling)
if(o.dom!=null)nextSibling=o.dom
oldEnd--,end--}
else{if(!map)map=getKeyMap(old,oldEnd)
if(v!=null){var oldIndex=map[v.key]
if(oldIndex!=null){var movable=old[oldIndex]
var shouldRecycle=(pool!=null&&oldIndex>=old.length-pool.length)||((pool==null)&&recycling)
updateNode(parent,movable,v,hooks,getNextSibling(old,oldEnd+1,nextSibling),recycling,ns)
insertNode(parent,toFragment(movable),nextSibling)
old[oldIndex].skip=true
if(movable.dom!=null)nextSibling=movable.dom}
else{var dom=createNode(parent,v,hooks,ns,nextSibling)
nextSibling=dom}}
end--}
if(end<start)break}
createNodes(parent,vnodes,start,end+1,hooks,nextSibling,ns)
removeNodes(old,oldStart,oldEnd+1,vnodes)}}
function updateNode(parent,old,vnode,hooks,nextSibling,recycling,ns){var oldTag=old.tag,tag=vnode.tag
if(oldTag===tag){vnode.state=old.state
vnode._state=old._state
vnode.events=old.events
if(!recycling&&shouldNotUpdate(vnode,old))return
if(typeof oldTag==="string"){if(vnode.attrs!=null){if(recycling){vnode.state={}
initLifecycle(vnode.attrs,vnode,hooks)}
else updateLifecycle(vnode.attrs,vnode,hooks)}
switch(oldTag){case"#":updateText(old,vnode);break
case"<":updateHTML(parent,old,vnode,nextSibling);break
case"[":updateFragment(parent,old,vnode,recycling,hooks,nextSibling,ns);break
default:updateElement(old,vnode,recycling,hooks,ns)}}
else updateComponent(parent,old,vnode,hooks,nextSibling,recycling,ns)}
else{removeNode(old,null)
createNode(parent,vnode,hooks,ns,nextSibling)}}
function updateText(old,vnode){if(old.children.toString()!==vnode.children.toString()){old.dom.nodeValue=vnode.children}
vnode.dom=old.dom}
function updateHTML(parent,old,vnode,nextSibling){if(old.children!==vnode.children){toFragment(old)
createHTML(parent,vnode,nextSibling)}
else vnode.dom=old.dom,vnode.domSize=old.domSize}
function updateFragment(parent,old,vnode,recycling,hooks,nextSibling,ns){updateNodes(parent,old.children,vnode.children,recycling,hooks,nextSibling,ns)
var domSize=0,children=vnode.children
vnode.dom=null
if(children!=null){for(var i=0;i<children.length;i++){var child=children[i]
if(child!=null&&child.dom!=null){if(vnode.dom==null)vnode.dom=child.dom
domSize+=child.domSize||1}}
if(domSize!==1)vnode.domSize=domSize}}
function updateElement(old,vnode,recycling,hooks,ns){var element=vnode.dom=old.dom
ns=getNameSpace(vnode)||ns
if(vnode.tag==="textarea"){if(vnode.attrs==null)vnode.attrs={}
if(vnode.text!=null){vnode.attrs.value=vnode.text
vnode.text=undefined}}
updateAttrs(vnode,old.attrs,vnode.attrs,ns)
if(vnode.attrs!=null&&vnode.attrs.contenteditable!=null){setContentEditable(vnode)}
else if(old.text!=null&&vnode.text!=null&&vnode.text!==""){if(old.text.toString()!==vnode.text.toString())old.dom.firstChild.nodeValue=vnode.text}
else{if(old.text!=null)old.children=[Vnode("#",undefined,undefined,old.text,undefined,old.dom.firstChild)]
if(vnode.text!=null)vnode.children=[Vnode("#",undefined,undefined,vnode.text,undefined,undefined)]
updateNodes(element,old.children,vnode.children,recycling,hooks,null,ns)}}
function updateComponent(parent,old,vnode,hooks,nextSibling,recycling,ns){if(recycling){initComponent(vnode,hooks)}else{vnode.instance=Vnode.normalize(vnode._state.view.call(vnode.state,vnode))
if(vnode.instance===vnode)throw Error("A view cannot return the vnode it received as argument")
if(vnode.attrs!=null)updateLifecycle(vnode.attrs,vnode,hooks)
updateLifecycle(vnode._state,vnode,hooks)}
if(vnode.instance!=null){if(old.instance==null)createNode(parent,vnode.instance,hooks,ns,nextSibling)
else updateNode(parent,old.instance,vnode.instance,hooks,nextSibling,recycling,ns)
vnode.dom=vnode.instance.dom
vnode.domSize=vnode.instance.domSize}
else if(old.instance!=null){removeNode(old.instance,null)
vnode.dom=undefined
vnode.domSize=0}
else{vnode.dom=old.dom
vnode.domSize=old.domSize}}
function isRecyclable(old,vnodes){if(old.pool!=null&&Math.abs(old.pool.length-vnodes.length)<=Math.abs(old.length-vnodes.length)){var oldChildrenLength=old[0]&&old[0].children&&old[0].children.length||0
var poolChildrenLength=old.pool[0]&&old.pool[0].children&&old.pool[0].children.length||0
var vnodesChildrenLength=vnodes[0]&&vnodes[0].children&&vnodes[0].children.length||0
if(Math.abs(poolChildrenLength-vnodesChildrenLength)<=Math.abs(oldChildrenLength-vnodesChildrenLength)){return true}}
return false}
function getKeyMap(vnodes,end){var map={},i=0
for(var i=0;i<end;i++){var vnode=vnodes[i]
if(vnode!=null){var key2=vnode.key
if(key2!=null)map[key2]=i}}
return map}
function toFragment(vnode){var count0=vnode.domSize
if(count0!=null||vnode.dom==null){var fragment=$doc.createDocumentFragment()
if(count0>0){var dom=vnode.dom
while(--count0)fragment.appendChild(dom.nextSibling)
fragment.insertBefore(dom,fragment.firstChild)}
return fragment}
else return vnode.dom}
function getNextSibling(vnodes,i,nextSibling){for(;i<vnodes.length;i++){if(vnodes[i]!=null&&vnodes[i].dom!=null)return vnodes[i].dom}
return nextSibling}
function insertNode(parent,dom,nextSibling){if(nextSibling&&nextSibling.parentNode)parent.insertBefore(dom,nextSibling)
else parent.appendChild(dom)}
function setContentEditable(vnode){var children=vnode.children
if(children!=null&&children.length===1&&children[0].tag==="<"){var content=children[0].children
if(vnode.dom.innerHTML!==content)vnode.dom.innerHTML=content}
else if(vnode.text!=null||children!=null&&children.length!==0)throw new Error("Child node of a contenteditable must be trusted")}
function removeNodes(vnodes,start,end,context){for(var i=start;i<end;i++){var vnode=vnodes[i]
if(vnode!=null){if(vnode.skip)vnode.skip=false
else removeNode(vnode,context)}}}
function removeNode(vnode,context){var expected=1,called=0
if(vnode.attrs&&typeof vnode.attrs.onbeforeremove==="function"){var result=vnode.attrs.onbeforeremove.call(vnode.state,vnode)
if(result!=null&&typeof result.then==="function"){expected++
result.then(continuation,continuation)}}
if(typeof vnode.tag!=="string"&&typeof vnode._state.onbeforeremove==="function"){var result=vnode._state.onbeforeremove.call(vnode.state,vnode)
if(result!=null&&typeof result.then==="function"){expected++
result.then(continuation,continuation)}}
continuation()
function continuation(){if(++called===expected){onremove(vnode)
if(vnode.dom){var count0=vnode.domSize||1
if(count0>1){var dom=vnode.dom
while(--count0){removeNodeFromDOM(dom.nextSibling)}}
removeNodeFromDOM(vnode.dom)
if(context!=null&&vnode.domSize==null&&!hasIntegrationMethods(vnode.attrs)&&typeof vnode.tag==="string"){if(!context.pool)context.pool=[vnode]
else context.pool.push(vnode)}}}}}
function removeNodeFromDOM(node){var parent=node.parentNode
if(parent!=null)parent.removeChild(node)}
function onremove(vnode){if(vnode.attrs&&typeof vnode.attrs.onremove==="function")vnode.attrs.onremove.call(vnode.state,vnode)
if(typeof vnode.tag!=="string"){if(typeof vnode._state.onremove==="function")vnode._state.onremove.call(vnode.state,vnode)
if(vnode.instance!=null)onremove(vnode.instance)}else{var children=vnode.children
if(Array.isArray(children)){for(var i=0;i<children.length;i++){var child=children[i]
if(child!=null)onremove(child)}}}}
function setAttrs(vnode,attrs2,ns){for(var key2 in attrs2){setAttr(vnode,key2,null,attrs2[key2],ns)}}
function setAttr(vnode,key2,old,value,ns){var element=vnode.dom
if(key2==="key"||key2==="is"||(old===value&&!isFormAttribute(vnode,key2))&&typeof value!=="object"||typeof value==="undefined"||isLifecycleMethod(key2))return
var nsLastIndex=key2.indexOf(":")
if(nsLastIndex>-1&&key2.substr(0,nsLastIndex)==="xlink"){element.setAttributeNS("http://www.w3.org/1999/xlink",key2.slice(nsLastIndex+1),value)}
else if(key2[0]==="o"&&key2[1]==="n"&&typeof value==="function")updateEvent(vnode,key2,value)
else if(key2==="style")updateStyle(element,old,value)
else if(key2 in element&&!isAttribute(key2)&&ns===undefined&&!isCustomElement(vnode)){if(key2==="value"){var normalized0=""+value
if((vnode.tag==="input"||vnode.tag==="textarea")&&vnode.dom.value===normalized0&&vnode.dom===$doc.activeElement)return
if(vnode.tag==="select"){if(value===null){if(vnode.dom.selectedIndex===-1&&vnode.dom===$doc.activeElement)return}else{if(old!==null&&vnode.dom.value===normalized0&&vnode.dom===$doc.activeElement)return}}
if(vnode.tag==="option"&&old!=null&&vnode.dom.value===normalized0)return}
if(vnode.tag==="input"&&key2==="type"){element.setAttribute(key2,value)
return}
element[key2]=value}
else{if(typeof value==="boolean"){if(value)element.setAttribute(key2,"")
else element.removeAttribute(key2)}
else element.setAttribute(key2==="className"?"class":key2,value)}}
function setLateAttrs(vnode){var attrs2=vnode.attrs
if(vnode.tag==="select"&&attrs2!=null){if("value"in attrs2)setAttr(vnode,"value",null,attrs2.value,undefined)
if("selectedIndex"in attrs2)setAttr(vnode,"selectedIndex",null,attrs2.selectedIndex,undefined)}}
function updateAttrs(vnode,old,attrs2,ns){if(attrs2!=null){for(var key2 in attrs2){setAttr(vnode,key2,old&&old[key2],attrs2[key2],ns)}}
if(old!=null){for(var key2 in old){if(attrs2==null||!(key2 in attrs2)){if(key2==="className")key2="class"
if(key2[0]==="o"&&key2[1]==="n"&&!isLifecycleMethod(key2))updateEvent(vnode,key2,undefined)
else if(key2!=="key")vnode.dom.removeAttribute(key2)}}}}
function isFormAttribute(vnode,attr){return attr==="value"||attr==="checked"||attr==="selectedIndex"||attr==="selected"&&vnode.dom===$doc.activeElement}
function isLifecycleMethod(attr){return attr==="oninit"||attr==="oncreate"||attr==="onupdate"||attr==="onremove"||attr==="onbeforeremove"||attr==="onbeforeupdate"}
function isAttribute(attr){return attr==="href"||attr==="list"||attr==="form"||attr==="width"||attr==="height"}
function isCustomElement(vnode){return vnode.attrs.is||vnode.tag.indexOf("-")>-1}
function hasIntegrationMethods(source){return source!=null&&(source.oncreate||source.onupdate||source.onbeforeremove||source.onremove)}
function updateStyle(element,old,style){if(old===style)element.style.cssText="",old=null
if(style==null)element.style.cssText=""
else if(typeof style==="string")element.style.cssText=style
else{if(typeof old==="string")element.style.cssText=""
for(var key2 in style){element.style[key2]=style[key2]}
if(old!=null&&typeof old!=="string"){for(var key2 in old){if(!(key2 in style))element.style[key2]=""}}}}
function updateEvent(vnode,key2,value){var element=vnode.dom
var callback=typeof onevent!=="function"?value:function(e){var result=value.call(element,e)
onevent.call(element,e)
return result}
if(key2 in element)element[key2]=typeof value==="function"?callback:null
else{var eventName=key2.slice(2)
if(vnode.events===undefined)vnode.events={}
if(vnode.events[key2]===callback)return
if(vnode.events[key2]!=null)element.removeEventListener(eventName,vnode.events[key2],false)
if(typeof value==="function"){vnode.events[key2]=callback
element.addEventListener(eventName,vnode.events[key2],false)}}}
function initLifecycle(source,vnode,hooks){if(typeof source.oninit==="function")source.oninit.call(vnode.state,vnode)
if(typeof source.oncreate==="function")hooks.push(source.oncreate.bind(vnode.state,vnode))}
function updateLifecycle(source,vnode,hooks){if(typeof source.onupdate==="function")hooks.push(source.onupdate.bind(vnode.state,vnode))}
function shouldNotUpdate(vnode,old){var forceVnodeUpdate,forceComponentUpdate
if(vnode.attrs!=null&&typeof vnode.attrs.onbeforeupdate==="function")forceVnodeUpdate=vnode.attrs.onbeforeupdate.call(vnode.state,vnode,old)
if(typeof vnode.tag!=="string"&&typeof vnode._state.onbeforeupdate==="function")forceComponentUpdate=vnode._state.onbeforeupdate.call(vnode.state,vnode,old)
if(!(forceVnodeUpdate===undefined&&forceComponentUpdate===undefined)&&!forceVnodeUpdate&&!forceComponentUpdate){vnode.dom=old.dom
vnode.domSize=old.domSize
vnode.instance=old.instance
return true}
return false}
function render(dom,vnodes){if(!dom)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.")
var hooks=[]
var active=$doc.activeElement
var namespace=dom.namespaceURI
if(dom.vnodes==null)dom.textContent=""
if(!Array.isArray(vnodes))vnodes=[vnodes]
updateNodes(dom,dom.vnodes,Vnode.normalizeChildren(vnodes),false,hooks,null,namespace==="http://www.w3.org/1999/xhtml"?undefined:namespace)
dom.vnodes=vnodes
if(active!=null&&$doc.activeElement!==active)active.focus()
for(var i=0;i<hooks.length;i++)hooks[i]()}
return{render:render,setEventCallback:setEventCallback}}
function throttle(callback){var time=16
var last=0,pending=null
var timeout=typeof requestAnimationFrame==="function"?requestAnimationFrame:setTimeout
return function(){var now=Date.now()
if(last===0||now-last>=time){last=now
callback()}
else if(pending===null){pending=timeout(function(){pending=null
callback()
last=Date.now()},time-(now-last))}}}
var _11=function($window){var renderService=coreRenderer($window)
renderService.setEventCallback(function(e){if(e.redraw===false)e.redraw=undefined
else redraw()})
var callbacks=[]
function subscribe(key1,callback){unsubscribe(key1)
callbacks.push(key1,throttle(callback))}
function unsubscribe(key1){var index=callbacks.indexOf(key1)
if(index>-1)callbacks.splice(index,2)}
function redraw(){for(var i=1;i<callbacks.length;i+=2){callbacks[i]()}}
return{subscribe:subscribe,unsubscribe:unsubscribe,redraw:redraw,render:renderService.render}}
var redrawService=_11(window)
requestService.setCompletionCallback(redrawService.redraw)
var _16=function(redrawService0){return function(root,component){if(component===null){redrawService0.render(root,[])
redrawService0.unsubscribe(root)
return}
if(component.view==null&&typeof component!=="function")throw new Error("m.mount(element, component) expects a component, not a vnode")
var run0=function(){redrawService0.render(root,Vnode(component))}
redrawService0.subscribe(root,run0)
redrawService0.redraw()}}
m.mount=_16(redrawService)
var Promise=PromisePolyfill
var parseQueryString=function(string){if(string===""||string==null)return{}
if(string.charAt(0)==="?")string=string.slice(1)
var entries=string.split("&"),data0={},counters={}
for(var i=0;i<entries.length;i++){var entry=entries[i].split("=")
var key5=decodeURIComponent(entry[0])
var value=entry.length===2?decodeURIComponent(entry[1]):""
if(value==="true")value=true
else if(value==="false")value=false
var levels=key5.split(/\]\[?|\[/)
var cursor=data0
if(key5.indexOf("[")>-1)levels.pop()
for(var j=0;j<levels.length;j++){var level=levels[j],nextLevel=levels[j+1]
var isNumber=nextLevel==""||!isNaN(parseInt(nextLevel,10))
var isValue=j===levels.length-1
if(level===""){var key5=levels.slice(0,j).join()
if(counters[key5]==null)counters[key5]=0
level=counters[key5]++}
if(cursor[level]==null){cursor[level]=isValue?value:isNumber?[]:{}}
cursor=cursor[level]}}
return data0}
var coreRouter=function($window){var supportsPushState=typeof $window.history.pushState==="function"
var callAsync0=typeof setImmediate==="function"?setImmediate:setTimeout
function normalize1(fragment0){var data=$window.location[fragment0].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent)
if(fragment0==="pathname"&&data[0]!=="/")data="/"+data
return data}
var asyncId
function debounceAsync(callback0){return function(){if(asyncId!=null)return
asyncId=callAsync0(function(){asyncId=null
callback0()})}}
function parsePath(path,queryData,hashData){var queryIndex=path.indexOf("?")
var hashIndex=path.indexOf("#")
var pathEnd=queryIndex>-1?queryIndex:hashIndex>-1?hashIndex:path.length
if(queryIndex>-1){var queryEnd=hashIndex>-1?hashIndex:path.length
var queryParams=parseQueryString(path.slice(queryIndex+1,queryEnd))
for(var key4 in queryParams)queryData[key4]=queryParams[key4]}
if(hashIndex>-1){var hashParams=parseQueryString(path.slice(hashIndex+1))
for(var key4 in hashParams)hashData[key4]=hashParams[key4]}
return path.slice(0,pathEnd)}
var router={prefix:"#!"}
router.getPath=function(){var type2=router.prefix.charAt(0)
switch(type2){case"#":return normalize1("hash").slice(router.prefix.length)
case"?":return normalize1("search").slice(router.prefix.length)+normalize1("hash")
default:return normalize1("pathname").slice(router.prefix.length)+normalize1("search")+normalize1("hash")}}
router.setPath=function(path,data,options){var queryData={},hashData={}
path=parsePath(path,queryData,hashData)
if(data!=null){for(var key4 in data)queryData[key4]=data[key4]
path=path.replace(/:([^\/]+)/g,function(match2,token){delete queryData[token]
return data[token]})}
var query=buildQueryString(queryData)
if(query)path+="?"+query
var hash=buildQueryString(hashData)
if(hash)path+="#"+hash
if(supportsPushState){var state=options?options.state:null
var title=options?options.title:null
$window.onpopstate()
if(options&&options.replace)$window.history.replaceState(state,title,router.prefix+path)
else $window.history.pushState(state,title,router.prefix+path)}
else $window.location.href=router.prefix+path}
router.defineRoutes=function(routes,resolve,reject){function resolveRoute(){var path=router.getPath()
var params={}
var pathname=parsePath(path,params,params)
var state=$window.history.state
if(state!=null){for(var k in state)params[k]=state[k]}
for(var route0 in routes){var matcher=new RegExp("^"+route0.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"\/?$")
if(matcher.test(pathname)){pathname.replace(matcher,function(){var keys=route0.match(/:[^\/]+/g)||[]
var values=[].slice.call(arguments,1,-2)
for(var i=0;i<keys.length;i++){params[keys[i].replace(/:|\./g,"")]=decodeURIComponent(values[i])}
resolve(routes[route0],params,path,route0)})
return}}
reject(path,params)}
if(supportsPushState)$window.onpopstate=debounceAsync(resolveRoute)
else if(router.prefix.charAt(0)==="#")$window.onhashchange=resolveRoute
resolveRoute()}
return router}
var _20=function($window,redrawService0){var routeService=coreRouter($window)
var identity=function(v){return v}
var render1,component,attrs3,currentPath,lastUpdate
var route=function(root,defaultRoute,routes){if(root==null)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined")
var run1=function(){if(render1!=null)redrawService0.render(root,render1(Vnode(component,attrs3.key,attrs3)))}
var bail=function(path){if(path!==defaultRoute)routeService.setPath(defaultRoute,null,{replace:true})
else throw new Error("Could not resolve default route "+defaultRoute)}
routeService.defineRoutes(routes,function(payload,params,path){var update=lastUpdate=function(routeResolver,comp){if(update!==lastUpdate)return
component=comp!=null&&(typeof comp.view==="function"||typeof comp==="function")?comp:"div"
attrs3=params,currentPath=path,lastUpdate=null
render1=(routeResolver.render||identity).bind(routeResolver)
run1()}
if(payload.view||typeof payload==="function")update({},payload)
else{if(payload.onmatch){Promise.resolve(payload.onmatch(params,path)).then(function(resolved){update(payload,resolved)},bail)}
else update(payload,"div")}},bail)
redrawService0.subscribe(root,run1)}
route.set=function(path,data,options){if(lastUpdate!=null){options=options||{}
options.replace=true}
lastUpdate=null
routeService.setPath(path,data,options)}
route.get=function(){return currentPath}
route.prefix=function(prefix0){routeService.prefix=prefix0}
route.link=function(vnode1){vnode1.dom.setAttribute("href",routeService.prefix+vnode1.attrs.href)
vnode1.dom.onclick=function(e){if(e.ctrlKey||e.metaKey||e.shiftKey||e.which===2)return
e.preventDefault()
e.redraw=false
var href=this.getAttribute("href")
if(href.indexOf(routeService.prefix)===0)href=href.slice(routeService.prefix.length)
route.set(href,undefined,undefined)}}
route.param=function(key3){if(typeof attrs3!=="undefined"&&typeof key3!=="undefined")return attrs3[key3]
return attrs3}
return route}
m.route=_20(window,redrawService)
m.withAttr=function(attrName,callback1,context){return function(e){callback1.call(context||this,attrName in e.currentTarget?e.currentTarget[attrName]:e.currentTarget.getAttribute(attrName))}}
var _28=coreRenderer(window)
m.render=_28.render
m.redraw=redrawService.redraw
m.request=requestService.request
m.jsonp=requestService.jsonp
m.parseQueryString=parseQueryString
m.buildQueryString=buildQueryString
m.version="1.1.6"
m.vnode=Vnode
if(typeof module!=="undefined")module["exports"]=m
else window.m=m}());
//Mithril-Stream 1.1.0
//The MIT License (MIT)
//Copyright (c) 2017 Leo Horie
;(function(){"use strict"
var guid=0,HALT={}
function createStream(){function stream(){if(arguments.length>0&&arguments[0]!==HALT)updateStream(stream,arguments[0])
return stream._state.value}
initStream(stream)
if(arguments.length>0&&arguments[0]!==HALT)updateStream(stream,arguments[0])
return stream}
function initStream(stream){stream.constructor=createStream
stream._state={id:guid++,value:undefined,state:0,derive:undefined,recover:undefined,deps:{},parents:[],endStream:undefined,unregister:undefined}
stream.map=stream["fantasy-land/map"]=map,stream["fantasy-land/ap"]=ap,stream["fantasy-land/of"]=createStream
stream.valueOf=valueOf,stream.toJSON=toJSON,stream.toString=valueOf
Object.defineProperties(stream,{end:{get:function(){if(!stream._state.endStream){var endStream=createStream()
endStream.map(function(value){if(value===true){unregisterStream(stream)
endStream._state.unregister=function(){unregisterStream(endStream)}}
return value})
stream._state.endStream=endStream}
return stream._state.endStream}}})}
function updateStream(stream,value){updateState(stream,value)
for(var id in stream._state.deps)updateDependency(stream._state.deps[id],false)
if(stream._state.unregister!=null)stream._state.unregister()
finalize(stream)}
function updateState(stream,value){stream._state.value=value
stream._state.changed=true
if(stream._state.state!==2)stream._state.state=1}
function updateDependency(stream,mustSync){var state=stream._state,parents=state.parents
if(parents.length>0&&parents.every(active)&&(mustSync||parents.some(changed))){var value=stream._state.derive()
if(value===HALT)return false
updateState(stream,value)}}
function finalize(stream){stream._state.changed=false
for(var id in stream._state.deps)stream._state.deps[id]._state.changed=false}
function combine(fn,streams){if(!streams.every(valid))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream")
return initDependency(createStream(),streams,function(){return fn.apply(this,streams.concat([streams.filter(changed)]))})}
function initDependency(dep,streams,derive){var state=dep._state
state.derive=derive
state.parents=streams.filter(notEnded)
registerDependency(dep,state.parents)
updateDependency(dep,true)
return dep}
function registerDependency(stream,parents){for(var i=0;i<parents.length;i++){parents[i]._state.deps[stream._state.id]=stream
registerDependency(stream,parents[i]._state.parents)}}
function unregisterStream(stream){for(var i=0;i<stream._state.parents.length;i++){var parent=stream._state.parents[i]
delete parent._state.deps[stream._state.id]}
for(var id in stream._state.deps){var dependent=stream._state.deps[id]
var index=dependent._state.parents.indexOf(stream)
if(index>-1)dependent._state.parents.splice(index,1)}
stream._state.state=2
stream._state.deps={}}
function map(fn){return combine(function(stream){return fn(stream())},[this])}
function ap(stream){return combine(function(s1,s2){return s1()(s2())},[stream,this])}
function valueOf(){return this._state.value}
function toJSON(){return this._state.value!=null&&typeof this._state.value.toJSON==="function"?this._state.value.toJSON():this._state.value}
function valid(stream){return stream._state}
function active(stream){return stream._state.state===1}
function changed(stream){return stream._state.changed}
function notEnded(stream){return stream._state.state!==2}
function merge(streams){return combine(function(){return streams.map(function(s){return s()})},streams)}
function scan(reducer,seed,stream){var newStream=combine(function(s){return seed=reducer(seed,s._state.value)},[stream])
if(newStream._state.state===0)newStream(seed)
return newStream}
function scanMerge(tuples,seed){var streams=tuples.map(function(tuple){var stream=tuple[0]
if(stream._state.state===0)stream(undefined)
return stream})
var newStream=combine(function(){var changed=arguments[arguments.length-1]
streams.forEach(function(stream,idx){if(changed.indexOf(stream)>-1){seed=tuples[idx][1](seed,stream._state.value)}})
return seed},streams)
return newStream}
createStream["fantasy-land/of"]=createStream
createStream.merge=merge
createStream.combine=combine
createStream.scan=scan
createStream.scanMerge=scanMerge
createStream.HALT=HALT
window.stream=createStream;}());
//! moment.js
//! version : 2.20.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var e,i;function c(){return e.apply(null,arguments)}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function u(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function l(e){return void 0===e}function d(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _(e,t){for(var n in t)m(t,n)&&(e[n]=t[n]);return m(t,"toString")&&(e.toString=t.toString),m(t,"valueOf")&&(e.valueOf=t.valueOf),e}function y(e,t,n,s){return Ot(e,t,n,s,!0).utc()}function g(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function p(e){if(null==e._isValid){var t=g(e),n=i.call(t.parsedDateParts,function(e){return null!=e}),s=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(s=s&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function v(e){var t=y(NaN);return null!=e?_(g(t),e):g(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var r=c.momentProperties=[];function w(e,t){var n,s,i;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=g(t)),l(t._locale)||(e._locale=t._locale),0<r.length)for(n=0;n<r.length;n++)l(i=t[s=r[n]])||(e[s]=i);return e}var t=!1;function M(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,c.updateOffset(this),t=!1)}function S(e){return e instanceof M||null!=e&&null!=e._isAMomentObject}function D(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=D(t)),n}function a(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&k(e[s])!==k(t[s]))&&a++;return a+r}function Y(e){!1===c.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function n(i,r){var a=!0;return _(function(){if(null!=c.deprecationHandler&&c.deprecationHandler(null,i),a){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var s in e+="\n["+n+"] ",arguments[0])e+=s+": "+arguments[0][s]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}Y(i+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),a=!1}return r.apply(this,arguments)},r)}var s,O={};function T(e,t){null!=c.deprecationHandler&&c.deprecationHandler(e,t),O[e]||(Y(t),O[e]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function b(e,t){var n,s=_({},e);for(n in t)m(t,n)&&(u(e[n])&&u(t[n])?(s[n]={},_(s[n],e[n]),_(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)m(e,n)&&!m(t,n)&&u(e[n])&&(s[n]=_({},s[n]));return s}function P(e){null!=e&&this.set(e)}c.suppressDeprecationWarnings=!1,c.deprecationHandler=null,s=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)m(e,t)&&n.push(t);return n};var W={};function H(e,t){var n=e.toLowerCase();W[n]=W[n+"s"]=W[t]=e}function R(e){return"string"==typeof e?W[e]||W[e.toLowerCase()]:void 0}function C(e){var t,n,s={};for(n in e)m(e,n)&&(t=R(n))&&(s[t]=e[n]);return s}var F={};function L(e,t){F[e]=t}function U(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,G=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,V={},E={};function I(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(E[e]=i),t&&(E[t[0]]=function(){return U(i.apply(this,arguments),t[1],t[2])}),n&&(E[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function A(e,t){return e.isValid()?(t=j(t,e.localeData()),V[t]=V[t]||function(s){var e,i,t,r=s.match(N);for(e=0,i=r.length;e<i;e++)E[r[e]]?r[e]=E[r[e]]:r[e]=(t=r[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,n="";for(t=0;t<i;t++)n+=x(r[t])?r[t].call(e,s):r[t];return n}}(t),V[t](e)):e.localeData().invalidDate()}function j(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(G.lastIndex=0;0<=n&&G.test(e);)e=e.replace(G,s),G.lastIndex=0,n-=1;return e}var Z=/\d/,z=/\d\d/,$=/\d{3}/,q=/\d{4}/,J=/[+-]?\d{6}/,B=/\d\d?/,Q=/\d\d\d\d?/,X=/\d\d\d\d\d\d?/,K=/\d{1,3}/,ee=/\d{1,4}/,te=/[+-]?\d{1,6}/,ne=/\d+/,se=/[+-]?\d+/,ie=/Z|[+-]\d\d:?\d\d/gi,re=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,oe={};function ue(e,n,s){oe[e]=x(n)?n:function(e,t){return e&&s?s:n}}function le(e,t){return m(oe,e)?oe[e](t._strict,t._locale):new RegExp(de(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,i){return t||n||s||i})))}function de(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var he={};function ce(e,n){var t,s=n;for("string"==typeof e&&(e=[e]),d(n)&&(s=function(e,t){t[n]=k(e)}),t=0;t<e.length;t++)he[e[t]]=s}function fe(e,i){ce(e,function(e,t,n,s){n._w=n._w||{},i(e,n._w,n,s)})}var me=0,_e=1,ye=2,ge=3,pe=4,ve=5,we=6,Me=7,Se=8;function De(e){return ke(e)?366:365}function ke(e){return e%4==0&&e%100!=0||e%400==0}I("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),I(0,["YY",2],0,function(){return this.year()%100}),I(0,["YYYY",4],0,"year"),I(0,["YYYYY",5],0,"year"),I(0,["YYYYYY",6,!0],0,"year"),H("year","y"),L("year",1),ue("Y",se),ue("YY",B,z),ue("YYYY",ee,q),ue("YYYYY",te,J),ue("YYYYYY",te,J),ce(["YYYYY","YYYYYY"],me),ce("YYYY",function(e,t){t[me]=2===e.length?c.parseTwoDigitYear(e):k(e)}),ce("YY",function(e,t){t[me]=c.parseTwoDigitYear(e)}),ce("Y",function(e,t){t[me]=parseInt(e,10)}),c.parseTwoDigitYear=function(e){return k(e)+(68<k(e)?1900:2e3)};var Ye,Oe=Te("FullYear",!0);function Te(t,n){return function(e){return null!=e?(be(this,t,e),c.updateOffset(this,n),this):xe(this,t)}}function xe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function be(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ke(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Pe(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Pe(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?ke(e)?29:28:31-s%7%2}Ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},I("M",["MM",2],"Mo",function(){return this.month()+1}),I("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),I("MMMM",0,0,function(e){return this.localeData().months(this,e)}),H("month","M"),L("month",8),ue("M",B),ue("MM",B,z),ue("MMM",function(e,t){return t.monthsShortRegex(e)}),ue("MMMM",function(e,t){return t.monthsRegex(e)}),ce(["M","MM"],function(e,t){t[_e]=k(e)-1}),ce(["MMM","MMMM"],function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[_e]=i:g(n).invalidMonth=e});var We=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,He="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Re="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(!d(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Pe(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Fe(e){return null!=e?(Ce(this,e),c.updateOffset(this,!0),this):xe(this,"Month")}var Le=ae;var Ue=ae;function Ne(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=y([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=de(s[t]),i[t]=de(i[t]);for(t=0;t<24;t++)r[t]=de(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ge(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ve(e,t,n){var s=7+t-n;return-((7+Ge(e,0,s).getUTCDay()-t)%7)+s-1}function Ee(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ve(e,s,i);return o<=0?a=De(r=e-1)+o:o>De(e)?(r=e+1,a=o-De(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Ie(e,t,n){var s,i,r=Ve(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Ae(i=e.year()-1,t,n):a>Ae(e.year(),t,n)?(s=a-Ae(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Ae(e,t,n){var s=Ve(e,t,n),i=Ve(e+1,t,n);return(De(e)-s+i)/7}I("w",["ww",2],"wo","week"),I("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),L("week",5),L("isoWeek",5),ue("w",B),ue("ww",B,z),ue("W",B),ue("WW",B,z),fe(["w","ww","W","WW"],function(e,t,n,s){t[s.substr(0,1)]=k(e)});I("d",0,"do","day"),I("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),I("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),I("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),I("e",0,0,"weekday"),I("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ue("d",B),ue("e",B),ue("E",B),ue("dd",function(e,t){return t.weekdaysMinRegex(e)}),ue("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ue("dddd",function(e,t){return t.weekdaysRegex(e)}),fe(["dd","ddd","dddd"],function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),fe(["d","e","E"],function(e,t,n,s){t[s]=k(e)});var je="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Ze="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var ze="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var $e=ae;var qe=ae;var Je=ae;function Be(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=y([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=de(o[t]),u[t]=de(u[t]),l[t]=de(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Qe(){return this.hours()%12||12}function Xe(e,t){I(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ke(e,t){return t._meridiemParse}I("H",["HH",2],0,"hour"),I("h",["hh",2],0,Qe),I("k",["kk",2],0,function(){return this.hours()||24}),I("hmm",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)}),I("hmmss",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)+U(this.seconds(),2)}),I("Hmm",0,0,function(){return""+this.hours()+U(this.minutes(),2)}),I("Hmmss",0,0,function(){return""+this.hours()+U(this.minutes(),2)+U(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),H("hour","h"),L("hour",13),ue("a",Ke),ue("A",Ke),ue("H",B),ue("h",B),ue("k",B),ue("HH",B,z),ue("hh",B,z),ue("kk",B,z),ue("hmm",Q),ue("hmmss",X),ue("Hmm",Q),ue("Hmmss",X),ce(["H","HH"],ge),ce(["k","kk"],function(e,t,n){var s=k(e);t[ge]=24===s?0:s}),ce(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ce(["h","hh"],function(e,t,n){t[ge]=k(e),g(n).bigHour=!0}),ce("hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s)),g(n).bigHour=!0}),ce("hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i)),g(n).bigHour=!0}),ce("Hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s))}),ce("Hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i))});var et,tt=Te("Hours",!0),nt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:He,monthsShort:Re,week:{dow:0,doy:6},weekdays:je,weekdaysMin:ze,weekdaysShort:Ze,meridiemParse:/[ap]\.?m?\.?/i},st={},it={};function rt(e){return e?e.toLowerCase().replace("_","-"):e}function at(e){var t=null;if(!st[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=et._abbr,require("./locale/"+e),ot(t)}catch(e){}return st[e]}function ot(e,t){var n;return e&&((n=l(t)?lt(e):ut(e,t))?et=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),et._abbr}function ut(e,t){if(null!==t){var n,s=nt;if(t.abbr=e,null!=st[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=st[e]._config;else if(null!=t.parentLocale)if(null!=st[t.parentLocale])s=st[t.parentLocale]._config;else{if(null==(n=at(t.parentLocale)))return it[t.parentLocale]||(it[t.parentLocale]=[]),it[t.parentLocale].push({name:e,config:t}),null;s=n._config}return st[e]=new P(b(s,t)),it[e]&&it[e].forEach(function(e){ut(e.name,e.config)}),ot(e),st[e]}return delete st[e],null}function lt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return et;if(!o(e)){if(t=at(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=rt(e[r]).split("-")).length,n=(n=rt(e[r+1]))?n.split("-"):null;0<t;){if(s=at(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&a(i,n,!0)>=t-1)break;t--}r++}return et}(e)}function dt(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[_e]<0||11<n[_e]?_e:n[ye]<1||n[ye]>Pe(n[me],n[_e])?ye:n[ge]<0||24<n[ge]||24===n[ge]&&(0!==n[pe]||0!==n[ve]||0!==n[we])?ge:n[pe]<0||59<n[pe]?pe:n[ve]<0||59<n[ve]?ve:n[we]<0||999<n[we]?we:-1,g(e)._overflowDayOfYear&&(t<me||ye<t)&&(t=ye),g(e)._overflowWeeks&&-1===t&&(t=Me),g(e)._overflowWeekday&&-1===t&&(t=Se),g(e).overflow=t),e}function ht(e,t,n){return null!=e?e:null!=t?t:n}function ct(e){var t,n,s,i,r,a=[];if(!e._d){var o,u;for(o=e,u=new Date(c.now()),s=o._useUTC?[u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()]:[u.getFullYear(),u.getMonth(),u.getDate()],e._w&&null==e._a[ye]&&null==e._a[_e]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ht(t.GG,e._a[me],Ie(Tt(),1,4).year),s=ht(t.W,1),((i=ht(t.E,1))<1||7<i)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Ie(Tt(),r,a);n=ht(t.gg,e._a[me],l.year),s=ht(t.w,l.week),null!=t.d?((i=t.d)<0||6<i)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||6<t.e)&&(u=!0)):i=r}s<1||s>Ae(n,r,a)?g(e)._overflowWeeks=!0:null!=u?g(e)._overflowWeekday=!0:(o=Ee(n,s,i,r,a),e._a[me]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(r=ht(e._a[me],s[me]),(e._dayOfYear>De(r)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=Ge(r,0,e._dayOfYear),e._a[_e]=n.getUTCMonth(),e._a[ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=s[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ge]&&0===e._a[pe]&&0===e._a[ve]&&0===e._a[we]&&(e._nextDay=!0,e._a[ge]=0),e._d=(e._useUTC?Ge:function(e,t,n,s,i,r,a){var o=new Date(e,t,n,s,i,r,a);return e<100&&0<=e&&isFinite(o.getFullYear())&&o.setFullYear(e),o}).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ge]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}var ft=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_t=/Z|[+-]\d\d(?::?\d\d)?/,yt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],gt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pt=/^\/?Date\((\-?\d+)/i;function vt(e){var t,n,s,i,r,a,o=e._i,u=ft.exec(o)||mt.exec(o);if(u){for(g(e).iso=!0,t=0,n=yt.length;t<n;t++)if(yt[t][1].exec(u[1])){i=yt[t][0],s=!1!==yt[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=gt.length;t<n;t++)if(gt[t][1].exec(u[3])){r=(u[2]||" ")+gt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!_t.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),kt(e)}else e._isValid=!1}var wt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Mt(e,t,n,s,i,r){var a=[function(e){var t=parseInt(e,10);{if(t<=49)return 2e3+t;if(t<=999)return 1900+t}return t}(e),Re.indexOf(t),parseInt(n,10),parseInt(s,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}var St={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Dt(e){var t,n,s,i=wt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(i){var r=Mt(i[4],i[3],i[2],i[5],i[6],i[7]);if(t=i[1],n=r,s=e,t&&Ze.indexOf(t)!==new Date(n[0],n[1],n[2]).getDay()&&(g(s).weekdayMismatch=!0,!(s._isValid=!1)))return;e._a=r,e._tzm=function(e,t,n){if(e)return St[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(i[8],i[9],i[10]),e._d=Ge.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function kt(e){if(e._f!==c.ISO_8601)if(e._f!==c.RFC_2822){e._a=[],g(e).empty=!0;var t,n,s,i,r,a,o,u,l=""+e._i,d=l.length,h=0;for(s=j(e._f,e._locale).match(N)||[],t=0;t<s.length;t++)i=s[t],(n=(l.match(le(i,e))||[])[0])&&(0<(r=l.substr(0,l.indexOf(n))).length&&g(e).unusedInput.push(r),l=l.slice(l.indexOf(n)+n.length),h+=n.length),E[i]?(n?g(e).empty=!1:g(e).unusedTokens.push(i),a=i,u=e,null!=(o=n)&&m(he,a)&&he[a](o,u._a,u,a)):e._strict&&!n&&g(e).unusedTokens.push(i);g(e).charsLeftOver=d-h,0<l.length&&g(e).unusedInput.push(l),e._a[ge]<=12&&!0===g(e).bigHour&&0<e._a[ge]&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[ge]=function(e,t,n){var s;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0)),t)}(e._locale,e._a[ge],e._meridiem),ct(e),dt(e)}else Dt(e);else vt(e)}function Yt(e){var t,n,s,i,r=e._i,a=e._f;return e._locale=e._locale||lt(e._l),null===r||void 0===a&&""===r?v({nullInput:!0}):("string"==typeof r&&(e._i=r=e._locale.preparse(r)),S(r)?new M(dt(r)):(h(r)?e._d=r:o(a)?function(e){var t,n,s,i,r;if(0===e._f.length)return g(e).invalidFormat=!0,e._d=new Date(NaN);for(i=0;i<e._f.length;i++)r=0,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],kt(t),p(t)&&(r+=g(t).charsLeftOver,r+=10*g(t).unusedTokens.length,g(t).score=r,(null==s||r<s)&&(s=r,n=t));_(e,n||t)}(e):a?kt(e):l(n=(t=e)._i)?t._d=new Date(c.now()):h(n)?t._d=new Date(n.valueOf()):"string"==typeof n?(s=t,null===(i=pt.exec(s._i))?(vt(s),!1===s._isValid&&(delete s._isValid,Dt(s),!1===s._isValid&&(delete s._isValid,c.createFromInputFallback(s)))):s._d=new Date(+i[1])):o(n)?(t._a=f(n.slice(0),function(e){return parseInt(e,10)}),ct(t)):u(n)?function(e){if(!e._d){var t=C(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}(t):d(n)?t._d=new Date(n):c.createFromInputFallback(t),p(e)||(e._d=null),e))}function Ot(e,t,n,s,i){var r,a={};return!0!==n&&!1!==n||(s=n,n=void 0),(u(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=s,(r=new M(dt(Yt(a))))._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function Tt(e,t,n,s){return Ot(e,t,n,s,!1)}c.createFromInputFallback=n("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),c.ISO_8601=function(){},c.RFC_2822=function(){};var xt=n("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),bt=n("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:v()});function Pt(e,t){var n,s;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Tt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var Wt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ht(e){var t=C(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,d=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Ye.call(Wt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<Wt.length;++s)if(e[Wt[s]]){if(n)return!1;parseFloat(e[Wt[s]])!==k(e[Wt[s]])&&(n=!0)}return!0}(t),this._milliseconds=+d+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=lt(),this._bubble()}function Rt(e){return e instanceof Ht}function Ct(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,n){I(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+U(~~(e/60),2)+n+U(~~e%60,2)})}Ft("Z",":"),Ft("ZZ",""),ue("Z",re),ue("ZZ",re),ce(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ut(re,e)});var Lt=/([\+\-]|\d\d)/gi;function Ut(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match(Lt)||["-",0,0],i=60*s[1]+k(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Nt(e,t){var n,s;return t._isUTC?(n=t.clone(),s=(S(e)||h(e)?e.valueOf():Tt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+s),c.updateOffset(n,!1),n):Tt(e).local()}function Gt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Vt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}c.updateOffset=function(){};var Et=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,It=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function At(e,t){var n,s,i,r=e,a=null;return Rt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:d(e)?(r={},t?r[t]=e:r.milliseconds=e):(a=Et.exec(e))?(n="-"===a[1]?-1:1,r={y:0,d:k(a[ye])*n,h:k(a[ge])*n,m:k(a[pe])*n,s:k(a[ve])*n,ms:k(Ct(1e3*a[we]))*n}):(a=It.exec(e))?(n="-"===a[1]?-1:(a[1],1),r={y:jt(a[2],n),M:jt(a[3],n),w:jt(a[4],n),d:jt(a[5],n),h:jt(a[6],n),m:jt(a[7],n),s:jt(a[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(i=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=Nt(t,e),e.isBefore(t)?n=Zt(e,t):((n=Zt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Tt(r.from),Tt(r.to)),(r={}).ms=i.milliseconds,r.M=i.months),s=new Ht(r),Rt(e)&&m(e,"_locale")&&(s._locale=e._locale),s}function jt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function zt(s,i){return function(e,t){var n;return null===t||isNaN(+t)||(T(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),$t(this,At(e="string"==typeof e?+e:e,t),s),this}}function $t(e,t,n,s){var i=t._milliseconds,r=Ct(t._days),a=Ct(t._months);e.isValid()&&(s=null==s||s,a&&Ce(e,xe(e,"Month")+a*n),r&&be(e,"Date",xe(e,"Date")+r*n),i&&e._d.setTime(e._d.valueOf()+i*n),s&&c.updateOffset(e,r||a))}At.fn=Ht.prototype,At.invalid=function(){return At(NaN)};var qt=zt(1,"add"),Jt=zt(-1,"subtract");function Bt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(n+1,"months")-s)))||0}function Qt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=lt(e))&&(this._locale=t),this)}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xt=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Kt(){return this._locale}function en(e,t){I(0,[e,e.length],0,t)}function tn(e,t,n,s,i){var r;return null==e?Ie(this,s,i).year:((r=Ae(e,s,i))<t&&(t=r),function(e,t,n,s,i){var r=Ee(e,t,n,s,i),a=Ge(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,s,i))}I(0,["gg",2],0,function(){return this.weekYear()%100}),I(0,["GG",2],0,function(){return this.isoWeekYear()%100}),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ue("G",se),ue("g",se),ue("GG",B,z),ue("gg",B,z),ue("GGGG",ee,q),ue("gggg",ee,q),ue("GGGGG",te,J),ue("ggggg",te,J),fe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,s){t[s.substr(0,2)]=k(e)}),fe(["gg","GG"],function(e,t,n,s){t[s]=c.parseTwoDigitYear(e)}),I("Q",0,"Qo","quarter"),H("quarter","Q"),L("quarter",7),ue("Q",Z),ce("Q",function(e,t){t[_e]=3*(k(e)-1)}),I("D",["DD",2],"Do","date"),H("date","D"),L("date",9),ue("D",B),ue("DD",B,z),ue("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ce(["D","DD"],ye),ce("Do",function(e,t){t[ye]=k(e.match(B)[0])});var nn=Te("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),L("dayOfYear",4),ue("DDD",K),ue("DDDD",$),ce(["DDD","DDDD"],function(e,t,n){n._dayOfYear=k(e)}),I("m",["mm",2],0,"minute"),H("minute","m"),L("minute",14),ue("m",B),ue("mm",B,z),ce(["m","mm"],pe);var sn=Te("Minutes",!1);I("s",["ss",2],0,"second"),H("second","s"),L("second",15),ue("s",B),ue("ss",B,z),ce(["s","ss"],ve);var rn,an=Te("Seconds",!1);for(I("S",0,0,function(){return~~(this.millisecond()/100)}),I(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),I(0,["SSS",3],0,"millisecond"),I(0,["SSSS",4],0,function(){return 10*this.millisecond()}),I(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),I(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),I(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),I(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),I(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),H("millisecond","ms"),L("millisecond",16),ue("S",K,Z),ue("SS",K,z),ue("SSS",K,$),rn="SSSS";rn.length<=9;rn+="S")ue(rn,ne);function on(e,t){t[we]=k(1e3*("0."+e))}for(rn="S";rn.length<=9;rn+="S")ce(rn,on);var un=Te("Milliseconds",!1);I("z",0,0,"zoneAbbr"),I("zz",0,0,"zoneName");var ln=M.prototype;function dn(e){return e}ln.add=qt,ln.calendar=function(e,t){var n=e||Tt(),s=Nt(n,this).startOf("day"),i=c.calendarFormat(this,s)||"sameElse",r=t&&(x(t[i])?t[i].call(this,n):t[i]);return this.format(r||this.localeData().calendar(i,this,Tt(n)))},ln.clone=function(){return new M(this)},ln.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Nt(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=R(t)){case"year":r=Bt(this,s)/12;break;case"month":r=Bt(this,s);break;case"quarter":r=Bt(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:D(r)},ln.endOf=function(e){return void 0===(e=R(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},ln.format=function(e){e||(e=this.isUtc()?c.defaultFormatUtc:c.defaultFormat);var t=A(this,e);return this.localeData().postformat(t)},ln.from=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.fromNow=function(e){return this.from(Tt(),e)},ln.to=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.toNow=function(e){return this.to(Tt(),e)},ln.get=function(e){return x(this[e=R(e)])?this[e]():this},ln.invalidAt=function(){return g(this).overflow},ln.isAfter=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(l(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},ln.isBefore=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(l(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},ln.isBetween=function(e,t,n,s){return("("===(s=s||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===s[1]?this.isBefore(t,n):!this.isAfter(t,n))},ln.isSame=function(e,t){var n,s=S(e)?e:Tt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=R(t||"millisecond"))?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},ln.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},ln.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},ln.isValid=function(){return p(this)},ln.lang=Xt,ln.locale=Qt,ln.localeData=Kt,ln.max=bt,ln.min=xt,ln.parsingFlags=function(){return _({},g(this))},ln.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:F[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=C(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(x(this[e=R(e)]))return this[e](t);return this},ln.startOf=function(e){switch(e=R(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},ln.subtract=Jt,ln.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},ln.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},ln.toDate=function(){return new Date(this.valueOf())},ln.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||9999<n.year()?A(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):x(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",A(n,"Z")):A(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ln.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},ln.toJSON=function(){return this.isValid()?this.toISOString():null},ln.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ln.unix=function(){return Math.floor(this.valueOf()/1e3)},ln.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ln.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ln.year=Oe,ln.isLeapYear=function(){return ke(this.year())},ln.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ln.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},ln.quarter=ln.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},ln.month=Fe,ln.daysInMonth=function(){return Pe(this.year(),this.month())},ln.week=ln.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},ln.isoWeek=ln.isoWeeks=function(e){var t=Ie(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},ln.weeksInYear=function(){var e=this.localeData()._week;return Ae(this.year(),e.dow,e.doy)},ln.isoWeeksInYear=function(){return Ae(this.year(),1,4)},ln.date=nn,ln.day=ln.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,n,s=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-s,"d")):s},ln.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},ln.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=(n=e,s=this.localeData(),"string"==typeof n?s.weekdaysParse(n)%7||7:isNaN(n)?null:n);return this.day(this.day()%7?t:t-7)}return this.day()||7;var n,s},ln.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},ln.hour=ln.hours=tt,ln.minute=ln.minutes=sn,ln.second=ln.seconds=an,ln.millisecond=ln.milliseconds=un,ln.utcOffset=function(e,t,n){var s,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ut(re,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(s=Gt(this)),this._offset=e,this._isUTC=!0,null!=s&&this.add(s,"m"),i!==e&&(!t||this._changeInProgress?$t(this,At(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,c.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Gt(this)},ln.utc=function(e){return this.utcOffset(0,e)},ln.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Gt(this),"m")),this},ln.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ut(ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},ln.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Tt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},ln.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ln.isLocal=function(){return!!this.isValid()&&!this._isUTC},ln.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ln.isUtc=Vt,ln.isUTC=Vt,ln.zoneAbbr=function(){return this._isUTC?"UTC":""},ln.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ln.dates=n("dates accessor is deprecated. Use date instead.",nn),ln.months=n("months accessor is deprecated. Use month instead",Fe),ln.years=n("years accessor is deprecated. Use year instead",Oe),ln.zone=n("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),ln.isDSTShifted=n("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e={};if(w(e,this),(e=Yt(e))._a){var t=e._isUTC?y(e._a):Tt(e._a);this._isDSTShifted=this.isValid()&&0<a(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var hn=P.prototype;function cn(e,t,n,s){var i=lt(),r=y().set(s,t);return i[n](r,e)}function fn(e,t,n){if(d(e)&&(t=e,e=void 0),e=e||"",null!=t)return cn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=cn(e,s,n,"month");return i}function mn(e,t,n,s){"boolean"==typeof e?d(t)&&(n=t,t=void 0):(t=e,e=!1,d(n=t)&&(n=t,t=void 0)),t=t||"";var i,r=lt(),a=e?r._week.dow:0;if(null!=n)return cn(t,(n+a)%7,s,"day");var o=[];for(i=0;i<7;i++)o[i]=cn(t,(i+a)%7,s,"day");return o}hn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return x(s)?s.call(t,n):s},hn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(e){return this._ordinal.replace("%d",e)},hn.preparse=dn,hn.postformat=dn,hn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return x(i)?i(e,t,n,s):i.replace(/%d/i,e)},hn.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return x(n)?n(t):n.replace(/%s/i,t)},hn.set=function(e){var t,n;for(n in e)x(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||We).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone},hn.monthsShort=function(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[We.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=y([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=y([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},hn.monthsRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsStrictRegex:this._monthsRegex):(m(this,"_monthsRegex")||(this._monthsRegex=Ue),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(m(this,"_monthsShortRegex")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(e){return Ie(e,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone},hn.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},hn.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},hn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=y([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=y([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},hn.weekdaysRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(m(this,"_weekdaysRegex")||(this._weekdaysRegex=$e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Je),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},hn.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},ot("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),c.lang=n("moment.lang is deprecated. Use moment.locale instead.",ot),c.langData=n("moment.langData is deprecated. Use moment.localeData instead.",lt);var _n=Math.abs;function yn(e,t,n,s){var i=At(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function gn(e){return e<0?Math.floor(e):Math.ceil(e)}function pn(e){return 4800*e/146097}function vn(e){return 146097*e/4800}function wn(e){return function(){return this.as(e)}}var Mn=wn("ms"),Sn=wn("s"),Dn=wn("m"),kn=wn("h"),Yn=wn("d"),On=wn("w"),Tn=wn("M"),xn=wn("y");function bn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Pn=bn("milliseconds"),Wn=bn("seconds"),Hn=bn("minutes"),Rn=bn("hours"),Cn=bn("days"),Fn=bn("months"),Ln=bn("years");var Un=Math.round,Nn={ss:44,s:45,m:45,h:22,d:26,M:11};var Gn=Math.abs;function Vn(e){return(0<e)-(e<0)||+e}function En(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Gn(this._milliseconds)/1e3,s=Gn(this._days),i=Gn(this._months);t=D((e=D(n/60))/60),n%=60,e%=60;var r=D(i/12),a=i%=12,o=s,u=t,l=e,d=n?n.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var c=h<0?"-":"",f=Vn(this._months)!==Vn(h)?"-":"",m=Vn(this._days)!==Vn(h)?"-":"",_=Vn(this._milliseconds)!==Vn(h)?"-":"";return c+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(o?m+o+"D":"")+(u||l||d?"T":"")+(u?_+u+"H":"")+(l?_+l+"M":"")+(d?_+d+"S":"")}var In=Ht.prototype;return In.isValid=function(){return this._isValid},In.abs=function(){var e=this._data;return this._milliseconds=_n(this._milliseconds),this._days=_n(this._days),this._months=_n(this._months),e.milliseconds=_n(e.milliseconds),e.seconds=_n(e.seconds),e.minutes=_n(e.minutes),e.hours=_n(e.hours),e.months=_n(e.months),e.years=_n(e.years),this},In.add=function(e,t){return yn(this,e,t,1)},In.subtract=function(e,t){return yn(this,e,t,-1)},In.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=R(e))||"year"===e)return t=this._days+s/864e5,n=this._months+pn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(vn(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},In.asMilliseconds=Mn,In.asSeconds=Sn,In.asMinutes=Dn,In.asHours=kn,In.asDays=Yn,In.asWeeks=On,In.asMonths=Tn,In.asYears=xn,In.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},In._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return 0<=r&&0<=a&&0<=o||r<=0&&a<=0&&o<=0||(r+=864e5*gn(vn(o)+a),o=a=0),u.milliseconds=r%1e3,e=D(r/1e3),u.seconds=e%60,t=D(e/60),u.minutes=t%60,n=D(t/60),u.hours=n%24,o+=i=D(pn(a+=D(n/24))),a-=gn(vn(i)),s=D(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},In.clone=function(){return At(this)},In.get=function(e){return e=R(e),this.isValid()?this[e+"s"]():NaN},In.milliseconds=Pn,In.seconds=Wn,In.minutes=Hn,In.hours=Rn,In.days=Cn,In.weeks=function(){return D(this.days()/7)},In.months=Fn,In.years=Ln,In.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t,n,s,i,r,a,o,u,l,d,h,c=this.localeData(),f=(n=!e,s=c,i=At(t=this).abs(),r=Un(i.as("s")),a=Un(i.as("m")),o=Un(i.as("h")),u=Un(i.as("d")),l=Un(i.as("M")),d=Un(i.as("y")),(h=r<=Nn.ss&&["s",r]||r<Nn.s&&["ss",r]||a<=1&&["m"]||a<Nn.m&&["mm",a]||o<=1&&["h"]||o<Nn.h&&["hh",o]||u<=1&&["d"]||u<Nn.d&&["dd",u]||l<=1&&["M"]||l<Nn.M&&["MM",l]||d<=1&&["y"]||["yy",d])[2]=n,h[3]=0<+t,h[4]=s,function(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}.apply(null,h));return e&&(f=c.pastFuture(+this,f)),c.postformat(f)},In.toISOString=En,In.toString=En,In.toJSON=En,In.locale=Qt,In.localeData=Kt,In.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",En),In.lang=Xt,I("X",0,0,"unix"),I("x",0,0,"valueOf"),ue("x",se),ue("X",/[+-]?\d+(\.\d{1,3})?/),ce("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ce("x",function(e,t,n){n._d=new Date(k(e))}),c.version="2.22.1",e=Tt,c.fn=ln,c.min=function(){return Pt("isBefore",[].slice.call(arguments,0))},c.max=function(){return Pt("isAfter",[].slice.call(arguments,0))},c.now=function(){return Date.now?Date.now():+new Date},c.utc=y,c.unix=function(e){return Tt(1e3*e)},c.months=function(e,t){return fn(e,t,"months")},c.isDate=h,c.locale=ot,c.invalid=v,c.duration=At,c.isMoment=S,c.weekdays=function(e,t,n){return mn(e,t,n,"weekdays")},c.parseZone=function(){return Tt.apply(null,arguments).parseZone()},c.localeData=lt,c.isDuration=Rt,c.monthsShort=function(e,t){return fn(e,t,"monthsShort")},c.weekdaysMin=function(e,t,n){return mn(e,t,n,"weekdaysMin")},c.defineLocale=ut,c.updateLocale=function(e,t){if(null!=t){var n,s,i=nt;null!=(s=at(e))&&(i=s._config),(n=new P(t=b(i,t))).parentLocale=st[e],st[e]=n,ot(e)}else null!=st[e]&&(null!=st[e].parentLocale?st[e]=st[e].parentLocale:null!=st[e]&&delete st[e]);return st[e]},c.locales=function(){return s(st)},c.weekdaysShort=function(e,t,n){return mn(e,t,n,"weekdaysShort")},c.normalizeUnits=R,c.relativeTimeRounding=function(e){return void 0===e?Un:"function"==typeof e&&(Un=e,!0)},c.relativeTimeThreshold=function(e,t){return void 0!==Nn[e]&&(void 0===t?Nn[e]:(Nn[e]=t,"s"===e&&(Nn.ss=t-1),!0))},c.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},c.prototype=ln,c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},c});
//  Ramda v0.19.1
//  https://github.com/ramda/ramda
//  (c) 2013-2016 Scott Sauyet, Michael Hurley, and David Chambers
//  Ramda may be freely distributed under the MIT license.

(function(){"use strict";var t={"@@functional/placeholder":!0},n=function(t,n){switch(t){case 0:return function(){return n.apply(this,arguments)};case 1:return function(t){return n.apply(this,arguments)};case 2:return function(t,r){return n.apply(this,arguments)};case 3:return function(t,r,e){return n.apply(this,arguments)};case 4:return function(t,r,e,u){return n.apply(this,arguments)};case 5:return function(t,r,e,u,i){return n.apply(this,arguments)};case 6:return function(t,r,e,u,i,o){return n.apply(this,arguments)};case 7:return function(t,r,e,u,i,o,c){return n.apply(this,arguments)};case 8:return function(t,r,e,u,i,o,c,s){return n.apply(this,arguments)};case 9:return function(t,r,e,u,i,o,c,s,a){return n.apply(this,arguments)};case 10:return function(t,r,e,u,i,o,c,s,a,f){return n.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},r=function(t){for(var n,r=[];!(n=t.next()).done;)r.push(n.value);return r},e=function(t){return new RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""))},u=function(t){return function(){return!t.apply(this,arguments)}},i=function(t,n){t=t||[],n=n||[];var r,e=t.length,u=n.length,i=[];for(r=0;e>r;)i[i.length]=t[r],r+=1;for(r=0;u>r;)i[i.length]=n[r],r+=1;return i},o=function(t,n,r){for(var e=0,u=r.length;u>e;){if(t(n,r[e]))return!0;e+=1}return!1},c=function(t,n){for(var r=0,e=n.length,u=[];e>r;)t(n[r])&&(u[u.length]=n[r]),r+=1;return u},s=function(t){return{"@@transducer/value":t,"@@transducer/reduced":!0}},a=function(t,n){return Object.prototype.hasOwnProperty.call(n,t)},f=function(t){return t},l=function(){var t=Object.prototype.toString;return"[object Arguments]"===t.call(arguments)?function(n){return"[object Arguments]"===t.call(n)}:function(t){return a("callee",t)}}(),p=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)},h=Number.isInteger||function(t){return t<<0===t},g=function(t){return"[object Number]"===Object.prototype.toString.call(t)},d=function(t){return"[object Object]"===Object.prototype.toString.call(t)},y=function(t){return null!=t&&"object"==typeof t&&t["@@functional/placeholder"]===!0},m=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},v=function(t){return"[object String]"===Object.prototype.toString.call(t)},x=function(t){return"function"==typeof t["@@transducer/step"]},b=function(t,n){for(var r=0,e=n.length,u=Array(e);e>r;)u[r]=t(n[r]),r+=1;return u},w=function(t){return[t]},j=function(t,n){return function(){return n.call(this,t.apply(this,arguments))}},O=function(t,n){return function(){var r=this;return t.apply(r,arguments).then(function(t){return n.call(r,t)})}},A=function(t){var n=t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return'"'+n.replace(/"/g,'\\"')+'"'},S=function(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}},E=function Iu(t,n,r){switch(arguments.length){case 1:return Iu(t,0,t.length);case 2:return Iu(t,n,t.length);default:for(var e=[],u=0,i=Math.max(0,Math.min(t.length,r)-n);i>u;)e[u]=t[n+u],u+=1;return e}},k=function(){var t=function(t){return(10>t?"0":"")+t};return"function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(n){return n.getUTCFullYear()+"-"+t(n.getUTCMonth()+1)+"-"+t(n.getUTCDate())+"T"+t(n.getUTCHours())+":"+t(n.getUTCMinutes())+":"+t(n.getUTCSeconds())+"."+(n.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),N={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}},I=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,n){return this.f(t,n)},function(n){return new t(n)}}(),q=function(t,n){for(var r=0,e=n.length-(t-1),u=new Array(e>=0?e:0);e>r;)u[r]=E(n,r,r+t),r+=1;return u},W=function(t,n){return function(){var r=arguments.length;if(0===r)return n();var e=arguments[r-1];return p(e)||"function"!=typeof e[t]?n.apply(this,arguments):e[t].apply(e,E(arguments,0,r-1))}},P=function(t){return function n(r){return 0===arguments.length||y(r)?n:t.apply(this,arguments)}},C=function(t){return function n(r,e){switch(arguments.length){case 0:return n;case 1:return y(r)?n:P(function(n){return t(r,n)});default:return y(r)&&y(e)?n:y(r)?P(function(n){return t(n,e)}):y(e)?P(function(n){return t(r,n)}):t(r,e)}}},M=function(t){return function n(r,e,u){switch(arguments.length){case 0:return n;case 1:return y(r)?n:C(function(n,e){return t(r,n,e)});case 2:return y(r)&&y(e)?n:y(r)?C(function(n,r){return t(n,e,r)}):y(e)?C(function(n,e){return t(r,n,e)}):P(function(n){return t(r,e,n)});default:return y(r)&&y(e)&&y(u)?n:y(r)&&y(e)?C(function(n,r){return t(n,r,u)}):y(r)&&y(u)?C(function(n,r){return t(n,e,r)}):y(e)&&y(u)?C(function(n,e){return t(r,n,e)}):y(r)?P(function(n){return t(n,e,u)}):y(e)?P(function(n){return t(r,n,u)}):y(u)?P(function(n){return t(r,e,n)}):t(r,e,u)}}},R=function qu(t,r,e){return function(){for(var u=[],i=0,o=t,c=0;c<r.length||i<arguments.length;){var s;c<r.length&&(!y(r[c])||i>=arguments.length)?s=r[c]:(s=arguments[i],i+=1),u[c]=s,y(s)||(o-=1),c+=1}return 0>=o?e.apply(this,u):n(o,qu(t,u,e))}},U=function(t,n,r){return function(){var e=arguments.length;if(0===e)return r();var u=arguments[e-1];if(!p(u)){var i=E(arguments,0,e-1);if("function"==typeof u[t])return u[t].apply(u,i);if(x(u)){var o=n.apply(null,i);return o(u)}}return r.apply(this,arguments)}},B=function(t,n){for(var r=n.length-1;r>=0&&t(n[r]);)r-=1;return E(n,0,r+1)},T=function(){function t(t,n){this.xf=n,this.f=t,this.all=!0}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.f(n)||(this.all=!1,t=S(this.xf["@@transducer/step"](t,!1))),t},C(function(n,r){return new t(n,r)})}(),L=function(){function t(t,n){this.xf=n,this.f=t,this.any=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.any||(t=this.xf["@@transducer/step"](t,!1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.f(n)&&(this.any=!0,t=S(this.xf["@@transducer/step"](t,!0))),t},C(function(n,r){return new t(n,r)})}(),F=function(){function t(t,n){this.xf=n,this.pos=0,this.full=!1,this.acc=new Array(t)}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.acc=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.store(n),this.full?this.xf["@@transducer/step"](t,this.getCopy()):t},t.prototype.store=function(t){this.acc[this.pos]=t,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},t.prototype.getCopy=function(){return i(E(this.acc,this.pos),E(this.acc,0,this.pos))},C(function(n,r){return new t(n,r)})}(),D=function(){function t(t,n){this.xf=n,this.n=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,n){return this.n>0?(this.n-=1,t):this.xf["@@transducer/step"](t,n)},C(function(n,r){return new t(n,r)})}(),V=function(){function t(t,n){this.xf=n,this.pos=0,this.full=!1,this.acc=new Array(t)}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.acc=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.full&&(t=this.xf["@@transducer/step"](t,this.acc[this.pos])),this.store(n),t},t.prototype.store=function(t){this.acc[this.pos]=t,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},C(function(n,r){return new t(n,r)})}(),z=function(){function t(t,n){this.xf=n,this.pred=t,this.lastValue=void 0,this.seenFirstValue=!1}return t.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){var r=!1;return this.seenFirstValue?this.pred(this.lastValue,n)&&(r=!0):this.seenFirstValue=!0,this.lastValue=n,r?t:this.xf["@@transducer/step"](t,n)},C(function(n,r){return new t(n,r)})}(),K=function(){function t(t,n){this.xf=n,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,n){if(this.f){if(this.f(n))return t;this.f=null}return this.xf["@@transducer/step"](t,n)},C(function(n,r){return new t(n,r)})}(),_=function(){function t(t,n){this.xf=n,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.xf["@@transducer/step"](t,n):t},C(function(n,r){return new t(n,r)})}(),$=function(){function t(t,n){this.xf=n,this.f=t,this.found=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,void 0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.f(n)&&(this.found=!0,t=S(this.xf["@@transducer/step"](t,n))),t},C(function(n,r){return new t(n,r)})}(),H=function(){function t(t,n){this.xf=n,this.f=t,this.idx=-1,this.found=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,-1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.idx+=1,this.f(n)&&(this.found=!0,t=S(this.xf["@@transducer/step"](t,this.idx))),t},C(function(n,r){return new t(n,r)})}(),X=function(){function t(t,n){this.xf=n,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.last))},t.prototype["@@transducer/step"]=function(t,n){return this.f(n)&&(this.last=n),t},C(function(n,r){return new t(n,r)})}(),Y=function(){function t(t,n){this.xf=n,this.f=t,this.idx=-1,this.lastIdx=-1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.lastIdx))},t.prototype["@@transducer/step"]=function(t,n){return this.idx+=1,this.f(n)&&(this.lastIdx=this.idx),t},C(function(n,r){return new t(n,r)})}(),Z=function(){function t(t,n){this.xf=n,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,n){return this.xf["@@transducer/step"](t,this.f(n))},C(function(n,r){return new t(n,r)})}(),G=function(){function t(t,n){this.xf=n,this.n=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,n){return 0===this.n?S(t):(this.n-=1,this.xf["@@transducer/step"](t,n))},C(function(n,r){return new t(n,r)})}(),J=function(){function t(t,n){this.xf=n,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.xf["@@transducer/step"](t,n):S(t)},C(function(n,r){return new t(n,r)})}(),Q=C(function(t,n){return t+n}),tt=M(function(t,n,r){if(n>=r.length||n<-r.length)return r;var e=0>n?r.length:0,u=e+n,o=i(r);return o[u]=t(r[u]),o}),nt=C(U("all",T,function(t,n){for(var r=0;r<n.length;){if(!t(n[r]))return!1;r+=1}return!0})),rt=P(function(t){return function(){return t}}),et=C(function(t,n){return t&&n}),ut=C(U("any",L,function(t,n){for(var r=0;r<n.length;){if(t(n[r]))return!0;r+=1}return!1})),it=C(U("aperture",F,q)),ot=C(function(t,n){return i(n,[t])}),ct=C(function(t,n){return t.apply(this,n)}),st=M(function(t,n,r){var e={};for(var u in r)e[u]=r[u];return e[t]=n,e}),at=M(function Wu(t,n,r){switch(t.length){case 0:return n;case 1:return st(t[0],n,r);default:return st(t[0],Wu(E(t,1),n,Object(r[t[0]])),r)}}),ft=C(function(t,r){return n(t.length,function(){return t.apply(r,arguments)})}),lt=C(function(t,n){return function(){return t.apply(this,arguments)&&n.apply(this,arguments)}}),pt=P(function(t){return function(n,r){return t(n,r)?-1:t(r,n)?1:0}}),ht=P(function(t){return function(){for(var n=0;n<t.length;){if(t[n][0].apply(this,arguments))return t[n][1].apply(this,arguments);n+=1}}}),gt=C(function(t,n){for(var r={},e=n.length,u=0;e>u;){var i=t(n[u]);r[i]=(a(i,r)?r[i]:0)+1,u+=1}return r}),dt=C(function(t,r){return 1===t?P(r):n(t,R(t,[],r))}),yt=Q(-1),mt=C(function(t,n){return null==n||n!==n?t:n}),vt=M(function(t,n,r){for(var e=[],u=0,i=n.length;i>u;)o(t,n[u],r)||o(t,n[u],e)||e.push(n[u]),u+=1;return e}),xt=C(function(t,n){var r={};for(var e in n)e!==t&&(r[e]=n[e]);return r}),bt=C(function Pu(t,n){switch(t.length){case 0:return n;case 1:return xt(t[0],n);default:var r=t[0],e=E(t,1);return null==n[r]?n:st(r,Pu(e,n[r]),n)}}),wt=C(function(t,n){return t/n}),jt=C(U("dropWhile",K,function(t,n){for(var r=0,e=n.length;e>r&&t(n[r]);)r+=1;return E(n,r)})),Ot=C(function(t,n){return function(){return t.apply(this,arguments)||n.apply(this,arguments)}}),At=P(function(t){return null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():p(t)?[]:v(t)?"":d(t)?{}:l(t)?function(){return arguments}():void 0}),St=C(function Cu(t,n){var r,e,u,i={};for(e in n)r=t[e],u=typeof r,i[e]="function"===u?r(n[e]):"object"===u?Cu(t[e],n[e]):n[e];return i}),Et=C(U("find",$,function(t,n){for(var r=0,e=n.length;e>r;){if(t(n[r]))return n[r];r+=1}})),kt=C(U("findIndex",H,function(t,n){for(var r=0,e=n.length;e>r;){if(t(n[r]))return r;r+=1}return-1})),Nt=C(U("findLast",X,function(t,n){for(var r=n.length-1;r>=0;){if(t(n[r]))return n[r];r-=1}})),It=C(U("findLastIndex",Y,function(t,n){for(var r=n.length-1;r>=0;){if(t(n[r]))return r;r-=1}return-1})),qt=C(W("forEach",function(t,n){for(var r=n.length,e=0;r>e;)t(n[e]),e+=1;return n})),Wt=P(function(t){for(var n=0,r=t.length,e={};r>n;)p(t[n])&&t[n].length&&(e[t[n][0]]=t[n][1]),n+=1;return e}),Pt=C(function(t,n){return t>n}),Ct=C(function(t,n){return t>=n}),Mt=C(a),Rt=C(function(t,n){return t in n}),Ut=C(function(t,n){return t===n?0!==t||1/t===1/n:t!==t&&n!==n}),Bt=P(f),Tt=M(function(t,n,r){return dt(Math.max(t.length,n.length,r.length),function(){return t.apply(this,arguments)?n.apply(this,arguments):r.apply(this,arguments)})}),Lt=Q(1),Ft=M(function(t,n,r){t=t<r.length&&t>=0?t:r.length;var e=E(r);return e.splice(t,0,n),e}),Dt=M(function(t,n,r){return t=t<r.length&&t>=0?t:r.length,i(i(E(r,0,t),n),E(r,t))}),Vt=C(W("intersperse",function(t,n){for(var r=[],e=0,u=n.length;u>e;)e===u-1?r.push(n[e]):r.push(n[e],t),e+=1;return r})),zt=C(function(t,n){return null!=n&&n.constructor===t||n instanceof t}),Kt=P(function(t){return p(t)?!0:t?"object"!=typeof t?!1:t instanceof String?!1:1===t.nodeType?!!t.length:0===t.length?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1:!1}),_t=P(function(t){return null==t}),$t=function(){var t=!{toString:null}.propertyIsEnumerable("toString"),n=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],r=function(){return arguments.propertyIsEnumerable("length")}(),e=function(t,n){for(var r=0;r<t.length;){if(t[r]===n)return!0;r+=1}return!1};return P("function"!=typeof Object.keys||r?function(u){if(Object(u)!==u)return[];var i,o,c=[],s=r&&l(u);for(i in u)!a(i,u)||s&&"length"===i||(c[c.length]=i);if(t)for(o=n.length-1;o>=0;)i=n[o],a(i,u)&&!e(c,i)&&(c[c.length]=i),o-=1;return c}:function(t){return Object(t)!==t?[]:Object.keys(t)})}(),Ht=P(function(t){var n,r=[];for(n in t)r[r.length]=n;return r}),Xt=P(function(t){return null!=t&&zt(Number,t.length)?t.length:NaN}),Yt=C(function(t,n){return n>t}),Zt=C(function(t,n){return n>=t}),Gt=M(function(t,n,r){for(var e=0,u=r.length,i=[],o=[n];u>e;)o=t(o[0],r[e]),i[e]=o[1],e+=1;return[o[0],i]}),Jt=M(function(t,n,r){for(var e=r.length-1,u=[],i=[n];e>=0;)i=t(i[0],r[e]),u[e]=i[1],e-=1;return[i[0],u]}),Qt=C(function(t,n){return n.match(t)||[]}),tn=C(function(t,n){return h(t)?!h(n)||1>n?NaN:(t%n+n)%n:NaN}),nn=C(function(t,n){return n>t?n:t}),rn=M(function(t,n,r){return t(r)>t(n)?r:n}),en=M(function(t,n,r){var e,u={};for(e in n)a(e,n)&&(u[e]=a(e,r)?t(e,n[e],r[e]):n[e]);for(e in r)a(e,r)&&!a(e,u)&&(u[e]=r[e]);return u}),un=C(function(t,n){return t>n?n:t}),on=M(function(t,n,r){return t(r)<t(n)?r:n}),cn=C(function(t,n){return t%n}),sn=C(function(t,n){return t*n}),an=C(function(t,n){switch(t){case 0:return function(){return n.call(this)};case 1:return function(t){return n.call(this,t)};case 2:return function(t,r){return n.call(this,t,r)};case 3:return function(t,r,e){return n.call(this,t,r,e)};case 4:return function(t,r,e,u){return n.call(this,t,r,e,u)};case 5:return function(t,r,e,u,i){return n.call(this,t,r,e,u,i)};case 6:return function(t,r,e,u,i,o){return n.call(this,t,r,e,u,i,o)};case 7:return function(t,r,e,u,i,o,c){return n.call(this,t,r,e,u,i,o,c)};case 8:return function(t,r,e,u,i,o,c,s){return n.call(this,t,r,e,u,i,o,c,s)};case 9:return function(t,r,e,u,i,o,c,s,a){return n.call(this,t,r,e,u,i,o,c,s,a)};case 10:return function(t,r,e,u,i,o,c,s,a,f){return n.call(this,t,r,e,u,i,o,c,s,a,f)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),fn=P(function(t){return-t}),ln=C(u(U("any",L,ut))),pn=P(function(t){return!t}),hn=C(function(t,n){var r=0>t?n.length+t:t;return v(n)?n.charAt(r):n[r]}),gn=P(function(t){return function(){return hn(t,arguments)}}),dn=C(function(t,n){var r={};return r[t]=n,r}),yn=P(w),mn=P(function(t){var r,e=!1;return n(t.length,function(){return e?r:(e=!0,r=t.apply(this,arguments))})}),vn=C(function(t,n){return t||n}),xn=function(){var t=function(n){return{value:n,map:function(r){return t(r(n))}}};return M(function(n,r,e){return n(function(n){return t(r(n))})(e).value})}(),bn=C(function(t,n){return[t,n]}),wn=C(function(t,n){for(var r=n,e=0;e<t.length;){if(null==r)return;r=r[t[e]],e+=1}return r}),jn=M(function(t,n,r){return mt(t,wn(n,r))}),On=M(function(t,n,r){return n.length>0&&t(wn(n,r))}),An=C(function(t,n){for(var r={},e=0;e<t.length;)t[e]in n&&(r[t[e]]=n[t[e]]),e+=1;return r}),Sn=C(function(t,n){for(var r={},e=0,u=t.length;u>e;){var i=t[e];r[i]=n[i],e+=1}return r}),En=C(function(t,n){var r={};for(var e in n)t(n[e],e,n)&&(r[e]=n[e]);return r}),kn=C(function(t,n){return i([t],n)}),Nn=C(function(t,n){return n[t]}),In=M(function(t,n,r){return null!=r&&a(n,r)?r[n]:t}),qn=M(function(t,n,r){return t(r[n])}),Wn=C(function(t,n){for(var r=t.length,e=[],u=0;r>u;)e[u]=n[t[u]],u+=1;return e}),Pn=C(function(t,n){if(!g(t)||!g(n))throw new TypeError("Both arguments to range must be numbers");for(var r=[],e=t;n>e;)r.push(e),e+=1;return r}),Cn=M(function(t,n,r){for(var e=r.length-1;e>=0;)n=t(n,r[e]),e-=1;return n}),Mn=P(S),Rn=M(function(t,n,r){return i(E(r,0,Math.min(t,r.length)),E(r,Math.min(r.length,t+n)))}),Un=M(function(t,n,r){return r.replace(t,n)}),Bn=P(function(t){return v(t)?t.split("").reverse().join(""):E(t).reverse()}),Tn=M(function(t,n,r){for(var e=0,u=r.length,i=[n];u>e;)n=t(n,r[e]),i[e+1]=n,e+=1;return i}),Ln=M(function(t,n,r){return xn(t,rt(n),r)}),Fn=M(W("slice",function(t,n,r){return Array.prototype.slice.call(r,t,n)})),Dn=C(function(t,n){return E(n).sort(t)}),Vn=C(function(t,n){return E(n).sort(function(n,r){var e=t(n),u=t(r);return u>e?-1:e>u?1:0})}),zn=C(function(t,n){return[Fn(0,t,n),Fn(t,Xt(n),n)]}),Kn=C(function(t,n){if(0>=t)throw new Error("First argument to splitEvery must be a positive integer");for(var r=[],e=0;e<n.length;)r.push(Fn(e,e+=t,n));return r}),_n=C(function(t,n){for(var r=0,e=n.length,u=[];e>r&&!t(n[r]);)u.push(n[r]),r+=1;return[u,E(n,r)]}),$n=C(function(t,n){return t-n}),Hn=W("tail",Fn(1,1/0)),Xn=C(U("take",G,function(t,n){return Fn(0,0>t?1/0:t,n)})),Yn=C(function(t,n){for(var r=n.length-1;r>=0&&t(n[r]);)r-=1;return E(n,r+1,1/0)}),Zn=C(U("takeWhile",J,function(t,n){for(var r=0,e=n.length;e>r&&t(n[r]);)r+=1;return E(n,0,r)})),Gn=C(function(t,n){return t(n),n}),Jn=C(function(t,n){var r,e=Number(n),u=0;if(0>e||isNaN(e))throw new RangeError("n must be a non-negative number");for(r=new Array(e);e>u;)r[u]=t(u),u+=1;return r}),Qn=P(function(t){var n=[];for(var r in t)a(r,t)&&(n[n.length]=[r,t[r]]);return n}),tr=P(function(t){var n=[];for(var r in t)n[n.length]=[r,t[r]];return n}),nr=P(function(t){for(var n=0,r=[];n<t.length;){for(var e=t[n],u=0;u<e.length;)"undefined"==typeof r[u]&&(r[u]=[]),r[u].push(e[u]),u+=1;n+=1}return r}),rr=function(){var t="	\n\f\r   ᠎             　\u2028\u2029\ufeff",n="​",r="function"==typeof String.prototype.trim;return P(r&&!t.trim()&&n.trim()?function(t){return t.trim()}:function(n){var r=new RegExp("^["+t+"]["+t+"]*"),e=new RegExp("["+t+"]["+t+"]*$");return n.replace(r,"").replace(e,"")})}(),er=P(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}),ur=P(function(t){return function(){return t(E(arguments))}}),ir=P(function(t){return an(1,t)}),or=C(function(t,n){return dt(t,function(){for(var r,e=1,u=n,i=0;t>=e&&"function"==typeof u;)r=e===t?arguments.length:i+u.length,u=u.apply(this,E(arguments,i,r)),e+=1,i=r;return u})}),cr=C(function(t,n){for(var r=t(n),e=[];r&&r.length;)e[e.length]=r[0],r=t(r[1]);return e}),sr=C(function(t,n){for(var r,e=0,u=n.length,i=[];u>e;)r=n[e],o(t,r,i)||(i[i.length]=r),e+=1;return i}),ar=M(function(t,n,r){return t(r)?r:n(r)}),fr=M(function(t,n,r){return tt(rt(n),t,r)}),lr=C(function(t,n){return dt(n.length,function(){for(var r=[],e=0;e<n.length;)r.push(n[e].call(this,arguments[e])),e+=1;return t.apply(this,r.concat(E(arguments,n.length)))})}),pr=P(function(t){for(var n=$t(t),r=n.length,e=[],u=0;r>u;)e[u]=t[n[u]],u+=1;return e}),hr=P(function(t){var n,r=[];for(n in t)r[r.length]=t[n];return r}),gr=function(){var t=function(t){return{value:t,map:function(){return this}}};return C(function(n,r){return n(t)(r).value})}(),dr=M(function(t,n,r){return t(r)?n(r):r}),yr=C(function(t,n){for(var r in t)if(a(r,t)&&!t[r](n[r]))return!1;return!0}),mr=C(function(t,n){return dt(t.length,function(){return n.apply(this,i([t],arguments))})}),vr=C(function(t,n){for(var r,e=0,u=t.length,i=n.length,o=[];u>e;){for(r=0;i>r;)o[o.length]=[t[e],n[r]],r+=1;e+=1}return o}),xr=C(function(t,n){for(var r=[],e=0,u=Math.min(t.length,n.length);u>e;)r[e]=[t[e],n[e]],e+=1;return r}),br=C(function(t,n){for(var r=0,e=t.length,u={};e>r;)u[t[r]]=n[r],r+=1;return u}),wr=M(function(t,n,r){for(var e=[],u=0,i=Math.min(n.length,r.length);i>u;)e[u]=t(n[u],r[u]),u+=1;return e}),jr=rt(!1),Or=rt(!0),Ar=function Mu(t,n,r){var u=function(e){for(var u=n.length,i=0;u>i;){if(t===n[i])return r[i];i+=1}n[i+1]=t,r[i+1]=e;for(var o in t)e[o]=Mu(t[o],n,r);return e};switch(er(t)){case"Object":return u({});case"Array":return u([]);case"Date":return new Date(t.valueOf());case"RegExp":return e(t);default:return t}},Sr=function(t){return C(function(r,e){return n(Math.max(0,r.length-e.length),function(){return r.apply(this,t(e,arguments))})})},Er=function(t,n){return Xn(t<n.length?n.length-t:0,n)},kr=function Ru(t,n,e,u){if(Ut(t,n))return!0;if(er(t)!==er(n))return!1;if(null==t||null==n)return!1;if("function"==typeof t.equals||"function"==typeof n.equals)return"function"==typeof t.equals&&t.equals(n)&&"function"==typeof n.equals&&n.equals(t);switch(er(t)){case"Arguments":case"Array":case"Object":break;case"Boolean":case"Number":case"String":if(typeof t!=typeof n||!Ut(t.valueOf(),n.valueOf()))return!1;break;case"Date":if(!Ut(t.valueOf(),n.valueOf()))return!1;break;case"Error":return t.name===n.name&&t.message===n.message;case"RegExp":if(t.source!==n.source||t.global!==n.global||t.ignoreCase!==n.ignoreCase||t.multiline!==n.multiline||t.sticky!==n.sticky||t.unicode!==n.unicode)return!1;break;case"Map":case"Set":if(!Ru(r(t.entries()),r(n.entries()),e,u))return!1;break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":break;case"ArrayBuffer":break;default:return!1}var i=$t(t);if(i.length!==$t(n).length)return!1;for(var o=e.length-1;o>=0;){if(e[o]===t)return u[o]===n;o-=1}for(e.push(t),u.push(n),o=i.length-1;o>=0;){var c=i[o];if(!a(c,n)||!Ru(n[c],t[c],e,u))return!1;o-=1}return e.pop(),u.pop(),!0},Nr=function(t){return function n(r){for(var e,u,i,o=[],c=0,s=r.length;s>c;){if(Kt(r[c]))for(e=t?n(r[c]):r[c],i=0,u=e.length;u>i;)o[o.length]=e[i],i+=1;else o[o.length]=r[c];c+=1}return o}},Ir=function(){function t(t,n,r){for(var e=0,u=r.length;u>e;){if(n=t["@@transducer/step"](n,r[e]),n&&n["@@transducer/reduced"]){n=n["@@transducer/value"];break}e+=1}return t["@@transducer/result"](n)}function n(t,n,r){for(var e=r.next();!e.done;){if(n=t["@@transducer/step"](n,e.value),n&&n["@@transducer/reduced"]){n=n["@@transducer/value"];break}e=r.next()}return t["@@transducer/result"](n)}function r(t,n,r){return t["@@transducer/result"](r.reduce(ft(t["@@transducer/step"],t),n))}var e="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(u,i,o){if("function"==typeof u&&(u=I(u)),Kt(o))return t(u,i,o);if("function"==typeof o.reduce)return r(u,i,o);if(null!=o[e])return n(u,i,o[e]());if("function"==typeof o.next)return n(u,i,o);throw new TypeError("reduce: list must be array or iterable")}}(),qr=function(){function t(t,n){this.f=t,this.retained=[],this.xf=n}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.retained=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.retain(t,n):this.flush(t,n)},t.prototype.flush=function(t,n){return t=Ir(this.xf["@@transducer/step"],t,this.retained),this.retained=[],this.xf["@@transducer/step"](t,n)},t.prototype.retain=function(t,n){return this.retained.push(n),t},C(function(n,r){return new t(n,r)})}(),Wr=function(){function t(t,n){this.xf=n,this.f=t,this.inputs={}}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){var n;for(n in this.inputs)if(a(n,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[n]),t["@@transducer/reduced"])){t=t["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,n){var r=this.f(n);return this.inputs[r]=this.inputs[r]||[r,[]],this.inputs[r][1]=ot(n,this.inputs[r][1]),t},C(function(n,r){return new t(n,r)})}(),Pr=P(function(t){return dt(t.length,function(){var n=0,r=arguments[0],e=arguments[arguments.length-1],u=E(arguments);return u[0]=function(){var t=r.apply(this,i(arguments,[n,e]));return n+=1,t},t.apply(this,u)})}),Cr=P(function(t){return an(2,t)}),Mr=P(function(t){return null!=t&&"function"==typeof t.clone?t.clone():Ar(t,[],[])}),Rr=P(function(t){return dt(t.length,t)}),Ur=C(U("drop",D,function(t,n){return Fn(Math.max(0,t),1/0,n)})),Br=C(U("dropLast",V,Er)),Tr=C(U("dropLastWhile",qr,B)),Lr=C(function(t,n){return kr(t,n,[],[])}),Fr=C(U("filter",_,function(t,n){return d(n)?Ir(function(r,e){return t(n[e])&&(r[e]=n[e]),r},{},$t(n)):c(t,n)})),Dr=P(Nr(!0)),Vr=P(function(t){return Rr(function(n,r){var e=E(arguments);return e[0]=r,e[1]=n,t.apply(this,e)})}),zr=C(U("groupBy",Wr,function(t,n){return Ir(function(n,r){var e=t(r);return n[e]=ot(r,n[e]||(n[e]=[])),n},{},n)})),Kr=hn(0),_r=C(function(t,n){return Ir(function(n,r){var e=t(r);return n[e]=r,n},{},n)}),$r=Fn(0,-1),Hr=M(function(t,n,r){for(var e=[],u=0;u<n.length;)o(t,n[u],r)&&(e[e.length]=n[u]),u+=1;return sr(t,e)}),Xr=P(function(t){for(var n=$t(t),r=n.length,e=0,u={};r>e;){var i=n[e],o=t[i],c=a(o,u)?u[o]:u[o]=[];c[c.length]=i,e+=1}return u}),Yr=P(function(t){for(var n=$t(t),r=n.length,e=0,u={};r>e;){var i=n[e];u[t[i]]=i,e+=1}return u}),Zr=P(function(t){return null!=t&&Lr(t,At(t))}),Gr=hn(-1),Jr=C(function(t,n){if("function"!=typeof n.lastIndexOf||p(n)){for(var r=n.length-1;r>=0;){if(Lr(n[r],t))return r;r-=1}return-1}return n.lastIndexOf(t)}),Qr=C(U("map",Z,function(t,n){switch(Object.prototype.toString.call(n)){case"[object Function]":return dt(n.length,function(){return t.call(this,n.apply(this,arguments))});case"[object Object]":return Ir(function(r,e){return r[e]=t(n[e]),r},{},$t(n));default:return b(t,n)}})),te=C(function(t,n){return Ir(function(r,e){return r[e]=t(n[e],e,n),r},{},$t(n))}),ne=M(function(t,n,r){return en(function(n,r,e){return t(r,e)},n,r)}),re=Sr(i),ee=Sr(Vr(i)),ue=C(function(t,n){return Ir(function(n,r){var e=n[t(r)?0:1];return e[e.length]=r,n},[[],[]],n)}),ie=M(function(t,n,r){return Lr(wn(t,r),n)}),oe=C(function(t,n){return Qr(Nn(t),n)}),ce=lr(b,[Sn,Bt]),se=M(function(t,n,r){return qn(Lr(n),t,r)}),ae=M(function(t,n,r){return qn(zt(t),n,r)}),fe=M(Ir),le=C(function(t,n){return Fr(u(t),n)}),pe=C(function(t,n){return Jn(rt(t),n)}),he=fe(Q,0),ge=C(function(t,n){return Ur(t>=0?n.length-t:0,n)}),de=dt(4,function(t,n,r,e){return Ir(t("function"==typeof n?I(n):n),r,e)}),ye=M(function(t,n,r){return sr(t,i(n,r))}),me=C(function(t,n){return yr(Qr(Lr,t),n)}),ve=function(){var t=function(t){return{"@@transducer/init":N.init,"@@transducer/result":function(n){return t["@@transducer/result"](n)},"@@transducer/step":function(n,r){var e=t["@@transducer/step"](n,r);return e["@@transducer/reduced"]?s(e):e}}};return function(n){var r=t(n);return{"@@transducer/init":N.init,"@@transducer/result":function(t){return r["@@transducer/result"](t)},"@@transducer/step":function(t,n){return Kt(n)?Ir(r,t,n):Ir(r,t,[n])}}}}(),xe=function(t,n,r){var e,u;if("function"==typeof t.indexOf)switch(typeof n){case"number":if(0===n){for(e=1/n;r<t.length;){if(u=t[r],0===u&&1/u===e)return r;r+=1}return-1}if(n!==n){for(;r<t.length;){if(u=t[r],"number"==typeof u&&u!==u)return r;r+=1}return-1}return t.indexOf(n,r);case"string":case"boolean":case"function":case"undefined":return t.indexOf(n,r);case"object":if(null===n)return t.indexOf(n,r)}for(;r<t.length;){if(Lr(t[r],n))return r;r+=1}return-1},be=C(function(t,n){return Qr(t,ve(n))}),we=P(function(t){return dt(fe(nn,0,oe("length",t)),function(){for(var n=0,r=t.length;r>n;){if(!t[n].apply(this,arguments))return!1;n+=1}return!0})}),je=P(function(t){for(var n=t.length,r=0;n>r;){if(xe(t,t[r],r+1)>=0)return!1;r+=1}return!0}),Oe=P(function(t){return dt(fe(nn,0,oe("length",t)),function(){for(var n=0,r=t.length;r>n;){if(t[n].apply(this,arguments))return!0;n+=1}return!1})}),Ae=C(function(t,n){return"function"==typeof t.ap?t.ap(n):"function"==typeof t?dt(Math.max(t.length,n.length),function(){return t.apply(this,arguments)(n.apply(this,arguments))}):Ir(function(t,r){return i(t,Qr(r,n))},[],t)}),Se=Rr(function(t){return t.apply(this,E(arguments,1))}),Ee=C(U("chain",be,function(t,n){return"function"==typeof n?function(){return n.call(this,t.apply(this,arguments)).apply(this,arguments)}:Nr(!1)(Qr(t,n))})),ke=M(function(t,n,r){function e(n,r){return Ae(Qr(kn,t(r)),n)}return Cn(e,n([]),r)}),Ne=C(function(t,n){if(t>10)throw new Error("Constructor with greater than ten arguments");return 0===t?function(){return new n}:Rr(an(t,function(t,r,e,u,i,o,c,s,a,f){switch(arguments.length){case 1:return new n(t);case 2:return new n(t,r);case 3:return new n(t,r,e);case 4:return new n(t,r,e,u);case 5:return new n(t,r,e,u,i);case 6:return new n(t,r,e,u,i,o);case 7:return new n(t,r,e,u,i,o,c);case 8:return new n(t,r,e,u,i,o,c,s);case 9:return new n(t,r,e,u,i,o,c,s,a);case 10:return new n(t,r,e,u,i,o,c,s,a,f)}}))}),Ie=C(function(t,n){return dt(Math.max.apply(Math,oe("length",n)),function(){var r=arguments,e=this;return t.apply(e,b(function(t){return t.apply(e,r)},n))});
}),qe=C(U("dropRepeatsWith",z,function(t,n){var r=[],e=1,u=n.length;if(0!==u)for(r[0]=n[0];u>e;)t(Gr(r),n[e])||(r[r.length]=n[e]),e+=1;return r})),We=M(function(t,n,r){return Lr(t(n),t(r))}),Pe=M(function(t,n,r){return Lr(n[t],r[t])}),Ce=C(function(t,n){return"function"!=typeof n.indexOf||p(n)?xe(n,t,0):n.indexOf(t)}),Me=P(function(n){return function(){return Qr(ct(t,arguments),n)}}),Re=C(function(t,n){return function(r){return function(e){return Qr(function(t){return n(t,e)},r(t(e)))}}}),Ue=P(function(t){return Re(hn(t),fr(t))}),Be=P(function(t){return Re(wn(t),at(t))}),Te=P(function(t){return Re(Nn(t),st(t))}),Le=C(function(t,n){var r=dt(t,n);return dt(t,function(){return Ir(Ae,Qr(r,arguments[0]),E(arguments,1))})}),Fe=P(function(t){return he(t)/t.length}),De=P(function(t){var n=t.length;if(0===n)return NaN;var r=2-n%2,e=(n-r)/2;return Fe(E(t).sort(function(t,n){return n>t?-1:t>n?1:0}).slice(e,e+r))}),Ve=ne(function(t,n){return n}),ze=P(function(t){return fe(Ve,{},t)}),Ke=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return n(arguments[0].length,fe(j,arguments[0],Hn(arguments)))},_e=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return n(arguments[0].length,fe(O,arguments[0],Hn(arguments)))},$e=fe(sn,1),He=C(function(t,n){return"function"==typeof n.sequence?n.sequence(t):Cn(function(t,n){return Ae(Qr(kn,n),t)},t([]),n)}),Xe=M(function(t,n,r){return He(t,Qr(n,r))}),Ye=Ee(f),Ze=function(t,n){return xe(n,t,0)>=0},Ge=function(){var t={"@@transducer/init":Array,"@@transducer/step":function(t,n){return i(t,[n])},"@@transducer/result":f},n={"@@transducer/init":String,"@@transducer/step":function(t,n){return t+n},"@@transducer/result":f},r={"@@transducer/init":Object,"@@transducer/step":function(t,n){return Ve(t,Kt(n)?dn(n[0],n[1]):n)},"@@transducer/result":f};return function(e){if(x(e))return e;if(Kt(e))return t;if("string"==typeof e)return n;if("object"==typeof e)return r;throw new Error("Cannot create transformer for "+e)}}(),Je=function Uu(t,n){var r=function(r){var e=n.concat([t]);return Ze(r,e)?"<Circular>":Uu(r,e)},e=function(t,n){return b(function(n){return A(n)+": "+r(t[n])},n.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+b(r,t).join(", ")+"))";case"[object Array]":return"["+b(r,t).concat(e(t,le(function(t){return/^\d+$/.test(t)},$t(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+r(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+(isNaN(t.valueOf())?r(NaN):A(k(t)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+r(t.valueOf())+")":1/t===-(1/0)?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+r(t.valueOf())+")":A(t);case"[object Undefined]":return"undefined";default:if("function"==typeof t.toString){var u=t.toString();if("[object Object]"!==u)return u}return"{"+e(t,$t(t)).join(", ")+"}"}},Qe=ke(Bt),tu=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Ke.apply(this,Bn(arguments))},nu=function(){return tu.apply(this,kn(Bt,Qr(Ee,arguments)))},ru=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return _e.apply(this,Bn(arguments))},eu=P(function(t){return Ne(t.length,t)}),uu=C(Ze),iu=C(function(t,n){for(var r=[],e=0,u=t.length;u>e;)Ze(t[e],n)||Ze(t[e],r)||(r[r.length]=t[e]),e+=1;return r}),ou=P(U("dropRepeats",z(Lr),qe(Lr))),cu=M(function(t,n,r){return x(t)?Ir(n(t),t["@@transducer/init"](),r):Ir(n(Ge(t)),t,r)}),su=P(function(t){return Le(t.length,t)}),au=C(function(t,n){var r={};for(var e in n)Ze(e,t)||(r[e]=n[e]);return r}),fu=function(){return nu.apply(this,Bn(arguments))},lu=P(function(t){return Je(t,[])}),pu=C("undefined"==typeof Set?function(t,n){for(var r,e,u=0,i=[],o=[];u<n.length;)e=n[u],r=t(e),Ze(r,i)||(o.push(e),i.push(r)),u+=1;return o}:function(t,n){for(var r,e,u,i=new Set,o=[],c=0,s=[],a=!1,f=!1,l=0;l<n.length;){switch(e=n[l],r=t(e),typeof r){case"number":if(0===r&&!f&&1/r===-(1/0)){f=!0,s.push(e);break}case"string":case"boolean":case"function":case"undefined":i.add(r),u=i.size,u>c&&(s.push(e),c=u);break;case"object":if(null===r){a||(a=!0,s.push(null));break}default:Ze(r,o)||(o.push(r),s.push(e))}l+=1}return s}),hu=C(function(t,n){return le(Vr(Ze)(t),n)}),gu=su(pn),du=C(function(t,n){return dt(t+1,function(){var r=arguments[t];if(null!=r&&zt(Function,r[n]))return r[n].apply(r,E(arguments,0,t));throw new TypeError(lu(r)+' does not have a method named "'+n+'"')})}),yu=du(1,"join"),mu=P(function(t){var r={};return n(t.length,function(){var n=lu(arguments);return a(n,r)||(r[n]=t.apply(this,arguments)),r[n]})}),vu=du(1,"split"),xu=C(function(t,n){if(!m(t))throw new TypeError("‘test’ requires a value of type RegExp as its first argument; received "+lu(t));return e(t).test(n)}),bu=du(0,"toLowerCase"),wu=du(0,"toUpperCase"),ju=pu(Bt),Ou=Vr(du(1,"concat")),Au=C(function(t,n){return ju(c(Vr(Ze)(t),n))}),Su=C(function(t,n){return Ou(iu(t,n),iu(n,t))}),Eu=M(function(t,n,r){return Ou(vt(t,n,r),vt(t,r,n))}),ku=C(tu(ju,i)),Nu={F:jr,T:Or,__:t,add:Q,addIndex:Pr,adjust:tt,all:nt,allPass:we,allUniq:je,always:rt,and:et,any:ut,anyPass:Oe,ap:Ae,aperture:it,append:ot,apply:ct,assoc:st,assocPath:at,binary:Cr,bind:ft,both:lt,call:Se,chain:Ee,clone:Mr,commute:Qe,commuteMap:ke,comparator:pt,complement:gu,compose:tu,composeK:nu,composeP:ru,concat:Ou,cond:ht,construct:eu,constructN:Ne,contains:uu,converge:Ie,countBy:gt,curry:Rr,curryN:dt,dec:yt,defaultTo:mt,difference:iu,differenceWith:vt,dissoc:xt,dissocPath:bt,divide:wt,drop:Ur,dropLast:Br,dropLastWhile:Tr,dropRepeats:ou,dropRepeatsWith:qe,dropWhile:jt,either:Ot,empty:At,eqBy:We,eqProps:Pe,equals:Lr,evolve:St,filter:Fr,find:Et,findIndex:kt,findLast:Nt,findLastIndex:It,flatten:Dr,flip:Vr,forEach:qt,fromPairs:Wt,groupBy:zr,gt:Pt,gte:Ct,has:Mt,hasIn:Rt,head:Kr,identical:Ut,identity:Bt,ifElse:Tt,inc:Lt,indexBy:_r,indexOf:Ce,init:$r,insert:Ft,insertAll:Dt,intersection:Au,intersectionWith:Hr,intersperse:Vt,into:cu,invert:Xr,invertObj:Yr,invoker:du,is:zt,isArrayLike:Kt,isEmpty:Zr,isNil:_t,join:yu,juxt:Me,keys:$t,keysIn:Ht,last:Gr,lastIndexOf:Jr,length:Xt,lens:Re,lensIndex:Ue,lensPath:Be,lensProp:Te,lift:su,liftN:Le,lt:Yt,lte:Zt,map:Qr,mapAccum:Gt,mapAccumRight:Jt,mapObjIndexed:te,match:Qt,mathMod:tn,max:nn,maxBy:rn,mean:Fe,median:De,memoize:mu,merge:Ve,mergeAll:ze,mergeWith:ne,mergeWithKey:en,min:un,minBy:on,modulo:cn,multiply:sn,nAry:an,negate:fn,none:ln,not:pn,nth:hn,nthArg:gn,objOf:dn,of:yn,omit:au,once:mn,or:vn,over:xn,pair:bn,partial:re,partialRight:ee,partition:ue,path:wn,pathEq:ie,pathOr:jn,pathSatisfies:On,pick:An,pickAll:Sn,pickBy:En,pipe:Ke,pipeK:fu,pipeP:_e,pluck:oe,prepend:kn,product:$e,project:ce,prop:Nn,propEq:se,propIs:ae,propOr:In,propSatisfies:qn,props:Wn,range:Pn,reduce:fe,reduceRight:Cn,reduced:Mn,reject:le,remove:Rn,repeat:pe,replace:Un,reverse:Bn,scan:Tn,sequence:He,set:Ln,slice:Fn,sort:Dn,sortBy:Vn,split:vu,splitAt:zn,splitEvery:Kn,splitWhen:_n,subtract:$n,sum:he,symmetricDifference:Su,symmetricDifferenceWith:Eu,tail:Hn,take:Xn,takeLast:ge,takeLastWhile:Yn,takeWhile:Zn,tap:Gn,test:xu,times:Jn,toLower:bu,toPairs:Qn,toPairsIn:tr,toString:lu,toUpper:wu,transduce:de,transpose:nr,traverse:Xe,trim:rr,type:er,unapply:ur,unary:ir,uncurryN:or,unfold:cr,union:ku,unionWith:ye,uniq:ju,uniqBy:pu,uniqWith:sr,unless:ar,unnest:Ye,update:fr,useWith:lr,values:pr,valuesIn:hr,view:gr,when:dr,where:yr,whereEq:me,without:hu,wrap:mr,xprod:vr,zip:xr,zipObj:br,zipWith:wr};"object"==typeof exports?module.exports=Nu:"function"==typeof define&&define.amd?define(function(){return Nu}):this.R=Nu}).call(this);
/*! Sortable 1.4.2 - MIT | git://github.com/rubaxa/Sortable.git */
!function(a){"use strict";"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=a():"undefined"!=typeof Package?Sortable=a():window.Sortable=a()}(function(){"use strict";function a(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a,this.options=b=r({},b),a[L]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var d in c)!(d in b)&&(b[d]=c[d]);V(b);for(var f in this)"_"===f.charAt(0)&&(this[f]=this[f].bind(this));this.nativeDraggable=b.forceFallback?!1:P,e(a,"mousedown",this._onTapStart),e(a,"touchstart",this._onTapStart),this.nativeDraggable&&(e(a,"dragover",this),e(a,"dragenter",this)),T.push(this._onDragOver),b.store&&this.sort(b.store.get(this))}function b(a){v&&v.state!==a&&(h(v,"display",a?"none":""),!a&&v.state&&w.insertBefore(v,s),v.state=a)}function c(a,b,c){if(a){c=c||N,b=b.split(".");var d=b.shift().toUpperCase(),e=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");do if(">*"===d&&a.parentNode===c||(""===d||a.nodeName.toUpperCase()==d)&&(!b.length||((" "+a.className+" ").match(e)||[]).length==b.length))return a;while(a!==c&&(a=a.parentNode))}return null}function d(a){a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()}function e(a,b,c){a.addEventListener(b,c,!1)}function f(a,b,c){a.removeEventListener(b,c,!1)}function g(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(K," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(K," ")}}function h(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return N.defaultView&&N.defaultView.getComputedStyle?c=N.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b),d[b]=c+("string"==typeof c?"":"px")}}function i(a,b,c){if(a){var d=a.getElementsByTagName(b),e=0,f=d.length;if(c)for(;f>e;e++)c(d[e],e);return d}return[]}function j(a,b,c,d,e,f,g){var h=N.createEvent("Event"),i=(a||b[L]).options,j="on"+c.charAt(0).toUpperCase()+c.substr(1);h.initEvent(c,!0,!0),h.to=b,h.from=e||b,h.item=d||b,h.clone=v,h.oldIndex=f,h.newIndex=g,b.dispatchEvent(h),i[j]&&i[j].call(a,h)}function k(a,b,c,d,e,f){var g,h,i=a[L],j=i.options.onMove;return g=N.createEvent("Event"),g.initEvent("move",!0,!0),g.to=b,g.from=a,g.dragged=c,g.draggedRect=d,g.related=e||b,g.relatedRect=f||b.getBoundingClientRect(),a.dispatchEvent(g),j&&(h=j.call(i,g)),h}function l(a){a.draggable=!1}function m(){R=!1}function n(a,b){var c=a.lastElementChild,d=c.getBoundingClientRect();return(b.clientY-(d.top+d.height)>5||b.clientX-(d.right+d.width)>5)&&c}function o(a){for(var b=a.tagName+a.className+a.src+a.href+a.textContent,c=b.length,d=0;c--;)d+=b.charCodeAt(c);return d.toString(36)}function p(a){var b=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"!==a.nodeName.toUpperCase()&&b++;return b}function q(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c),c=void 0},b))}}function r(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J={},K=/\s+/g,L="Sortable"+(new Date).getTime(),M=window,N=M.document,O=M.parseInt,P=!!("draggable"in N.createElement("div")),Q=function(a){return a=N.createElement("x"),a.style.cssText="pointer-events:auto","auto"===a.style.pointerEvents}(),R=!1,S=Math.abs,T=([].slice,[]),U=q(function(a,b,c){if(c&&b.scroll){var d,e,f,g,h=b.scrollSensitivity,i=b.scrollSpeed,j=a.clientX,k=a.clientY,l=window.innerWidth,m=window.innerHeight;if(z!==c&&(y=b.scroll,z=c,y===!0)){y=c;do if(y.offsetWidth<y.scrollWidth||y.offsetHeight<y.scrollHeight)break;while(y=y.parentNode)}y&&(d=y,e=y.getBoundingClientRect(),f=(S(e.right-j)<=h)-(S(e.left-j)<=h),g=(S(e.bottom-k)<=h)-(S(e.top-k)<=h)),f||g||(f=(h>=l-j)-(h>=j),g=(h>=m-k)-(h>=k),(f||g)&&(d=M)),(J.vx!==f||J.vy!==g||J.el!==d)&&(J.el=d,J.vx=f,J.vy=g,clearInterval(J.pid),d&&(J.pid=setInterval(function(){d===M?M.scrollTo(M.pageXOffset+f*i,M.pageYOffset+g*i):(g&&(d.scrollTop+=g*i),f&&(d.scrollLeft+=f*i))},24)))}},30),V=function(a){var b=a.group;b&&"object"==typeof b||(b=a.group={name:b}),["pull","put"].forEach(function(a){a in b||(b[a]=!0)}),a.groups=" "+b.name+(b.put.join?" "+b.put.join(" "):"")+" "};return a.prototype={constructor:a,_onTapStart:function(a){var b=this,d=this.el,e=this.options,f=a.type,g=a.touches&&a.touches[0],h=(g||a).target,i=h,k=e.filter;if(!("mousedown"===f&&0!==a.button||e.disabled)&&(h=c(h,e.draggable,d))){if(D=p(h),"function"==typeof k){if(k.call(this,a,h,this))return j(b,i,"filter",h,d,D),void a.preventDefault()}else if(k&&(k=k.split(",").some(function(a){return a=c(i,a.trim(),d),a?(j(b,a,"filter",h,d,D),!0):void 0})))return void a.preventDefault();(!e.handle||c(i,e.handle,d))&&this._prepareDragStart(a,g,h)}},_prepareDragStart:function(a,b,c){var d,f=this,h=f.el,j=f.options,k=h.ownerDocument;c&&!s&&c.parentNode===h&&(G=a,w=h,s=c,t=s.parentNode,x=s.nextSibling,F=j.group,d=function(){f._disableDelayedDrag(),s.draggable=!0,g(s,f.options.chosenClass,!0),f._triggerDragStart(b)},j.ignore.split(",").forEach(function(a){i(s,a.trim(),l)}),e(k,"mouseup",f._onDrop),e(k,"touchend",f._onDrop),e(k,"touchcancel",f._onDrop),j.delay?(e(k,"mouseup",f._disableDelayedDrag),e(k,"touchend",f._disableDelayedDrag),e(k,"touchcancel",f._disableDelayedDrag),e(k,"mousemove",f._disableDelayedDrag),e(k,"touchmove",f._disableDelayedDrag),f._dragStartTimer=setTimeout(d,j.delay)):d())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer),f(a,"mouseup",this._disableDelayedDrag),f(a,"touchend",this._disableDelayedDrag),f(a,"touchcancel",this._disableDelayedDrag),f(a,"mousemove",this._disableDelayedDrag),f(a,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(a){a?(G={target:s,clientX:a.clientX,clientY:a.clientY},this._onDragStart(G,"touch")):this.nativeDraggable?(e(s,"dragend",this),e(w,"dragstart",this._onDragStart)):this._onDragStart(G,!0);try{N.selection?N.selection.empty():window.getSelection().removeAllRanges()}catch(b){}},_dragStarted:function(){w&&s&&(g(s,this.options.ghostClass,!0),a.active=this,j(this,w,"start",s,w,D))},_emulateDragOver:function(){if(H){if(this._lastX===H.clientX&&this._lastY===H.clientY)return;this._lastX=H.clientX,this._lastY=H.clientY,Q||h(u,"display","none");var a=N.elementFromPoint(H.clientX,H.clientY),b=a,c=" "+this.options.group.name,d=T.length;if(b)do{if(b[L]&&b[L].options.groups.indexOf(c)>-1){for(;d--;)T[d]({clientX:H.clientX,clientY:H.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode);Q||h(u,"display","")}},_onTouchMove:function(b){if(G){a.active||this._dragStarted(),this._appendGhost();var c=b.touches?b.touches[0]:b,d=c.clientX-G.clientX,e=c.clientY-G.clientY,f=b.touches?"translate3d("+d+"px,"+e+"px,0)":"translate("+d+"px,"+e+"px)";I=!0,H=c,h(u,"webkitTransform",f),h(u,"mozTransform",f),h(u,"msTransform",f),h(u,"transform",f),b.preventDefault()}},_appendGhost:function(){if(!u){var a,b=s.getBoundingClientRect(),c=h(s),d=this.options;u=s.cloneNode(!0),g(u,d.ghostClass,!1),g(u,d.fallbackClass,!0),h(u,"top",b.top-O(c.marginTop,10)),h(u,"left",b.left-O(c.marginLeft,10)),h(u,"width",b.width),h(u,"height",b.height),h(u,"opacity","0.8"),h(u,"position","fixed"),h(u,"zIndex","100000"),h(u,"pointerEvents","none"),d.fallbackOnBody&&N.body.appendChild(u)||w.appendChild(u),a=u.getBoundingClientRect(),h(u,"width",2*b.width-a.width),h(u,"height",2*b.height-a.height)}},_onDragStart:function(a,b){var c=a.dataTransfer,d=this.options;this._offUpEvents(),"clone"==F.pull&&(v=s.cloneNode(!0),h(v,"display","none"),w.insertBefore(v,s)),b?("touch"===b?(e(N,"touchmove",this._onTouchMove),e(N,"touchend",this._onDrop),e(N,"touchcancel",this._onDrop)):(e(N,"mousemove",this._onTouchMove),e(N,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(c&&(c.effectAllowed="move",d.setData&&d.setData.call(this,c,s)),e(N,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(a){var d,e,f,g=this.el,i=this.options,j=i.group,l=j.put,o=F===j,p=i.sort;if(void 0!==a.preventDefault&&(a.preventDefault(),!i.dragoverBubble&&a.stopPropagation()),I=!0,F&&!i.disabled&&(o?p||(f=!w.contains(s)):F.pull&&l&&(F.name===j.name||l.indexOf&&~l.indexOf(F.name)))&&(void 0===a.rootEl||a.rootEl===this.el)){if(U(a,i,this.el),R)return;if(d=c(a.target,i.draggable,g),e=s.getBoundingClientRect(),f)return b(!0),void(v||x?w.insertBefore(s,v||x):p||w.appendChild(s));if(0===g.children.length||g.children[0]===u||g===a.target&&(d=n(g,a))){if(d){if(d.animated)return;r=d.getBoundingClientRect()}b(o),k(w,g,s,e,d,r)!==!1&&(s.contains(g)||(g.appendChild(s),t=g),this._animate(e,s),d&&this._animate(r,d))}else if(d&&!d.animated&&d!==s&&void 0!==d.parentNode[L]){A!==d&&(A=d,B=h(d),C=h(d.parentNode));var q,r=d.getBoundingClientRect(),y=r.right-r.left,z=r.bottom-r.top,D=/left|right|inline/.test(B.cssFloat+B.display)||"flex"==C.display&&0===C["flex-direction"].indexOf("row"),E=d.offsetWidth>s.offsetWidth,G=d.offsetHeight>s.offsetHeight,H=(D?(a.clientX-r.left)/y:(a.clientY-r.top)/z)>.5,J=d.nextElementSibling,K=k(w,g,s,e,d,r);if(K!==!1){if(R=!0,setTimeout(m,30),b(o),1===K||-1===K)q=1===K;else if(D){var M=s.offsetTop,N=d.offsetTop;q=M===N?d.previousElementSibling===s&&!E||H&&E:N>M}else q=J!==s&&!G||H&&G;s.contains(g)||(q&&!J?g.appendChild(s):d.parentNode.insertBefore(s,q?J:d)),t=s.parentNode,this._animate(e,s),this._animate(r,d)}}}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();h(b,"transition","none"),h(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)"),b.offsetWidth,h(b,"transition","all "+c+"ms"),h(b,"transform","translate3d(0,0,0)"),clearTimeout(b.animated),b.animated=setTimeout(function(){h(b,"transition",""),h(b,"transform",""),b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;f(N,"touchmove",this._onTouchMove),f(a,"mouseup",this._onDrop),f(a,"touchend",this._onDrop),f(a,"touchcancel",this._onDrop)},_onDrop:function(b){var c=this.el,d=this.options;clearInterval(this._loopId),clearInterval(J.pid),clearTimeout(this._dragStartTimer),f(N,"mousemove",this._onTouchMove),this.nativeDraggable&&(f(N,"drop",this),f(c,"dragstart",this._onDragStart)),this._offUpEvents(),b&&(I&&(b.preventDefault(),!d.dropBubble&&b.stopPropagation()),u&&u.parentNode.removeChild(u),s&&(this.nativeDraggable&&f(s,"dragend",this),l(s),g(s,this.options.ghostClass,!1),g(s,this.options.chosenClass,!1),w!==t?(E=p(s),E>=0&&(j(null,t,"sort",s,w,D,E),j(this,w,"sort",s,w,D,E),j(null,t,"add",s,w,D,E),j(this,w,"remove",s,w,D,E))):(v&&v.parentNode.removeChild(v),s.nextSibling!==x&&(E=p(s),E>=0&&(j(this,w,"update",s,w,D,E),j(this,w,"sort",s,w,D,E)))),a.active&&((null===E||-1===E)&&(E=D),j(this,w,"end",s,w,D,E),this.save())),w=s=t=u=x=v=y=z=G=H=I=E=A=B=F=a.active=null)},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?s&&(this._onDragOver(a),d(a)):("drop"===b||"dragend"===b)&&this._onDrop(a)},toArray:function(){for(var a,b=[],d=this.el.children,e=0,f=d.length,g=this.options;f>e;e++)a=d[e],c(a,g.draggable,this.el)&&b.push(a.getAttribute(g.dataIdAttr)||o(a));return b},sort:function(a){var b={},d=this.el;this.toArray().forEach(function(a,e){var f=d.children[e];c(f,this.options.draggable,d)&&(b[a]=f)},this),a.forEach(function(a){b[a]&&(d.removeChild(b[a]),d.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return c(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;return void 0===b?c[a]:(c[a]=b,void("group"===a&&V(c)))},destroy:function(){var a=this.el;a[L]=null,f(a,"mousedown",this._onTapStart),f(a,"touchstart",this._onTapStart),this.nativeDraggable&&(f(a,"dragover",this),f(a,"dragenter",this)),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),T.splice(T.indexOf(this._onDragOver),1),this._onDrop(),this.el=a=null}},a.utils={on:e,off:f,css:h,find:i,is:function(a,b){return!!c(a,b,a)},extend:r,throttle:q,closest:c,toggleClass:g,index:p},a.create=function(b,c){return new a(b,c)},a.version="1.4.2",a});// Percolate LMS
//
// Copyright (C) 2018 Michaels & Associates Docntrain, Ltd.
//
// This program is free software: you can redistribute it and/or modify it under
// the terms of the GNU General Public License as published by the Free Software
// Foundation, either version 3 of the License, or (at your option) any later
// version.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of  MERCHANTABILITY or FITNESS
// FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along with
// this program.  If not, see <http://www.gnu.org/licenses/>.
//

var St={};St.error=null;St.api_prefix="/api/";St.use=function(uri){var mydata=null;var myset=function(value){mydata=value;return value;}
return{get:function(){return mydata;},set:myset,fetch:function(){return St.raw_request('GET',uri,null).then(myset);},send:function(){return St.raw_request('POST',uri,mydata);},del:function(){return St.raw_request('DELETE',uri,null);},prop:function(name){return{get:function(){return mydata?mydata[name]:null;},set:function(value){if(R.type(mydata)!="Object")mydata={};mydata[name]=value;},}}}}
St.request_config=function(xhr){var auth_token=localStorage.getItem('auth_token');if(!R.isNil(auth_token)){xhr.setRequestHeader('Authorization',"Bearer "+auth_token);}}
St.request_fail_default=function(method,uri,response_data){var descr="Sorry, something went wrong between here and the server. Perhaps refresh and try again?";if(response_data&&response_data.hypermedia&&response_data.hypermedia.description){descr=response_data.hypermedia.description;}
if(response_data&&response_data.hypermedia&&response_data.hypermedia.error_type){var error_type=response_data.hypermedia.error_type;if(error_type=="Lms\\NoTenant"){St.noTenantMessage=response_data.hypermedia.description;m.route.set('/no-tenant');}}
St.error=descr;};St.raw_request=function(method,uri,data){var req={method:method,url:St.api_prefix+uri,data:data,config:St.request_config,};var retval=m.request(req);retval.catch(function(e){St.request_fail_default(req.method,req.url,e);});return retval;};var Ut={};Ut.toggleProp=function(prop){return function(){prop(!prop());}}
Ut.uniqueCounter=0;Ut.uniqueId=function(){Ut.uniqueCounter++;return"id"+Ut.uniqueCounter;}
Ut.encodeId=function(n){return(n*798738217).toString().split("").reverse().join("");}
Ut.decodeId=function(n){return parseInt(n.split("").reverse().join(""))/798738217;}
Ut.viewBoundInput=function(title,prop){var id=Ut.uniqueId();return[m("label",{for:id},title),m("input",{type:"text",id:id,onchange:m.withAttr("value",prop.set),value:prop.get(),}),];}
Ut.viewBoundPassword=function(title,prop){return m("label",[title,m("input[type='password']",{onchange:m.withAttr("value",prop.set),value:prop.get(),})]);}
Ut.viewBoundTextarea=function(title,prop){return m("label",[title,m("textarea",{onchange:m.withAttr("value",prop.set),value:prop.get(),})]);}
Ut.sortAlphaBy=function(prop,list){return R.sortBy(R.prop(prop),list);}
Ut.autocomplete=function(datasets){var filter_str="";function resetFilter(){filter_str="";filter();}
function makeView(ds){return ds.view({onclick:function(item){ds.callback(item);resetFilter();},});}
function viewDataset(ds){return R.map(makeView(ds),ds.filtered_data);}
function filter(){if(filter_str==""){R.forEach(function(ds){ds.filtered_data=[];},datasets);return;}
var rx=new RegExp(filter_str,"i");R.forEach(function(ds){var matches=function(item){return rx.test(ds.getFilterText(item));}
ds.filtered_data=R.filter(matches,ds.data.get());},datasets);}
var updateFilter=m.withAttr("value",function(str){filter_str=str;filter();});function view(){return[m("input",{oninput:updateFilter,value:filter_str}),m(".list-small",R.map(viewDataset,datasets)),];}
resetFilter();return{reset_filter:resetFilter,view:view,}};Ut.viewPersonThumb=function(obj){var def=img.default_avatar;if(R.isNil(obj.thumb_file_id))return m("img.thumb",{src:def});return Ut.viewThumb(obj.thumb_file_id,obj.thumb_fname);}
Ut.viewContentThumb=function(obj){var def=img.default_thumb;if(R.isNil(obj.thumb_file_id))return m("img.thumb",{src:def});return Ut.viewThumb(obj.thumb_file_id,obj.thumb_fname);}
Ut.viewThumb=function(fid,fname){var path="/api/files/"+fid+"/"+fname;return m("img.thumb",{src:path});}
Ut.tagstrToList=function(tagstr){if(!tagstr)return[];tagstr=tagstr.replace(/^{/,'');tagstr=tagstr.replace(/}$/,'');return R.map(R.trim,tagstr.split(','));}
Ut.tagsWithCountsFromObjList=function(list,optional_layout_type){var isNothing=R.either(R.isNil,R.isEmpty);var tagprop=R.map(R.prop('tags'));var taglist=R.map(R.split(','));var nonempty=R.reject(isNothing);var countem=R.countBy(R.identity);var objectify=R.map(function(pair){return{name:pair[0],title:pair[0],count:pair[1],layout_type:optional_layout_type,}});return R.compose(objectify,R.toPairs,countem,R.unnest,taglist,nonempty,tagprop)(list);};Ut.tokenize=function(s,parsers,deftok){var m,r,l,t,tokens=[];while(s){t=null;m=s.length;for(var key in parsers){r=parsers[key].exec(s);if(r&&(r.index<m)){t={token:r[0],type:key,matches:r.slice(1)}
m=r.index;}}
if(m){tokens.push({token:s.substr(0,m),type:deftok||'unknown'});}
if(t){tokens.push(t);}
s=s.substr(m+(t?t.token.length:0));}
return tokens;}
Ut.makeLink=function(link_str){var linkrx=/<player\/(\d+):"(.*)">/;var matches=linkrx.exec(link_str);var id=matches[1];var title=matches[2];return m("a[href=/player/"+id+"]",{oncreate:m.route.link},title);}
Ut.viewLoading=function(custom_message){return m(".loading",[Main.viewTop(),m(".dialog",m("p",(custom_message?custom_message:"Loading..."))),Main.viewBottom(),]);}
Ut.viewFilterBox=function(data){var applyFilter=m.withAttr("value",function(s){s=R.toLower(s);var f=R.compose(R.contains(s),R.toLower,R.prop(data.filter_prop));data.filtered_list=R.filter(f,data.original_list);});return m(".input-with-icon",[m("input[type=text]",{oninput:applyFilter,placeholder:data.filter_label}),m("i.material-icons","search"),]);}
Ut.viewPickerButton=function(data){function click(){data.stack_open=true;}
function viewSelected(){var i=data.selected_item;if(!i){switch(data.placeholder_type){case"person":return[m("img.avatar",{src:imgs.default_avatar}),m(".title",m.trust("&nbsp;")),];break;case"content":return[m("img.thumb",{src:imgs.default_thumb}),m(".title",m.trust("&nbsp;")),];break;}}
switch(i.layout_type){case"person":return[People.viewAvatar(i),m(".title",i.name),];break;case"content":return[Content.viewThumbImg(i),m(".title",i.title),];break;case"ptag":return[m("img.thumb",{src:imgs.ptag}),m(".title",i.name+" ("+i.count+")"),];break;case"ctag":return[m("img.thumb",{src:imgs.ctag}),m(".title",i.title+" ("+i.count+")"),];break;}}
var cls=data.selected_item?"":".primary";return m(".card.action.picker",[viewSelected(),m("button"+cls,{onclick:click},data.button_label),]);};Ut.viewPickerStack=function(data){if(!data.stack_open)return null;if(!data.original_list)return"Loading...";function viewItem(item){function select(){data.stack_open=false;data.selected_item=item;if(data.callback)data.callback();}
var v="Stack item with no type.";var ptagt=m("img",{src:imgs.ptag});var ctagt=m("img",{src:imgs.ctag});if(item.layout_type=="person")v=[People.viewAvatar(item),m(".title",item.name)];if(item.layout_type=="content")v=[Content.viewThumbImg(item),m(".title",item.title)];if(item.layout_type=="ptag")v=[ptagt,m(".title",item.name+" ("+item.count+")")];if(item.layout_type=="ctag")v=[ctagt,m(".title",item.title+" ("+item.count+")")];return m(".stackitem.link",{onclick:select},v);}
return m(".picker",[m("p",data.button_label),Ut.viewFilterBox(data),m(".stack",R.map(viewItem,data.filtered_list)),]);};var Tags=function(item_list,options){var isNothing=R.either(R.isNil,R.isEmpty);var taglist=extractTags(item_list);var selected_tags=[];var filtered_item_list=item_list;function isSelected(t){return R.contains(t,selected_tags);}
function isSystemTag(t){return R.test(/^\$/,t);}
function extractTags(list){if(list==null){return[];}
var tagprop=R.map(R.prop('tags'));var taglist=R.map(R.split(','));var nonempty=R.reject(isNothing);return R.compose(R.uniq,R.unnest,taglist,nonempty,tagprop)(list);};function itemMatchesSelectedTags(item){if(R.isEmpty(selected_tags))return true;if(isNothing(item.tags))return false;function itemHasTag(t){return item.tags.indexOf(t)>-1;}
return R.all(itemHasTag,selected_tags);}
function toggleTag(t){return function(){if(isSelected(t))removeTagFilter(t);else addTagFilter(t);filter();}}
function addTagFilter(t){selected_tags.push(t);}
function removeTagFilter(t){selected_tags=R.reject(R.equals(t),selected_tags);}
function filter(){filtered_item_list=R.filter(itemMatchesSelectedTags,item_list);return filtered_item_list;}
function click(t){return function(){if(options.filter_on_click){if(isSelected(t))removeTagFilter(t);else addTagFilter(t);filter();options.on_filter(filter());}
if(options.on_click){options.on_click(t);}};}
function viewThumb(t){var sel=isSelected(t)?'.selected':'';var sys=isSystemTag(t)?'.sys':'.not-sys';return m("li"+sel+sys,{onclick:click(t)},t);}
function viewThumbList(){return R.isNil(taglist)?null:m("ul.tags",R.map(viewThumb,taglist));}
return{viewThumbList:viewThumbList,toggleTag:toggleTag,addTagFilter:addTagFilter,removeTagFilter:removeTagFilter,filter:filter,};};function Uploader(config){var visible=true;var file_over=false;var file_uploading=false;var file_done=false;var file_name="";var file_progress_string="";var file_tag=null;function fileDropped(e){e.preventDefault();file_over=false;upload(e.dataTransfer.files[0]);}
function uploadDone(result_data){file_uploading=false;file_done=true;if(config.callback)config.callback(result_data);}
function uploadFail(result_data){file_uploading=false;file_done=true;if(result_data&&R.has("hypermedia",result_data)){if(R.has("description",result_data.hypermedia)){St.error=result_data.hypermedia.description;return;}}
St.error="There has been an unknown error while attempting to receive your file.";}
function upload(file){if(!file){St.error="Cannot upload file due to UI error. Please try again.";return;}
if(file.size>4000000000){St.error="To upload files larger than 4Gb, please contact your LMS administrator.";return;}
file_uploading=true;m.redraw();file_done=false;file_name=file.name;var formData=new FormData();formData.append("userfile",file);formData.append("purpose",config.purpose);formData.append("related_id",config.related_id);function configureRequest(xhr){var auth_token=localStorage.getItem('auth_token');if(!R.isNil(auth_token)){xhr.setRequestHeader('Authorization',"Bearer "+auth_token);}
xhr.upload.addEventListener('progress',function(e){var done=e.position||e.loaded;var total=e.totalSize||e.total;var percent=Math.round(done/total*100);file_progress_string="("+percent+"%)";m.redraw();});}
m.request({data:formData,serialize:function(value){return value},method:"POST",url:"/api/files",config:configureRequest}).then(uploadDone,uploadFail);}
function view(){if(!visible)return null;var file_tag_settings={onchange:function(e){upload(this.files[0]);},oncreate:function(vnode){file_tag=vnode.dom;},style:{visibility:"hidden"},};https:switch(config.purpose){case"person-thumb":case"content-thumb":case"site-logo":case"image":file_tag_settings.accept=".jpg,.jpeg,.png";break;case"video":file_tag_settings.accept=".mp4";break;case"scorm":file_tag_settings.accept=".zip";break;case"audio":file_tag_settings.accept=".mp3,.ogg";break;case"attachment":break;}
return m(".filepicker",[m("input[type=file]",file_tag_settings),file_done?m("b",{style:{transition:"opacity .25s ease-in-out"}},file_name+" uploaded!"):"",file_uploading?"Uploading "+file_name+" "+file_progress_string+"...":m(".upload",{ondragover:function(e){e.preventDefault();file_over=true;},ondragleave:function(e){e.preventDefault();file_over=false;},ondrop:fileDropped,onclick:function(){file_tag.click();},class:file_over?"over":"",},[m("img",{src:imgs.uploader}),m(".instructions",config.instructions),]),]);}
return{view:view,show:function(){visible=true;},hide:function(){visible=false;},toggle:function(){visible=!visible;},}}
var Player=function(){var content=null;var content_id=0;var timerId=null;var timerTimestamp=0;var record_resource=null;var is_embedded=false;var is_welcome=false;function oninit(vnode){if(vnode.attrs.embed_player){is_embedded=true;content_id=vnode.attrs.content_id;is_welcome=vnode.attrs.is_welcome;}
else if(m.route.param("content_id")){content_id=Ut.decodeId(m.route.param("content_id"));is_embedded=false;is_welcome=false;}
else{St.error="Player summoned without a content_id.";content_id=0;return;}
content=St.use("content/"+content_id);content.fetch();var person_id=Login.get('person_id');record_resource=St.use("people/"+person_id+"/content/"+content_id+"/record");function timerFired(){sendTime();}
timerId=window.setInterval(timerFired,60000);timerTimestamp=(new Date()).getTime();record_resource.set({launch_increment:true});record_resource.send();}
function onremove(){sendTime();if(timerId)window.clearInterval(timerId);}
function sendTime(){var time=Math.round((((new Date()).getTime())-timerTimestamp)/1000);record_resource.set({seconds_to_add:time});record_resource.send();timerTimestamp=(new Date()).getTime();}
function viewTopbar(){if(is_embedded)return null;return m(".player-topbar",[Main.viewError(),m("a.link",{href:"/home",oncreate:m.route.link},[Main.viewLogoImg(),m("span","Back to LMS"),]),]);}
function viewLoading(){return m(".player-loading",[viewTopbar(),m("p","Loading..."),]);}
function view(){if(content_id==0)return m("p","Content player requires content_id.");var c=content.get();if(R.isNil(c))return viewLoading();var player=null;switch(c.type){case'comment':player=m(DiscussionPlayer,{content_id:c.content_id});break;case'scorm':player=m(ScormPlayer,{content_id:c.content_id});break;case'lpath':player=m(LpathPlayer,{content_id:c.content_id});break;case'cb':player=m(CbPlayer,{content:c,is_welcome:is_welcome});break;default:St.error="Player given content of unknown type '"+c.type+"'";}
return m(".player",[viewTopbar(),m(".player",player),]);}
return{view:view,viewTopbar:viewTopbar,oninit:oninit,onremove:onremove,};};var ScormPlayer=function(){var data=null;var LOG=[];var inspector_visible=false;var content_id;var launch_fid;var launch_fname;var scorm_resource=null;function oninit(vnode){if(!vnode.attrs.content_id){St.error="Scorm player summoned without content_id.";content_id=0;return;}
content_id=vnode.attrs.content_id;window.API=API();window.API_1484_11=API();var person_id=Login.get('person_id');scorm_resource=St.use("people/"+person_id+"/content/"+content_id+"/scorm");initializeScorm();}
function initializeScorm(){data=null;LOG=[];inspector_visible=false;scorm_resource.fetch().then(function(val){var addrw=R.merge({reads:0,writes:0});data=R.map(addrw,val);launch_fid=get('sys.launch_fid');launch_fname=get('sys.launch_fname');});}
function log(fn,arg1,arg2,output){LOG.push({fn:fn,arg1:arg1,arg2:arg2,output:output});if(inspector_visible)m.redraw();}
function findOrCreate(key){var found=R.find(R.propEq('key',key),data);if(found)return found;var newitem={key:key,value:'',source:'new',reads:0,writes:0};data.push(newitem);return newitem;}
function set(key,val){var item=findOrCreate(key);item.writes++;if(item.source!='new')item.source=(item.value==val?'unchanged':'changed');item.value=val;save();return"true";}
function get(key){var item=findOrCreate(key);if(item.source=="new")item.source="not-set";item.reads++;make_count(item);make_children(item);return item.value;}
function make_count(item){var m=/(^.*\.)_count$/.exec(item.key);if(!m)return;var re=new RegExp(m[1]+'(\\d+)');var highest=function(top,item){return(test=item.key.match(re))?R.max(parseInt(test[1]),top):top;};item.value=R.reduce(highest,0,data)+1;item.source='computed';}
function make_children(item){var m=/\.([^.]*)\._children$/.exec(item.key);if(!m)return;var prefix=m[1];item.value={"comments_from_learner":"comment,location,timestamp","comments_from_lms":"comment,location,timestamp","interactions":"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description","learner_preference":"","objectives":"id,score,success_status,completion_status,description","score":"scaled,raw,min,max"}[m[1]];item.source='computed';}
function API(){var api={};var logAnd=R.curry(function(fn,names){R.forEach(function(name){api[name]=function(arg1,arg2){var output=fn(arg1,arg2);log(name,arg1,arg2,output);return output;};},names);});var logAndTrue=logAnd(function(){return"true";});var logAndGet=logAnd(function(key){return get(key);});var logAndSet=logAnd(function(key,val){return set(key,val);});var logAndZero=logAnd(function(){return"0";});var logAndStr=logAnd(function(code){return"";});logAndTrue(['LMSInitialize','Initialize','LMSFinish','Terminate','LMSCommit','Commit']);logAndGet(['LMSGetValue','GetValue']);logAndSet(['LMSSetValue','SetValue']);logAndZero(['LMSGetLastError','GetLastError']);logAndStr(['LMSGetErrorString','GetErrorString','LMSGetDiagnostic','GetDiagnostic']);return api;}
function debug(c){c.forEach(function(s){console.log("key:",s.key," value:",s.value);});}
function save(){var changed=R.filter(function(item){return item.source=='changed'||item.source=='new';},data);if(!R.isEmpty(changed)){scorm_resource.set(changed);scorm_resource.send();}}
function viewInspector(){if(!inspector_visible)return null;if(!data)return"No SCORM data to view.";return m("td.inspector",[m("table.scorm-data",[m("thead",m("tr",[m("th","SCORM Key"),m("th","Value"),m("th","Source"),m("th","Reads"),m("th","Writes"),])),m("tbody",data.map(function(d){var truncval=d.value;if(d.value&&String(d.value).length>50)
truncval=d.value.substring(0,50)+"...(see log)";return m("tr",[m("td",d.key),m("td","'"+truncval+"'"),m("td",{class:d.source},d.source),m("td",d.reads?d.reads:''),m("td",d.writes?d.writes:''),]);})),]),m(".scorm-log",[m("h3","SCORM communication log"),m("p","Waiting for course to initiate communication..."),LOG.map(function(l){var isSet=l.fn=="SetValue"||l.fn=="LMSSetValue";var c=isSet?"SetValue":"";var arg1=l.arg1?"'"+l.arg1+"'":'';var arg2=l.arg2?", '"+l.arg2+"'":'';var output=!isSet?" returned '"+l.output+"'":'';return m("p",{class:c},l.fn+"("+arg1+arg2+")"+output);}),]),]);}
function toggleScormView(){inspector_visible=!inspector_visible;}
function view(){if(content_id==0)return m("p","Scorm player requires content_id.");if(!launch_fid)return m("p","Determining SCORM launch file...");var is_admin=Login.is_admin();var has_scorm_insp_tag=Login.has_tag('$scorm-inspector');var can_view_scorm_inspector=(is_admin||has_scorm_insp_tag);var player_style={};var href="/api/files/"+launch_fid+"/"+launch_fname;return m(".scorm-player",[m("table",m("tr",[viewInspector(),m("td.scorm-course",m("iframe.player",{src:href,key:1})),])),can_view_scorm_inspector?m("button",{onclick:toggleScormView},"Toggle SCORM Viewer"):null,]);}
return{view:view,oninit:oninit};};var ScormEd=function(){var uploader=null;var content_id;var edit=false;var content_id;var view_player=false;var view_content_link=stream(false);function oninit(){if(!m.route.param("content_id")){St.error="Scorm editor summoned without a content_id.";content_id=0;return;}
content_id=Ut.decodeId(m.route.param("content_id"));uploader=Uploader({instructions:"Drop file here or click to select file to upload.",purpose:"scorm",related_id:content_id,callback:function(result_data){m.route.set("/content/"+Ut.encodeId(content_id));},});}
function view(){if(content_id==0)return m("p","Scorm editor requires content_id.");return m(".scorm-uploader",[Main.viewTop(),m(".dialog",[m(".title","Upload SCORM"),m("p","Upload your SCORM content (.zip file) by dragging a file over the drop zone or by clicking on it to select your file."),uploader.view(),]),Main.viewBottom(),]);}
return{view:view,oninit:oninit};};var Erules=function(){var rule_list=null;var new_erule_open=false;var person_picker={filter_prop:"name",filter_label:"Name",button_label:"Select a person or tag",placeholder_type:"person",};var content_picker={filter_prop:"title",filter_label:"Title",button_label:"Select a content item or tag",placeholder_type:"content",};function oninit(){St.use("people").fetch().then(function(data){var people=data.map(function(i){i.layout_type="person";return i;});var tags=Ut.tagsWithCountsFromObjList(people,"ptag");data=R.concat(people,tags);person_picker.original_list=data;person_picker.filtered_list=data;});St.use("content").fetch().then(function(data){var content=data.map(function(i){i.layout_type="content";return i;});var tags=Ut.tagsWithCountsFromObjList(content,"ctag");data=R.concat(content,tags);content_picker.original_list=data;content_picker.filtered_list=data;});St.use("erules").fetch().then(function(data){rule_list=data;});}
function extractTags(list){var isNothing=R.either(R.isNil,R.isEmpty);var tagprop=R.map(R.prop('tags'));var taglist=R.map(R.split(','));var nonempty=R.reject(isNothing);return R.compose(R.uniq,R.unnest,taglist,nonempty,tagprop)(list);};function save_new(){new_erule_open=false;var erule=St.use("erules");var new_rule={};if(person_picker.selected_item.layout_type=="ptag"){new_rule.person_tag=person_picker.selected_item.name;}else{new_rule.person_id=person_picker.selected_item.person_id;}
if(content_picker.selected_item.layout_type=="ctag"){new_rule.content_tag=content_picker.selected_item.title;}else{new_rule.content_id=content_picker.selected_item.content_id;}
rule_list.push(new_rule);erule.set(new_rule);erule.send();}
function viewList(){if(!rule_list||!person_picker.original_list||!content_picker.original_list)return"Loading...";function viewrule(r){var guts=[];if(r.person_id){var p=R.find(R.propEq('person_id',r.person_id),person_picker.original_list);if(!p)return m(".e","Someone who no longer exists! (This rule is invalid)");guts.push(m(".title",p.name));}
if(r.person_tag){guts.push(m("span","Any person with the tag "));guts.push(m(".title",'"'+r.person_tag+'"'));}
guts.push(m("i.material-icons","arrow_forward"));if(r.content_id){var c=R.find(R.propEq('content_id',r.content_id),content_picker.original_list);if(!c)return m(".e","Content which no longer exists! (This rule is invalid)");guts.push(m(".title",c.title));}
if(r.content_tag){guts.push(m("span","Any content with the tag "));guts.push(m(".title",'"'+r.content_tag+'"'));}
return m(".e",guts);}
var has_ptag=R.propIs(String,'person_tag');rule_list=R.sort(has_ptag,rule_list);return m(".erule-list",R.map(viewrule,rule_list));}
function clickNew(){new_erule_open=!new_erule_open;}
function viewCreateNew(){if(!new_erule_open)return null;return[m(".cards",[Ut.viewPickerButton(person_picker),Ut.viewPickerButton(content_picker),]),Ut.viewPickerStack(person_picker),Ut.viewPickerStack(content_picker),m('button.primary',{onclick:save_new},"Save Rule"),];}
function view(){return m(".erules",[Main.viewTop(),m(".page-controls",[m(".title","Enrollment rules"),m("a.link",{onclick:clickNew},"Create new enrollment rule"),viewCreateNew(),]),viewList(),]);}
return{view:view,oninit:oninit,};};var Records=function(){function oninit(){}
function view(){return m(".report-page",[Main.viewTop(),m(".page-controls",[m(".title","Records"),m(".cards",[m(".card.action",{onclick:function(){m.route.set("/records/edit");}},[m(".title","Manual entry"),m(".description","Create or edit a person's record for a content item")]),m(".card.action",{onclick:function(){m.route.set("/records/content");}},[m(".title","Content record report"),m(".description","View all records for a content item")]),m(".card.action",{onclick:function(){m.route.set("/records/people");}},[m(".title","Person record report"),m(".description","View all records for a person")]),]),]),]);}
return{view:view,oninit:oninit,};};var RecordContent=function(){var content=null;var st_record=null;var clist_open=false;var content_picker={callback:loadRecord,filter_prop:"title",filter_label:"Title",button_label:"Select a content item",placeholder_type:"content",};function oninit(){St.use("content").fetch().then(function(data){data=data.map(function(i){i.layout_type="content";return i;});content_picker.original_list=data;content_picker.filtered_list=data;var content_id=parseInt(m.route.param("content_id"));if(content_id){content_picker.selected_item=R.filter(R.propEq('content_id',content_id),data)[0];loadRecord();}});}
function loadRecord(){var c=content_picker.selected_item;if(!c)return;st_record=St.use("content/"+c.content_id+"/records");st_record.fetch();}
function viewARecord(r){return m("tr",[m("td",r["title"]),m("td",r["name"]),m("td",r["username"]),m("td",r["score"]),m("td",r["passed"]),m("td",r["failed"]),m("td",r["started_ts"]),m("td",r["completed"]?r["completed_ts"]:"No"),m("td",r["last_launched_ts"]),m("td",r["launch_count"]),m("td",r["duration_sec"]),m("td",r["frozen"]),m("td",m("a",{href:"/records/edit/person/"+r["person_id"]+"/content/"+r["content_id"],oncreate:m.route.link},"Edit")),]);}
function viewCbLink(){if(content_picker.selected_item.type!="cb")return null;var cid=content_picker.selected_item.content_id;return m("p",["This was built using the LMS and may have more advanced quiz records.",m("a.link[href='/records/cb/"+cid+"']",{oncreate:m.route.link},"View content builder quiz records.")]);}
function viewRecords(){if(!content_picker.selected_item)return null;if(!st_record.get())return"Loading...";return m(".manual-record",[m("h2","Records"),viewCbLink(),m("table",[m("thead",[m("tr",[m("th","Title"),m("th","Name"),m("th","Username"),m("th","Score"),m("th","Passed"),m("th","Failed"),m("th","Started"),m("th","Completed"),m("th","Last launched"),m("th","Launch count"),m("th","Duration (sec)"),m("th","Frozen?"),]),]),m("tbody",st_record.get().map(viewARecord)),]),]);}
function view(){return m(".record-content",[Main.viewTop(),m(".page-controls",[m(".title","View or edit a record"),m(".cards",[Ut.viewPickerButton(content_picker),]),Ut.viewPickerStack(content_picker),]),viewRecords(),]);}
return{view:view,oninit:oninit,};};var RecordPeople=function(){var person=null;var st_record=null;var plist_open=false;var people_picker={callback:loadRecord,filter_prop:"name",filter_label:"Name",button_label:"Select a person",placeholder_type:"person",};function oninit(){St.use("people").fetch().then(function(data){data=data.map(function(i){i.layout_type="person";return i;});people_picker.original_list=data;people_picker.filtered_list=data;var person_id=parseInt(m.route.param("person_id"));if(person_id){people_picker.selected_item=R.filter(R.propEq('person_id',person_id),data)[0];loadRecord();}});}
function loadRecord(){var c=people_picker.selected_item;if(!c)return;st_record=St.use("people/"+c.person_id+"/records");st_record.fetch();}
function viewARecord(r){return m("tr",[m("td",r["title"]),m("td",r["name"]),m("td",r["username"]),m("td",r["score"]),m("td",r["passed"]),m("td",r["failed"]),m("td",r["started_ts"]),m("td",r["completed"]?r["completed_ts"]:"No"),m("td",r["last_launched_ts"]),m("td",r["launch_count"]),m("td",r["duration_sec"]),m("td",r["frozen"]),m("td",m("a",{href:"/records/edit/person/"+r["person_id"]+"/people/"+r["person_id"],oncreate:m.route.link},"Edit")),]);}
function viewCbLink(){if(people_picker.selected_item.type!="cb")return null;var cid=people_picker.selected_item.person_id;return m("p",["This was built using the LMS and may have more advanced quiz records.",m("a.link[href='/records/cb/"+cid+"']",{oncreate:m.route.link},"View content builder quiz records.")]);}
function viewRecords(){if(!people_picker.selected_item)return null;if(!st_record.get())return"Loading...";return m(".manual-record",[m("h2","Records"),viewCbLink(),m("table",[m("thead",[m("tr",[m("th","Title"),m("th","Name"),m("th","Username"),m("th","Score"),m("th","Passed"),m("th","Failed"),m("th","Started"),m("th","Completed"),m("th","Last launched"),m("th","Launch count"),m("th","Duration (sec)"),m("th","Frozen?"),]),]),m("tbody",st_record.get().map(viewARecord)),]),]);}
function view(){return m(".record-people",[Main.viewTop(),m(".page-controls",[m(".title","View or edit a record"),m(".cards",[Ut.viewPickerButton(people_picker),]),Ut.viewPickerStack(people_picker),]),viewRecords(),]);}
return{view:view,oninit:oninit,};};var RecordEdit=function(){var st_record=null;var saving=false;var saved=false;var person_picker={callback:loadRecord,filter_prop:"name",filter_label:"Name",button_label:"Select a person",placeholder_type:"person",};var content_picker={callback:loadRecord,filter_prop:"title",filter_label:"Title",button_label:"Select a content item",placeholder_type:"content",};function oninit(){St.use("people").fetch().then(function(data){data=data.map(function(i){i.layout_type="person";return i;});person_picker.original_list=data;person_picker.filtered_list=data;var person_id=parseInt(m.route.param("person_id"));if(person_id){person_picker.selected_item=R.find(R.propEq('person_id',person_id),data);loadRecord();}});St.use("content").fetch().then(function(data){data=data.map(function(i){i.layout_type="content";return i;});content_picker.original_list=data;content_picker.filtered_list=data;var content_id=parseInt(m.route.param("content_id"));if(content_id){content_picker.selected_item=R.filter(R.propEq('content_id',content_id),data)[0];loadRecord();}});}
function loadRecord(){if(!person_picker.selected_item||!content_picker.selected_item)return;var pid=person_picker.selected_item.person_id;var cid=content_picker.selected_item.content_id;st_record=St.use("people/"+pid+"/content/"+cid+"/record");st_record.fetch();}
function save(){saving=true;st_record.send().then(function(){saving=false;saved=true;});}
function viewRecords(){if(!person_picker.selected_item||!content_picker.selected_item)return null;if(!st_record.get())return"Loading...";return m(".manual-record.dialog",[m(".title","Edit this record"),Ut.viewBoundInput("score",st_record.prop("score")),Ut.viewBoundInput("passed",st_record.prop("passed")),Ut.viewBoundInput("failed",st_record.prop("failed")),Ut.viewBoundInput("completed",st_record.prop("completed")),Ut.viewBoundInput("started_ts",st_record.prop("started_ts")),Ut.viewBoundInput("completed_ts",st_record.prop("completed_ts")),Ut.viewBoundInput("last_launched_ts",st_record.prop("last_launched_ts")),Ut.viewBoundInput("launch_count",st_record.prop("launch_count")),Ut.viewBoundInput("duration_sec",st_record.prop("duration_sec")),Ut.viewBoundInput("frozen",st_record.prop("frozen")),m("button",{onclick:save},saving?"Saving...":"Save Changes"),m("span",saved?"Saved":""),]);}
function view(){return m(".record-tool",[Main.viewTop(),m(".page-controls",[m(".title","Create or edit a record"),m(".cards",[Ut.viewPickerButton(person_picker),Ut.viewPickerButton(content_picker),]),Ut.viewPickerStack(person_picker),Ut.viewPickerStack(content_picker),]),viewRecords(),]);}
return{view:view,oninit:oninit,};};var RecordCb=function(){var content=null;var selected_content=null;var st_record=null;var clist_open=false;var content_picker={callback:loadRecord,filter_prop:"title",filter_label:"Title",button_label:"Select a content item",placeholder_type:"content",};function oninit(){St.use("content?type=cb").fetch().then(function(data){data=data.map(function(i){i.layout_type="content";return i;});content_picker.original_list=data;content_picker.filtered_list=data;var content_id=parseInt(m.route.param("content_id"));if(content_id){content_picker.selected_item=R.filter(R.propEq('content_id',content_id),data)[0];loadRecord();}});}
function loadRecord(){var c=content_picker.selected_item;if(!c)return;st_record=St.use("content/"+c.content_id+"/cb-records");st_record.fetch();}
function viewARecord(r){return m("tr",[m("td",r["content_id"]),m("td",r["person_id"]),m("td",r["page_hash"]),m("td",r["answer"]),m("td",r["is_correct"]),m("td",r["answered_ts"]),]);}
function viewRecords(){if(!content_picker.selected_item)return null;if(!st_record.get())return"Loading...";return m(".manual-record",[m("h2","Content builder quiz records"),m("table",[m("thead",[m("tr",[m("th","Content Id"),m("th","Person Id"),m("th","page_hash"),m("th","answer"),m("th","is_correct"),m("th","answered_ts"),]),]),m("tbody",st_record.get().map(viewARecord)),]),]);}
function view(){return m(".record-content",[Main.viewTop(),m(".page-controls",[m(".title","Select a content builder item"),m(".cards",[Ut.viewPickerButton(content_picker),]),Ut.viewPickerStack(content_picker),]),viewRecords(),]);}
return{view:view,oninit:oninit,};};var LoginComponent=function(){var credentials=St.use("tokens");function oninit(){}
function login_success(response_data){set('logged_in','yes');set('tags',response_data.person_info.tags);set('auth_token',response_data.token);set('name',response_data.person_info.name);set('person_id',response_data.person_info.person_id);set('thumb_file_id',response_data.person_info.thumb_file_id);set('thumb_fname',response_data.person_info.thumb_fname);m.route.set('/home');}
function login(){function failure(response_data){St.error="Sorry, your credentials were incorrect.";}
credentials.send().then(login_success,failure);}
function access_token_login(t){login_success(t);}
function set(key,value){localStorage.setItem(key,value);}
function get(key){if(!is_logged_in())return null;return localStorage.getItem(key);}
function is_logged_in(){return localStorage.getItem("logged_in")=='yes';}
function is_admin(){return has_tag('$admin');}
function has_tag(tagname){var tags=Ut.tagstrToList(get("tags"));return R.contains(tagname,tags);}
function logout(){m.route.set("/login");localStorage.clear();}
function view(){return[Main.viewTop(),m(".dialog.form",[m(".title","Login"),Ut.viewBoundInput("Username",credentials.prop('username')),Ut.viewBoundPassword("Password",credentials.prop('password')),m(".centered",[m("button.primary",{onclick:login},"Log in"),m("br"),m("a",{href:"/forgot-pwd",oncreate:m.route.link},"Forgot password or username"),]),]),Main.viewBottom(),];}
return{view:view,oninit:oninit,logout:logout,get:get,set:set,has_tag:has_tag,is_admin:is_admin,is_logged_in:is_logged_in,access_token_login:access_token_login,};};var Login=LoginComponent();var ForgotPwd=function(){var acctok=St.use("tokens/access");var btntxt="";function oninit(){btntxt="Request change password email";acctok.set({username:"",email:""});}
function request_email(){btntxt="Sending...";m.redraw();acctok.send().then(function(){btntxt="Email sent";sending_change_pwd=false;});}
function view(){return[Main.viewTop(),Ut.viewBoundInput("Username",acctok.prop('username')),m("p","or"),Ut.viewBoundInput("Email address",acctok.prop('email')),m("button",{onclick:request_email},btntxt),Main.viewBottom(),];}
return{view:view,oninit:oninit,};};var ChangePwd=function(){var access_token="";var credentials=St.use("tokens");var message="";function oninit(){access_token=m.route.param("access_token");message="Logging in using access token "+access_token+"...";credentials.set({access_token:access_token});credentials.send().then(success,failure);}
function success(response_data){Login.access_token_login(response_data);m.route.set('/people/me');}
function failure(response_data){if(response_data.hypermedia&&response_data.hypermedia.description){message="Sorry, unable to grant access: "+response_data.hypermedia.description;}
else{message="Sorry, unable to grant access. Please make sure the link is intact and perhaps try generating a new one.";}}
function view(){return[m("p",message),Main.viewBottom(),];}
return{view:view,oninit:oninit,};};var Home=function(){var person_id;var bundle;var new_content_title_form=false;var new_title=stream("");var admin_view_welcome=false;var my_content_orig=null;var my_content_filtered=null;function oninit(vnode){if(vnode.attrs.person_id){person_id=vnode.attrs.person_id;}
else if(Login.is_logged_in()){person_id=Login.get('person_id');}
else{m.route.set("/login");}
bundle=St.use("people/"+person_id+"/home");bundle.fetch().then(function(data){my_content_orig=bundle.get().content;my_content_filtered=R.clone(my_content_orig);});admin_view_welcome=false;}
function viewMyContent(){if(!my_content_filtered){return"Loading...";}
function click(c){m.route.set("/content/"+Ut.encodeId(c.content_id));}
function viewRecords(c){var rs=bundle.get().records;var r=R.find(R.propEq('content_id',c.content_id),rs);if(r){var rec="";if(r.last_launched_ts){var d=moment(r.last_launched_ts);rec="Last launched: "+d.format('MMM Do, YYYY');}
return m(".records",""+rec);}
return null;}
viewThumb=Content.viewThumb({onclick:click,records:viewRecords});my_content_filtered=R.filter(function(c){return(c.title!="Welcome");},my_content_filtered);return m(".cards",R.map(viewThumb,my_content_filtered));}
function viewAdminControls(){if(!Login.is_admin())return null;return null;}
function viewWelcome(){var d=bundle.get();if(Login.is_admin()){if(!d.welcome_exists){return[m("p","There is no learner welcome message."),m("a[href=/content/new/welcome]",{oncreate:m.route.link},"Click here to create one."),];}
if(!admin_view_welcome){return m("a.link",{onclick:function(){admin_view_welcome=true;}},"View learner welcome");}}
if(!d.welcome_exists)return null;return m(Player,{embed_player:true,content_id:d.welcome_id,is_welcome:true});}
function viewCatalogLink(bundle){if(!bundle.catalog_exists)return null;var count=(bundle.catalog_count==1?"(1 item)":"("+bundle.catalog_count+" items)");return m("div",m("a.link",{oncreate:m.route.link,href:"/catalog"},"View catalog "+count));}
function viewSearchBox(){var search=m.withAttr("value",function(s){s=R.toLower(s);var gettxt=function(c){return c.title+c.description;}
var f=R.compose(R.contains(s),R.toLower,gettxt);my_content_filtered=R.filter(f,my_content_orig);});return m(".searchbox.input-with-icon",[m("input[type=text]",{oninput:search,placeholder:"content keywords"}),m("i.material-icons","search"),]);}
function viewLearnerBuildLink(){if(Main.customConfig('show_learner_build_content')===false)return null;return m("a[href=/content/new/cb]",{oncreate:m.route.link},"Build new content");}
function view(){if(!Login.is_logged_in())return m("p","Sorry, you are not logged in. Please refresh your browser.");var d=bundle.get();return m(".home",[Main.viewTop(),!d?"Loading...":[m(".page-controls",[viewAdminControls(),viewWelcome(),m("h1","Content Assigned to Me"),m("p","Below are my content items, learning paths, and discussions."),viewSearchBox(),viewLearnerBuildLink(),viewCatalogLink(d),m("br.clear"),]),viewMyContent(),],Main.viewBottom(),]);}
return{view:view,oninit:oninit,};};var PeopleComponent=function(){var raw_list=St.use("people");var filtered_list=null;var viewEditThumb=viewThumb(editClick);var tags=null;function oninit(){raw_list.fetch().then(function(list){list=Ut.sortAlphaBy("name",list);filtered_list=list;tags=Tags(list,{filter_on_click:true,on_filter:onFilter});});}
function onFilter(list){filtered_list=list;}
function editClick(person){m.route.set("/people/"+person.person_id);}
function viewThumb(onclick){return function(person){function click(){if(onclick){onclick(person);}};return m(".card.person",{onclick:click},[viewAvatar(person),m(".name",person.name),m(".username",person.username),]);};}
function viewAvatar(person){var path="/api/files/"+person.thumb_file_id+"/"+person.thumb_fname;if(R.isNil(person.thumb_file_id)){path=imgs.default_avatar;}
if(person.avatar)path=person.avatar;return m("img.avatar",{src:path});}
function view(){return[Main.viewTop(),m(".page-controls",[m(".title","People"),m("a[href=/people/new]",{oncreate:m.route.link},"Add person"),m("br"),m("a[href=/people/import]",{oncreate:m.route.link},"Import people"),R.isNil(tags)?null:tags.viewThumbList(),m("a.link[href=/people/metatags]",{oncreate:m.route.link},"Manage metatags"),]),R.isNil(filtered_list)?m("p","Loading..."):m(".cards",R.map(viewEditThumb,filtered_list)),Main.viewBottom(),];}
return{view:view,oninit:oninit,viewThumb:viewThumb,viewAvatar:viewAvatar,};};var People=PeopleComponent();var PersonEd=function(){var uploader=null;var person;var person_id=0;var home_visible=false;var sending_change_pwd="";var editing_self=false;var metatags=St.use('people/metatags');function oninit(){sending_change_pwd="Send change password email";metatags.fetch();var new_type=m.route.param("type");if(m.route.get()=="/people/new"){person_id="new";var person_obj={name:"",username:"",password:"",email:"",tags:"",};person=St.use("people");person.set(person_obj);}
else if(m.route.param("person_id")){person_id=m.route.param("person_id");if(person_id=="me"){editing_self=true;person_id=Login.get('person_id');}
else{editing_self=false;}
person=St.use("people/"+person_id);person.fetch().then(function(){var p=person.get();p.password="";person.set(p);person_id=p.person_id;});}
else{St.error="Person editor summoned without a person_id.";person_id=0;return;}
uploader=Uploader({instructions:"Drop image here or click to upload.",purpose:"person-thumb",related_id:person_id,callback:afterUpload,});home_visible=false;}
function afterUpload(result_data){var p=person.get();p.thumb_fname=result_data.launch_fname;p.thumb_file_id=result_data.file_id;person.set(p);if(Login.get('person_id')==person.get().person_id){Login.set('thumb_file_id',p.thumb_file_id);Login.set('thumb_fname',p.thumb_fname);}}
function applyMetaTags(){var mtags=metatags.get().metatags;if(!mtags)return;var curtags=Ut.tagstrToList(person.prop("tags").get());if(curtags=='')return;function rule_fits(mt){function and_or(word,a,b){if(word=="AND"){return a&&b;};if(word=="OR"){return a||b;};}
var rule=mt.rule.match(/(\S+)\s+(AND|OR)\s+(\S+)/);var has_tag1=R.contains(rule[1],curtags);var andor=rule[2];var has_tag2=R.contains(rule[3],curtags);return and_or(andor,has_tag1,has_tag2);}
function prepend_star(t){return"*"+t;}
function is_new(t){return R.not(R.contains(t,curtags));}
var mt_to_add=R.filter(rule_fits,mtags);mt_to_add=R.uniq(R.map(R.prop("tag_name"),mt_to_add));mt_to_add=R.map(prepend_star,mt_to_add);mt_to_add=R.filter(is_new,mt_to_add);var newtags=R.concat(curtags,mt_to_add);var newtagstr=R.join(',',newtags);person.prop("tags").set(newtagstr);}
function save(){applyMetaTags();if(Login.get('person_id')==person.get().person_id){Login.set('name',person.get().name);}
if(person_id=="new"||person.prop("password").get().length>0){if(person.prop("password").get().length<4){St.error="New user password must be at least 4 characters long. Longer passwords are generally more secure.";return;}}
person.send().then(function(){if(Login.is_admin()){m.route.set("/people");}else{m.route.set("/home");}});}
function changepwd(){sending_change_pwd="Sending...";m.redraw();var acctok=St.use("tokens/access");acctok.set({person_id:person.get().person_id});acctok.send().then(function(){sending_change_pwd="Email sent";});}
function viewHome(){if(!home_visible)return null;return m(Home,{person_id:person.get().person_id});}
function viewAdminControls(){if(!Login.is_admin())return null;return[m("a.link",{href:"/records/people/"+person_id,oncreate:m.route.link},"View records"),];}
function viewIsFrozen(){var tags=Ut.tagstrToList(person.get().tags);if(R.contains('$frozen',tags)){return m('h2.danger','This person is frozen');}
else{return null;}}
function view(){if(person_id==0)return m("p","Person editor requires person_id.");if(R.isNil(person.get()))return Ut.viewLoading();var cancel=function(){if(editing_self){m.route.set("/home");}
else{m.route.set("/people");}}
var dialog_title=(person_id==0?"Create New":"Edit "+person.prop('name').get());var thumb=person.get().thumb_file_id?"/api/files/"+person.get().thumb_file_id+"/"+person.get().thumb_fname:imgs.default_avatar;return m(".people-edit",[Main.viewTop(),m(".dialog",[m(".title",dialog_title),m(".form",[viewIsFrozen(),People.viewAvatar(person.get()),uploader.view(),m("br"),Ut.viewBoundInput("Name",person.prop('name')),Ut.viewBoundInput("Username",person.prop('username')),Ut.viewBoundPassword("Password",person.prop('password')),person_id!="new"&&Login.is_admin()?[m("button.primary",{onclick:changepwd},sending_change_pwd),]:null,Ut.viewBoundInput("Email",person.prop('email')),Login.is_admin()?Ut.viewBoundInput("Tags",person.prop('tags')):null,m("button.primary",{onclick:save},"Save"),m("button",{onclick:cancel},"Cancel"),viewAdminControls(),]),]),]);}
return{view:view,oninit:oninit,save:save,};};var PeopleMetaTags=function(){var new_dialog_open=false;var people=St.use('people');var tags;var metatags=St.use('people/metatags');var new_metatag={};var test_results=[];function oninit(){people.fetch().then(setup_tags);metatags.fetch();new_metatag.tag_name=stream("new-metatag");new_metatag.rule=stream("");}
function setup_tags(){tags=Tags(people.get(),{on_click:tag_clicked});}
function tag_clicked(t){var r=new_metatag.rule();new_metatag.rule(r+" "+t);}
function person_tags(p){return R.split(',',R.trim(p.tags));}
function syntax_check(rule){var okay=true;var bits=R.split(/\s/,rule);if(bits.length!=3)okay=false;if(bits[1]!="AND"&&bits[1]!="OR")okay=false;if(!okay)St.error="Sorry, the rule must be in the form \"tag1 AND tag2\" or \"tag1 OR tag2\".";}
function save_new(){var ruletxt=R.trim(new_metatag.rule());syntax_check(ruletxt);var t='*'+new_metatag.tag_name();test();function add_tag_and_save(p){var ptags=person_tags(p);if(R.contains(t,ptags)){St.error="The '"+t+"' tag name is already in use.";return;}
ptags.push(t);p.tags=R.join(',',ptags);var uri="people/"+p.person_id;var P=St.use(uri);P.set(p);P.send();}
R.map(add_tag_and_save,test_results);var st_mt=St.use('people/metatags');st_mt.set({tag_name:new_metatag.tag_name(),rule:new_metatag.rule(),});st_mt.send().then(function(new_id){new_dialog_open=false;metatags.fetch();});}
function viewMetatags(){var mtags=metatags.get();if(R.isNil(mtags))return"Loading meta tags...";return m(".metatags",[m("h1","People metatags"),R.map(function(t){return m("p",[m("ul.tags",m("li",t.tag_name+" = "+t.rule)),]);},mtags.metatags),]);}
function test(){var ruletxt=R.trim(new_metatag.rule());syntax_check(ruletxt);var r=R.split(' ',ruletxt);function test_person(p){if(!p.tags)return false;var ptags=R.split(',',R.trim(p.tags));if(r[1]=="AND")return test_and(r[0],r[2],ptags);if(r[1]=="OR")return test_or(r[0],r[2],ptags);}
test_results=R.filter(test_person,people.get());if(R.isEmpty(test_results))test_results=[{name:"No matches"}];}
function test_and(tag1,tag2,tags){return R.contains(tag1,tags)&&R.contains(tag2,tags);}
function test_or(tag1,tag2,tags){return R.contains(tag1,tags)||R.contains(tag2,tags);}
function clickNew(){new_dialog_open=!new_dialog_open;}
function viewNewDialog(){if(!new_dialog_open)return null;return m(".dialog",[m(".title","Create a new metatag"),m(".form",[m("label","Name:"),m("input[type=text]",{onchange:m.withAttr('value',new_metatag.tag_name),value:new_metatag.tag_name()}),m("label","Rule:"),m("input[type=text]",{onchange:m.withAttr('value',new_metatag.rule),value:new_metatag.rule()}),m("i","Rules must be in the form \"tag1 AND tag2\" or \"tag1 OR tag2\"."),]),test_results.map(function(p){return m("p",p.name);}),m(".tags",[m("button",{onclick:function(){tag_clicked("AND");}},"AND"),m("button",{onclick:function(){tag_clicked("OR");}},"OR"),]),R.isNil(tags)?null:tags.viewThumbList(),m("button",{onclick:test},"test"),m("button.primary",{onclick:save_new},"Apply and Save"),]);}
function view(){var mtags=metatags.get();return m(".metatags",[Main.viewTop(),m(".page-controls",[m("h2","Metatags"),m("a.link",{onclick:clickNew},"Create new metatag"),]),viewNewDialog(),viewMetatags(),]);}
return{view:view,oninit:oninit};};var PeopleImport=function(){var uploader=null;var import_results=null;var view_raw=false;function oninit(){uploader=Uploader({instructions:"Drop CSV file here or click to upload.",purpose:"people-import",callback:afterUpload,});}
function afterUpload(result_data){uploader.hide();import_results=result_data.imported;}
function viewImportResults(){if(!import_results)return null;var head="name,email,tags,username,info,pid,access_link\n";var raw_csv=import_results.reduce(function(txt,p){p=p.map(function(z){return'"'+z+'"'});return txt+p.join(",")+"\n";},head);var raw_csv_uri=encodeURIComponent(raw_csv);var raw_csv_data="data:text/csv;charset=utf-8,"+raw_csv_uri;return m(".import-results",[m("table",[m("thead",m("tr",[m("th","Name"),m("th","Email"),m("th","Username"),m("th","Access link"),])),import_results.map(function(p){var mt="mailto:"+p[1];return m("tr",m("td",p[0]),m("td",m("a",{href:mt},p[1])),m("td",p[3]),m("td",m("a",{href:p[6]},"link")),);}),]),m("a",{href:raw_csv_data,download:"import-results.csv"},"Download these results as a CSV")," (Recommended)",]);}
function viewRawResults(){if(!view_raw)return null;var head="name,email,tags,username,info,pid,access_link\n";return m("textarea",import_results.reduce(function(csvtxt,p){p=p.map(function(z){return'"'+z+'"'});return csvtxt+p.join(",");},head));}
function view(){return m(".people-import",[Main.viewTop(),m(".dialog",[m(".title","Import People"),m("p","To import more than one person at a time, you can submit a CSV file.  CSV stands for 'Comma-Separated Values' and is a common interchange format for tabular data such as spreadsheets. Most spreadsheet programs can import and export the CSV format."),m("a",{href:"person-import-example.csv"},"Download sample CSV file"),m("p","Only the 'name' column is required."),m("h3","Upload CSV file to start import"),uploader.view(),viewImportResults(),]),]);}
return{view:view,oninit:oninit,};};var ContentComponent=function(){var raw_list=St.use("content");var filtered_list=null;var tags=null;var uploader=null;var type_counts={cb:0,comment:0,lpath:0,scorm:0,};function oninit(){raw_list.fetch().then(function(list){list=Ut.sortAlphaBy("title",list);list=injectTypesAsTags(list);filtered_list=list;tags=Tags(list,{filter_on_click:true,on_filter:onFilter});});}
function onFilter(list){filtered_list=list;}
function injectTypesAsTags(list){function injectTag(c){if(c.tags!="")c.tags+=",";if(c.type=="scorm"){c.tags+="$scorm";type_counts.scorm++;}
if(c.type=="cb"){c.tags+="$content-builder";type_counts.cb++;}
if(c.type=="comment"){c.tags+="$discussion";type_counts.comment++;}
if(c.type=="lpath"){c.tags+="$learning-path";type_counts.lpath++;}
return c;}
return R.map(injectTag,list);}
function editClick(content){m.route.set("/content/"+Ut.encodeId(content.content_id));}
function viewThumb(config){return function(content){var records=null;var element_props={};element_props.config=function(el){el.content_ref=content;};element_props.key=content.content_id;if(config.onclick){element_props.onclick=function(){config.onclick(content);};}
if(config.onselected_display){element_props.onclick=function(){if(content.ui_selected){content.ui_selected=false;}
else{content.ui_selected=true;}}}
if(config.records)records=config.records(content);var type="";switch(content.type){case"comment":type="Discussion";break;case"scorm":type="SCORM Course";break;case"cb":type="Content";break;case"lpath":type="Learning Path";break;}
if(config.onselected_display&&content.ui_selected){return config.onselected_display(content);}
var desc_maxlen=120;var trunc_desc=content.description.substring(0,desc_maxlen);if(content.description.length>desc_maxlen)trunc_desc+="...";return m(".card.content",element_props,[viewThumbImg(content),m(".type",[m("img",{src:imgs[content.type]}),m("span",type),]),m("div.title",content.title),m("div.description",trunc_desc),records,]);};}
function viewThumbImg(content){var path="/api/files/"+content.thumb_file_id+"/"+content.thumb_fname;if(R.isNil(content.thumb_file_id)){path=imgs.default_thumb;}
if(content.thumb)path=content.thumb;return m("img.thumb",{src:path});}
function submitNew2(){submitNew(new_type(),new_title());}
function submitNew(type,title){var newc=St.use("content");newc.set({type:type,title:title,});newc.send().then(function(data){m.route.set("/content/"+Ut.encodeId(data.new_id));});}
function viewDiscussionTypeLink(){if(Main.customConfig('show_discussion_type')===false)return null;return[m("a.link[href='/content/new/comment']",{oncreate:m.route.link},"Create Discussion")," | ",];}
function view(){return[Main.viewTop(),m(".page-controls",[m(".title","Content"),m("p",[m("a.link[href='/content/new/cb']",{oncreate:m.route.link},"Content Builder")," | ",m("a.link[href='/content/new/scorm']",{oncreate:m.route.link},"Upload Scorm")," | ",viewDiscussionTypeLink(),m("a.link[href='/content/new/lpath']",{oncreate:m.route.link},"Create Learning Path"),]),R.isNil(tags)?null:[m("h3","Tags"),tags.viewThumbList(),],]),R.isNil(filtered_list)?m("p","Loading..."):m(".cards",R.map(viewThumb({onclick:editClick}),filtered_list)),Main.viewBottom(),];}
return{view:view,oninit:oninit,viewThumb:viewThumb,viewThumbImg:viewThumbImg,submitNew:submitNew,};};Content=ContentComponent();var ContentViewer=function(){var content;var content_id;var view_content_link=stream(false);var tags=null;var record=null;function loadContent(vnode){if(!vnode.attrs.content_id){St.error="Content viewer summoned without a content_id.";content_id=0;return;}
new_content_id=Ut.decodeId(vnode.attrs.content_id);if(new_content_id==content_id)return;content_id=new_content_id;content=St.use("content/"+content_id);content.fetch().then(function(data){content=content.get();tags=Tags([content],{filter_on_click:false});});var me=Login.get('person_id');var st_record=St.use("people/"+me+"/content/"+content_id+"/record");st_record.fetch().then(function(data){record=st_record.get();});}
function onupdate(vnode){loadContent(vnode);}
function oninit(vnode){loadContent(vnode);}
function viewContentLink(){var text="Show link";var result=[m("a.link",{onclick:Ut.toggleProp(view_content_link)},text)];if(view_content_link()){var id=Ut.encodeId(content.content_id);var title=content.title;result.push(m(".form",m("input[type=text]",{value:"<player/"+id+":\""+title+"\">"})));}
result.push(m("br"));return result;}
function view(){if(content_id==0)return m("p","Content viewer requires content_id.");if(R.isNil(content))return[Main.viewTop(),m("p","Loading...")];var is_admin=Login.is_admin();var can_edit=(content.author==Login.get('person_id')||is_admin);function viewDiscussion(){if(content.type!='comment')return null;return m(DiscussionPlayer,{content_id:content_id});}
function viewLpath(){if(content.type!='lpath')return null;return m(LpathPlayer,{content_id:content_id});}
function viewLaunchBtn(){if(content.type=="lpath"||content.type=="comment")return null;if(content.type=="scorm"&&!content.scorm_uploaded){return null;}
return m(".centered",[m("button.primary",{onclick:function(){m.route.set("/player/"+Ut.encodeId(content_id));}},"Launch"),]);}
function viewRecord(){if(!record)return null;var r=record;return m("table.mini-report",[m("thead",[m("tr",[m("th","Title"),m("th","Name"),m("th","Score"),m("th","Passed"),m("th","Failed"),m("th","Started"),m("th","Completed"),m("th","Last launched"),m("th","Launch count"),m("th","Duration (sec)"),]),]),m("tbody",("tr",[m("td",r["title"]),m("td",r["name"]),m("td",r["score"]),m("td",r["passed"]),m("td",r["failed"]),m("td",r["started_ts"]),m("td",r["completed"]?r["completed_ts"]:"No"),m("td",r["last_launched_ts"]),m("td",r["launch_count"]),m("td",r["duration_sec"]),])),]);}
function viewTags(){if(R.isNil(tags)||!is_admin)return null;return[m("h3","Tags"),tags.viewThumbList(),];}
function viewEditLinks(can_edit){if(!can_edit)return null;var output=[];var encid=Ut.encodeId(content_id);var edit_tags_txt=(is_admin?", tags":"");output.push(m("a.link",{href:"/content/"+encid+"/edit",oncreate:m.route.link},"Edit title, description"+edit_tags_txt));output.push(m("br"));if(content.type=='scorm'){output.push(m("a.link",{href:"/content/"+encid+"/edit-scorm",oncreate:m.route.link},"Upload SCORM module"));output.push(m("br"));}
if(content.type=='lpath'){output.push(m("a.link",{href:"/content/"+encid+"/edit-lpath",oncreate:m.route.link},"Edit learning path"));output.push(m("br"));}
if(content.type=='cb'){output.push(m("a.link",{href:"/content/"+encid+"/edit-cb",oncreate:m.route.link},"Edit content"));output.push(m("br"));}
return output;}
function viewCertificateLink(){if(!record)return null;if(Main.customConfig('show_print_cert')===false)return null;var tags=Ut.tagstrToList(content.tags);if(!R.contains('$certificate',tags)||!record['completed'])return null;var me=Login.get('person_id');var cid=content.content_id;var url="/api/people/"+me+"/content/"+cid+"/certificate.pdf";return m("a.link",{href:url,target:"_blank"},"Download certificate (PDF)");}
return m(".content-viewer",[Main.viewTop(),m(".dialog",[m(".title",content.title),Content.viewThumbImg(content),m(".description",content.description),viewTags(),m("h3","Actions"),viewEditLinks(can_edit),viewContentLink(),viewCertificateLink(),m("br"),is_admin?m("a.link",{href:"/records/content/"+content_id,oncreate:m.route.link},"View records"):null,m("br.clear"),viewDiscussion(),viewLpath(),viewLaunchBtn(),]),viewRecord(),Main.viewBottom(),]);}
return{view:view,onupdate:onupdate,oninit:oninit,};};var ContentEd=function(){var thumb_uploader=null;var content=null;var content_id=0;var content_api=null;function oninit(){var new_type=m.route.param("type");content_id=m.route.param("content_id");if(new_type){content_id="new";content={content_id:0,title:"",type:new_type,description:"",tags:"",};if(new_type=="welcome"){content.type="cb";content.title="Welcome";content.description="Learner welcome message (visible to all learners on the Home page).";}
content_api=St.use("content");content_api.set(content);}
else if(content_id){content_id=Ut.decodeId(content_id);content_api=St.use("content/"+content_id);content_api.fetch().then(function(data){content=content_api.get();});}
else{St.error="Content editing summoned without a content_id or new content type.";content_id=0;return;}
thumb_uploader=Uploader({instructions:"Drop image here or click to upload new thumbnail.",purpose:"content-thumb",related_id:content_id,callback:function(result_data){content.thumb_fname=result_data.launch_fname;content.thumb_file_id=result_data.file_id;},});}
function save(){content_api.send().then(function(data){if(content_id=="new"){content_id=data.new_id;content.content_id=data.new_id;}
m.route.set("/content/"+Ut.encodeId(content.content_id));});}
function view(){if(content_id==0)return m("p","Content editing requires content_id or new content type.");if(R.isNil(content))return[Main.viewTop(),m("p","Loading...")];var can_edit_tags=Login.is_admin();var dialog_title=(content_id=="new"?"Create New":"Edit "+content.title);return m(".content-edit",[Main.viewTop(),m(".dialog",[m(".title",dialog_title),Content.viewThumbImg(content),m("p","Thumbnail image"),thumb_uploader.view(),m("p","Thumbnail image dimensions: 280x225"),m(".form",[Ut.viewBoundInput("Title",content_api.prop('title')),Ut.viewBoundInput("Description",content_api.prop('description')),can_edit_tags?Ut.viewBoundInput("Tags",content_api.prop('tags')):null,m("button.primary",{onclick:save},"Save"),]),]),Main.viewBottom(),]);}
return{view:view,oninit:oninit};};var Catalog=function(){var raw_list=St.use("catalog");var filtered_list=null;var lpaths=St.use("lpaths");function oninit(){raw_list.fetch().then(function(list){list=Ut.sortAlphaBy("title",list);filtered_list=list;});}
function onFilter(list){filtered_list=list;}
function viewContent(){if(!filtered_list){return"Loading...";}
function click(c){m.route.set("/content/"+Ut.encodeId(c.content_id));}
viewThumb=Content.viewThumb({onclick:click});return m(".cards",R.map(viewThumb,filtered_list));}
function view(){return[Main.viewTop(),m(".page-controls",[m(".title","Catalog"),]),viewContent(),Main.viewBottom(),];}
return{view:view,oninit:oninit,};};var LpathEd=function(){var my_content_id;var lpath;var html_item_list_container=null;var addContentAutocomplete=null;var selected_id=null;function oninit(){if(!m.route.param("content_id")){St.error="Learning path editor summoned without a content_id.";my_content_id=0;return;}
my_content_id=Ut.decodeId(m.route.param("content_id"));lpath=St.use("content/"+my_content_id+"/lpath");lpath.fetch();addContentAutocomplete=LpathAddContent(onAdd);}
var sortConfig={oncreate:function(vnode){html_item_list_container=vnode.dom;Sortable.create(vnode.dom,{animation:150,onUpdate:onSort});}};function viewThumb(c){function set_content_ref(vnode){vnode.dom.content_ref=c;}
function select(){selected_id=c.content_id;}
function cancel(){if(!c){St.error="Sorry, the learning path list is confused. Please try again.";}
selected_id=null;}
function remove(){var lp=lpath.get();var list=lp.content;var index=R.findIndex(R.propEq('content_id',c.content_id),list);if(index==-1){St.error="Sorry, could not remove this item. Please try again.";}
lp.list=list.splice(index,1);lpath.set(lp);}
if(c.content_id==selected_id){return m(".stackitem",[m("i","Remove "+c.title+"?"),m("button.primary",{onclick:remove},"Remove"),m("button",{onclick:cancel},"Cancel"),]);}
return m(".stackitem",{oncreate:set_content_ref},[Content.viewThumbImg(c),m(".title",c.title),m("a.link.action",{onclick:select},"REMOVE"),]);}
function onAdd(content){var lp=lpath.get();lp.content.push(content);lpath.set(lp);}
function onSort(){var lp=lpath.get();lp.content=R.map(R.prop('content_ref'),html_item_list_container.children);lpath.set(lp);}
function save(){lpath.send().then(function(result){m.route.set("/content/");});}
function view(){if(my_content_id==0)return m("p","Learning path editor requires content_id.");if(R.isNil(lpath.get()))return m("p","Loading...");return m(".lpath-ed",[Main.viewTop(),m(".dialog",[m(".title","Add and remove content from this path"),m("p","Click on an item to remove it. Drag items to re-order them. Be sure to click the save button to keep your changes."),m("button",{onclick:save},"Save"),m("br"),m(".stack.sortable",sortConfig,lpath.get().content.map(viewThumb)),m("br"),addContentAutocomplete(),]),Main.viewBottom(),]);}
return{view:view,oninit:oninit};};function LpathAddContent(onAdd){var content=St.use("content");content.fetch();var doing_msg=null;var myAutocomplete=Ut.autocomplete([{data:content,view:Content.viewThumb,callback:onAdd,getFilterText:function(x){return x.title;}}]);return function(){return[m("b","Type a title to add content to this path:"),myAutocomplete.view(),];}}
var LpathPlayer=function(){var lpath=null;var timerId=null;var content_id=0;function oninit(vnode){if(!m.route.param("content_id")){St.error="Learning path player summoned without a content_id.";content_id=0;return;}
content_id=vnode.attrs.content_id;lpath=St.use("content/"+content_id+"/lpath");lpath.fetch();}
function viewContent(){if(!lpath.get()){return"Loading...";}
var content=lpath.get().content;function click(c){m.route.set("/content/"+Ut.encodeId(c.content_id));}
return m(".cards",R.map(Content.viewThumb({onclick:click}),content));}
function view(){if(content_id==0)return m("p","Learning path player requires content_id.");return m(".lpath-player",[viewContent(),]);}
return{oninit:oninit,view:view,};};var CbmModel=function(){var content_id=0;var pages=[];var page_hashes=[];var quiz=[];var curpage=0;var edit_mode=false;var saved=false;function get_curhash(){if(edit_mode)return"q_"+curpage;return page_hashes[curpage];}
function q_correct_count(){var inc_if_correct=function(acc,val){return val.is_correct?R.inc(acc):acc;}
return R.reduce(inc_if_correct,0,quiz);}
function get_curq(){var q=R.find(R.propEq('hash',get_curhash()),quiz);return q?q:null;}
function upsert_q(ans_txt,is_correct){var q=get_curq();if(q){q.ans_txt=ans_txt;q.is_correct=is_correct;}else{q={hash:get_curhash(),ans_txt:ans_txt,is_correct:is_correct,};quiz.push(q);}
send_q(q);}
function qscore(){if(q_correct_count()==0)return 0;return Math.floor(q_correct_count()/quiz.length*100);}
function send_q(q){if(edit_mode)return;var person_id=Login.get('person_id');var is_correct=q.is_correct?"true":"false";var cbr=St.use('content/'+content_id+'/person/'+person_id+'/cb-record');var data={"page_hash":get_curhash(),"is_correct":is_correct,"answer":q.ans_txt};cbr.set(data);cbr.send();}
function save_score(){if(edit_mode||saved)return;var person_id=Login.get('person_id');var cr=St.use('content/'+content_id+'/person/'+person_id+'/record');cr.set({score:qscore()});cr.send();saved=true;}
function save_complete(){if(edit_mode||saved)return;var person_id=Login.get('person_id');var cr=St.use('content/'+content_id+'/person/'+person_id+'/record');cr.set({completed:"true"});cr.send();saved=true;}
function check_page(){if(curpage>=pages.length){pages[curpage]="New page\n\nThis is a new blank page.";}}
return{get_body:function(){return pages.join("\n--page--\n");},set_hashes:function(h){page_hashes=h;},set_body:function(b){var body=b?b:"New\n\nNew empty content.";pages=body.split("\n--page--\n");},set_content_id:function(cid){content_id=cid;},get_page:function(){check_page();return{num:curpage+1,body:pages[curpage],hash:get_curhash(),q:get_curq(),};},get_pagenum:function(){return curpage+1;},get_pagecount:function(){return pages.length;},get_qscore:qscore,get_qcount:function(){quiz.length;},get_qcorrect:q_correct_count,get_qincorrect:function(){return quiz.length-q_correct_count();},is_next:function(){return curpage<pages.length-1;},is_prev:function(){return curpage>0;},go_next:function(){if(curpage<pages.length-1||edit_mode){curpage++;}},go_prev:function(){if(curpage>0){curpage--;}},goto_start:function(){curpage=0;},edit_mode:function(){edit_mode=true;},is_edit_mode:function(){return edit_mode;},update_curpage:function(str){pages[curpage]=str;},appendto_curpage:function(str,pos){if(arguments.length==2){var s=pages[curpage];var beforeCursor=s.slice(0,pos);var afterCursor=s.slice(pos);pages[curpage]=s.slice(0,pos)+str+s.slice(pos);}
else{pages[curpage]+=str;}},answer_q:upsert_q,save_score:save_score,save_complete:save_complete,get_quiz:function(){return quiz;},};};var Cbm=null;var CbPlayer=function(){var content=null;var is_welcome=false;function oninit(vnode){Cbm=CbmModel();if(vnode.attrs.test_cb){Cbm.edit_mode();Cbm.set_body(vnode.attrs.test_cb);Cbm.goto_start();content={};return;}
if(!vnode.attrs.content){St.error="CbPlayer component not given content object.";return;}
content=vnode.attrs.content;is_welcome=false;is_welcome=vnode.attrs.is_welcome;var content_id=vnode.attrs.content.content_id;Cbm.set_content_id(content_id);var cb=St.use('content/'+content_id+'/cb');cb.fetch().then(function(data){if(!data)return;Cbm.set_body(data.body);Cbm.set_hashes(data.page_hashes);Cbm.goto_start();});}
function view(){if(!content)return m("p","Not valid.");function single_page(){return Cbm.get_pagenum()==1&&!Cbm.is_next();}
function prevbtn(){if(single_page())return null;if(Cbm.is_prev()){return m("button",{onclick:Cbm.go_prev},"Back");}
else{return m("button",{disabled:"disabled"},"Back");}}
function nextbtn(){if(single_page())return null;if(Cbm.is_next()){return m("button",{onclick:Cbm.go_next},"Next");}
else{return m("button",{disabled:"disabled"},"Next");}}
if(is_welcome){return m(".welcome",[m(".content-builder-player",[m(CbPage,Cbm),prevbtn(),nextbtn(),]),m(".welcome-bottom-bar"),]);}
return m(".dialog.content-builder-player",[m(".title",content.title),m(CbPage,Cbm),prevbtn(),m("span.message","Page "+Cbm.get_pagenum()+" of "+Cbm.get_pagecount()),nextbtn(),]);}
return{view:view,oninit:oninit,};};var CbEd=function(){var cb_api;var content_id=0;var image_uploader=null;var video_uploader=null;var audio_uploader=null;var attachment_uploader=null;var is_saved=true;var is_saving=false;var import_export_visible=false;var edit_area_element=null;var edit_area_cursor=0;var require_cursor_move=false;function oninit(){Cbm=CbmModel();if(!m.route.param("content_id")){St.error="Content editor summoned without a content_id.";content_id=0;return;}
content_id=Ut.decodeId(m.route.param("content_id"));Cbm.edit_mode();cb_api=St.use('content/'+content_id+'/cb');cb_api.fetch().then(function(data){if(!data)return;Cbm.set_body(data.body);Cbm.set_hashes(data.page_hashes);Cbm.goto_start();});image_uploader=Uploader({instructions:"Drop image here or click to upload.",purpose:"image",callback:function(d){insertTxt("<image/"+d.file_id+"/"+d.launch_fname+">");image_uploader.hide();is_saved=false;},});image_uploader.hide();audio_uploader=Uploader({instructions:"Drop MP3 audio file here or click to upload.",purpose:"audio",callback:function(d){insertTxt("\n<audio/"+d.file_id+"/"+d.launch_fname+">\n");audio_uploader.hide();is_saved=false;},});audio_uploader.hide();video_uploader=Uploader({instructions:"Drop MPEG4 video here or click to upload.",purpose:"video",callback:function(d){insertTxt("\n<video/"+d.file_id+"/"+d.launch_fname+">\n");video_uploader.hide();is_saved=false;},});video_uploader.hide();attachment_uploader=Uploader({instructions:"Drop file here or click to upload.",purpose:"attachment",callback:function(d){insertTxt("\n<attachment/"+d.file_id+"/"+d.launch_fname+">\n");attachment_uploader.hide();is_saved=false;},});attachment_uploader.hide();}
function save(andexit){is_saved=true;is_saving=true;var body=Cbm.get_body();var temp=cb_api.get();cb_api.set({body:body});cb_api.send().then(function(result){is_saving=false;if(andexit=="andexit"){m.route.set("/content/"+Ut.encodeId(content_id));}});}
function saveAndExit(){save("andexit");}
function quiz_hacker_view(){var quiz=Cbm.get_quiz();if(quiz.length<1)return null;return m(".cb-quiz-hacker-view",[m("h3","Quiz Inspector"),m("table",{style:{width:"100%"}},[m("thead",[m("tr",[m("th","Unique Question ID"),m("th","Ans Txt"),m("th","Correct?"),])]),R.map(function(q){return m("tr",[m("td",q.hash),m("td",q.ans_txt),m("td",q.is_correct),]);},quiz),]),m("br"),m("b","Score: "+Cbm.get_qscore()+"%"),]);}
function insertTxt(txt){var orig_pos=edit_area_element.selectionEnd;edit_area_cursor=orig_pos+txt.length;Cbm.appendto_curpage(txt,orig_pos);require_cursor_move=true;}
function pageUpdate(str){Cbm.update_curpage(str);is_saved=false;}
function toggleImportExport(){import_export_visible=!import_export_visible;}
function appendBtnClick(txt){return function(){insertTxt(txt);}}
function view(){if(content_id==0)return m("p","Content editor requires content_id.");var config_txt={oncreate:function(vnode){edit_area_element=vnode.dom;},onupdate:function(vnode){if(require_cursor_move){require_cursor_move=false;vnode.dom.setSelectionRange(edit_area_cursor,edit_area_cursor);}},oninput:m.withAttr("value",pageUpdate),};var page=Cbm.get_page();function prevbtn(){if(Cbm.is_prev()){return m("button",{onclick:Cbm.go_prev},"Back");}
else{return m("button",{disabled:"disabled"},"Back");}}
function nextbtn(create_at_end){if(Cbm.is_next()){return m("button",{onclick:Cbm.go_next},"Next");}
else{return m("button",{disabled:"disabled"},"Next");}}
function create_next(){if(Cbm.is_next())return null;return m("button.primary",{onclick:Cbm.go_next},"Add page");}
function view_save_state(){if(!is_saved){return m(".box.danger","Changes not saved");}
if(is_saving){return m(".box.info","Saving...");}
return null;}
var multi_correct=appendBtnClick("\n[_] Incorrect choice text\n");var multi_incorrect=appendBtnClick("\n[x] Correct choice text\n");var textfield=appendBtnClick("\n[text entry]");var correct_fbk=appendBtnClick("\n[correct feedback] Your correct feedback here");var incorrect_fbk=appendBtnClick("\n[incorrect feedback] Your incorrect feedback here");var score=appendBtnClick("\n[score]\n[save score]\n");var complete=appendBtnClick("\n[complete]\n");function button(onclick,icon,label){return m(".cb-btn",[m("button",{onclick:onclick},m("i.material-icons",icon)),m(".label",label),]);}
return m(".content-builder",[Main.viewTop(),m(".dialog.form",[m(".title","Content Builder"),m("p","Use the buttons below to add items to your content. Use the preview area below to see how the page will be rendered."),m(".cb-button-area",[m("div",[m("p","Display elements"),m(".cb-button-cluster",[button(image_uploader.toggle,"add_a_photo","Image"),button(audio_uploader.toggle,"audiotrack","Audio"),button(video_uploader.toggle,"videocam","Video"),button(attachment_uploader.toggle,"attach_file","Attachment"),]),]),m("div",[m("p","Quiz/survey elements"),m(".cb-button-cluster",[button(multi_correct,"radio_button_unchecked","Incorrect choice"),button(multi_incorrect,"radio_button_checked","Correct choice"),button(textfield,"edit","Text field"),button(correct_fbk,"check","Correct feedback"),button(incorrect_fbk,"close","Incorrect feedback"),button(score,"flag","Score"),button(complete,"flag","Complete"),]),]),]),image_uploader.view(),audio_uploader.view(),video_uploader.view(),attachment_uploader.view(),m("textarea",config_txt,page.body),m(".cb-bottom-button-area",[m(".cb-bottom-left",[prevbtn(),m("span.message","Page "+Cbm.get_pagenum()),nextbtn(),]),m(".cb-bottom-right",[create_next(),m("button.primary",{onclick:save},"Save"),m("button.primary",{onclick:saveAndExit},"Save and Exit"),view_save_state(),]),]),]),m(".dialog",[m(".title","Preview"),m(CbPage,Cbm),quiz_hacker_view(),prevbtn(),m("span.message","Page "+Cbm.get_pagenum()),nextbtn(),m("br.clear"),]),Main.viewBottom(),]);}
return{view:view,oninit:oninit,};};var CbPage=function(){var page="";var correct_ans=[];var ans_count=0;var text_entry_contents=stream("");var token_idx=0;var tokens=null;var in_list=false;function oninit(){}
function ans_txt(){Cbm.answer_q(text_entry_contents(),true);}
function add_correct_ans(num){correct_ans.push(num);correct_ans=R.uniq(correct_ans);}
function is_correct_ans(num){return R.contains(num,correct_ans);}
function ans_multi(text,num){return function(){var is_correct=is_correct_ans(num);Cbm.answer_q(text,is_correct);};}
var parse_objs=[{name:"normal",regex:null,func:function(t){return t.token;},},{name:"blank_line",regex:/\n\s*\n/,func:function(t){eat_blanks();if(token_idx>=tokens.length)return null;var type=tokens[token_idx].type;if(type=='link'||type=='normal'){return m("p",parse_until("blank_line|start_columns|column_split|end_columns|bullet|video|audio|radiobtn|text_entry|correct_feedback|incorrect_feedback"));}
return null;},},{name:"start_columns",regex:/<columns>/,func:function(t){return m(".cb-cols",[m(".col",parse_until("column_split")),m(".col",parse_until("end_columns")),]);},},{name:"column_split",regex:/<col>/,func:function(t){return null;},},{name:"end_columns",regex:/<end-columns>/,func:function(t){return null;},},{name:"bullet",regex:/(^\* |\n\* )/,func:function(t){var bullet=m("li",parse_until("bullet|blank_line"));if(in_list){return bullet;}
else{in_list=true;var bullets=parse_until("blank_line");bullets.unshift(bullet);in_list=false;return m("ul",bullets);}},},{name:"strong",regex:/\*\*(\S[^*]*\S)\*\*/,func:function(t){return m("strong",t.matches[0]);},},{name:"em",regex:/\*(\S[^*]*\S)\*/,func:function(t){var txt=t.matches[0];return m("em",t.matches[0]);},},{name:"link",regex:/<player\/(\d+):"(.*)">/,func:function(t){var id=t.matches[0];var title=t.matches[1];return m("a[href=/player/"+id+"]",{oncreate:m.route.link},title);},},{name:"image",regex:/<image\/(\d+)\/(.*)>/,func:function(t){var id=t.matches[0];var fname=t.matches[1];return m("img",{src:"/api/files/"+id+"/"+fname,});},},{name:"video",regex:/<video\/(\d+)\/(.*)>/,func:function(t){var id=t.matches[0];var fname=t.matches[1];return m(".video-player",m("video",{src:"/api/files/"+id+"/"+fname,controls:"controls",type:"video/mp4"},m("p","Your browser does not support the HTML5 video element.")));},},{name:"audio",regex:/<audio\/(\d+)\/(.*)>/,func:function(t){var id=t.matches[0];var fname=t.matches[1];return m(".audio-player",m("audio",{src:"/api/files/"+id+"/"+fname,controls:"controls"},m("p","Your browser does not support the HTML5 audio element.")));},},{name:"attachment",regex:/<attachment\/(\d+)\/(.*)>/,func:function(t){var id=t.matches[0];var fname=t.matches[1];return m("a.link",{href:"/api/files/"+id+"/"+fname,},fname);},},{name:"radiobtn",regex:/\[(X|x|_)\]\s*(.+)\n/,func:function(t){var correctness=(t.matches[0]=="x"||t.matches[0]=="X");var ans_txt=t.matches[1];ans_count++;if(correctness){add_correct_ans(ans_count);}
var checked=(page.q&&page.q.ans_txt==ans_txt);return m("label",[m("input",{type:'radio',name:'cbq_'+page.num,key:'cbq_'+page.num+'_'+ans_count,oncreate:function(x){x.checked=checked;},onclick:ans_multi(ans_txt,ans_count),}),m("span[class='checkable']",ans_txt),m("br"),]);},},{name:"text_entry",regex:/\[text entry\]/,func:function(t){return[m("input",{oninput:m.withAttr('value',text_entry_contents)}),m("button",{onclick:ans_txt},"Done"),];},},{name:"correct_feedback",regex:/\[correct feedback\]/,func:function(t){var txt=parse_until("blank_line|incorrect_feedback");if(page.q&&page.q.is_correct){return m(".box.success",txt);}},},{name:"incorrect_feedback",regex:/\[incorrect feedback\]/,func:function(t){var txt=parse_until("blank_line|correct_feedback");if(page.q&&!page.q.is_correct){return m(".box.danger",txt);}},},{name:"score",regex:/\[score\]/,func:function(t){return m("b",""+Cbm.get_qscore()+"%");},},{name:"save_score",regex:/\[save score\]/,func:function(t){if(Cbm.is_edit_mode()){return m("i","(save score: not sending score in edit mode)");}else{Cbm.save_score();}},},{name:"complete",regex:/\[complete\]/,func:function(t){if(Cbm.is_edit_mode()){return m("i","(complete: not sending completion status in edit mode)");}else{Cbm.save_complete();}},},];var patterns=R.reduce(function(acc,val){if(val.regex){acc[val.name]=val.regex;}
return acc;},{},parse_objs);var parsefuns=R.reduce(function(acc,val){acc[val.name]=val.func;return acc;},{},parse_objs);function eat_blanks(){while(tokens[token_idx]&&tokens[token_idx].type=="blank_line")
token_idx++;}
function found_ending(end_type,this_type){return R.contains(this_type,end_type.split('|'));}
var lvl=0;function parse_until(end_type){lvl++;var out=[];while(token_idx<tokens.length){var t=tokens[token_idx];if(found_ending(end_type,t.type)){lvl--;return out;}
token_idx++;out.push(parsefuns[t.type](t));}
return out;}
function view(){page=Cbm.get_page();correct_ans=[];ans_count=0;var output=[];tokens=Ut.tokenize(page.body,patterns,'normal');token_idx=0;eat_blanks();if(token_idx>=tokens.length)return m(".cb-page",m("i","This page intentionally left blank."));output.push(m("h1",tokens[token_idx].token));token_idx++;output=R.concat(output,parse_until("forever"));return m(".cb-page",output);}
return{view:view,oninit:oninit,};};var DiscussionPlayer=function(){var comments=null;var comments_ordered=null;var reply_to_id=null;var new_comment=stream();var new_reply=stream();var store;function oninit(vnode){if(vnode.attrs.test_discussion){comments=vnode.attrs.test_discussion;makeTree();return;}
if(!vnode.attrs.content_id)return null;var content_id=vnode.attrs.content_id;store=St.use("content/"+content_id+"/comments");store.fetch().then(function(){comments=store.get();makeTree()});}
function makeTree(){var grouped=[];var getAncestorId=function(c){if(!c.replies_to)return c.comment_id;return getAncestorId(R.find(R.propEq('comment_id',c.replies_to),comments));}
comments.forEach(function(c){if(c.group)return;c.group=getAncestorId(c);});var sort=function(a,b){if(a.group==b.group)return a.comment_id-b.comment_id;return a.group-b.group;}
comments_ordered=R.sort(sort,comments);}
function saveComment(replies_to){return function(){var body=new_comment();if(replies_to){body=new_reply();}
var c={body:body,replies_to:replies_to};store.set(c);store.send().then(function(response_data){c.comment_id=response_data.new_id;c.name=localStorage.getItem('name');c.thumb_file_id=localStorage.getItem('thumb_file_id');c.thumb_fname=localStorage.getItem('thumb_fname');c.created='Just now';comments.push(c);makeTree();reply_to_id=null;reply_to_name=null;new_comment("");new_reply("");});};}
function reply(c){return function(){reply_to_id=c.comment_id;reply_to_name=c.name;new_reply(reply_to_name+", ");}}
function viewReplyForm(reply_to){return m(".form.reply",[m("br"),m("textarea",{onchange:m.withAttr('value',new_reply)},new_reply()),m(".centered",m("button.primary",{onclick:saveComment(reply_to)},"Reply")),]);}
function viewNewCommentForm(){return m(".form",[m("textarea",{onchange:m.withAttr('value',new_comment)},new_comment()),m(".centered",m("button.primary",{onclick:saveComment(null)},"Add comment")),]);}
function viewComment(c){var indent=c.replies_to===null?'':'.indent';var body=[];var tokens=Ut.tokenize(c.body,{link:/<player\/\d+:"[^"]*">/},'normal');for(var i in tokens){var token=tokens[i];switch(token.type){case"normal":body.push(token.token);break;case"link":body.push(Ut.makeLink(token.token));break;}}
return m(".comment"+indent,[m(".avatar",People.viewAvatar(c)),m(".body",[m("a.reply-link.link",{onclick:reply(c)},"reply"),m(".name",c.name),m(".date",c.created),m("p",body),reply_to_id===c.comment_id?viewReplyForm(c.comment_id):null,]),]);}
function view(){if(comments_ordered===null)return m("p","Loading comments...");return m(".discussion-container",[m(".discussion",[m(".count","Comments ("+comments_ordered.length+")"),R.map(viewComment,comments_ordered),]),m("h3","Add a comment to the discussion"),viewNewCommentForm(null),]);}
return{view:view,oninit:oninit};};var Config=function(){var config=St.use("config");var logo_uploader=null;var show_logo_uploader=true;var css_uploader=null;var show_css_uploader=true;var show_css_changed_msg=false;function oninit(){config.fetch();logo_uploader=Uploader({instructions:"Drop logo image here or click to upload.",purpose:"site-logo",callback:function(result_data){var d=result_data;var c=config.get();c.logo_fname=d.launch_fname;c.logo_file_id=d.file_id;Main.loadSiteConfig();}});css_uploader=Uploader({instructions:"Drop CSS file here or click to upload.",purpose:"stylesheet",callback:function(result_data){show_css_changed_msg=true;}});}
function default_css(){var c=config.get();c.stylesheet_file_id=null;c.stylesheet_logo_fname=null;config.send().then(function(){show_css_changed_msg=true;});}
function save(){config.send().then(function(){Main.loadSiteConfig();m.route.set("/home/");});}
function view(){return[Main.viewTop(),m(".dialog",[m(".title","Configure LMS appearance and settings"),Main.customConfig('additional_interface'),m("h3","Current logo"),m(".logo-preview",Main.viewLogoImg()),m("h3","Upload new logo"),m("p","You can upload a new logo in .png, .jpg, or .gif formats.  It is recommended that your logo be approximately 40px tall."),show_logo_uploader?logo_uploader.view():null,m("h3","Custom title"),Ut.viewBoundInput("Web browser page title",config.prop('title')),m("br"),m("button",{onclick:save},"Save"),m("h3","Custom CSS stylesheet"),m("p","To make a custom stylesheet, it will be helpful to start with the default or current stylesheet.  After uploading a new stylesheet, the 'styleguide' page displays many of the UI elements of the LMS in one location for review."),m("a",{href:"/css/colors.css",target:"_blank"},"View default CSS"),m("br"),m("a",{href:"/api/config?prop=css",target:"_blank"},"View current CSS"),m("br"),m("a",{href:"/styleguide.html",target:"_blank"},"View the 'styleguide'"),m("br"),show_css_changed_msg?"Stylesheet updated. Refresh your browser to see the changes. (Note: you may need to use CTRL+F5 to 'hard refresh')":null,show_css_uploader?css_uploader.view():null,m("br"),m("button",{onclick:default_css},"Revert to default stylesheet"),]),Main.viewBottom(),];}
return{view:view,oninit:oninit};};var static_prefix="https://s3.amazonaws.com/static.perclms.com/common/ui/";var imgs={cb:static_prefix+"icon_cb.svg",comment:static_prefix+"icon_discussion.svg",lpath:static_prefix+"icon_lpath.svg",scorm:static_prefix+"icon_scorm.svg",default_logo:static_prefix+"default_logo.svg",default_thumb:static_prefix+"default_thumb.svg",default_avatar:static_prefix+"default_avatar.svg",ptag:static_prefix+"icon_ptag.svg",ctag:static_prefix+"icon_ctag.svg",uploader:static_prefix+"icon_uploader.svg",};var MainComponent=function(){var site_config=null;var me_menu_hidden=stream(true);loadSiteConfig();function loadSiteConfig(){var config=St.use("config");config.fetch().then(function(data){var c=config.get();site_config=c;document.title=c.title;});}
function customConfig(key){if(typeof CustomConfig=="undefined")return null;return CustomConfig.get(key);}
function siteConfig(){return site_config;}
function clearError(){St.error=null;}
function viewError(){if(!St.error)return null;return m(".error-box.danger",[m("button",{onclick:clearError},"Close"),St.error,]);}
function viewLogoImg(){var logosrc=imgs.default_logo;if(site_config&&site_config.logo_file_id){logosrc="/api/files/"+site_config.logo_file_id+"/"+site_config.logo_fname;}
return m('img',{src:logosrc});}
function viewTop(){function clickLogo(){var default_route=Login.is_logged_in()?"/home":"/login";m.route.set(default_route);}
return m(".top",[m(".topbar",[viewError(),m(".logo",{onclick:clickLogo},viewLogoImg()),m(".menubar",[viewMenu(),viewMe(),]),m(".border"),]),viewMeMenu(),]);}
function viewBottom(){return[m(".foot",""),];}
function viewMe(){if(!Login.is_logged_in())return null;var tid=Login.get('thumb_file_id');var path="/api/files/"+tid+"/"+Login.get('thumb_fname');var img=m("img.avatar",{src:path});if(!tid||tid=="null")img=m("i.material-icons","face");return m(".item.me",{onclick:Ut.toggleProp(me_menu_hidden)},[img,m("i.material-icons","arrow_drop_down"),]);}
function viewMeMenu(){if(!Login.is_logged_in())return null;if(me_menu_hidden())return null;return m(".me-menu",{onclick:Ut.toggleProp(me_menu_hidden)},[m("a.link.me-item",{href:"/people/me",oncreate:m.route.link},[m("i.material-icons","person"),m("span","Edit profile"),]),m("a.link.me-item",{onclick:Login.logout},[m("i.material-icons","exit_to_app"),m("span","Logout"),]),]);}
function viewMenu(){if(!Login.is_logged_in())return null;function make_route_link(r,title,icon,requires_admin){if(requires_admin&&!Login.is_admin())return null;var route_path_tail=/\/(\w+)/.exec(m.route.get());var current_route=route_path_tail?route_path_tail[1]:"";var curclass=(current_route==r?"current":"");return m(".item",{class:curclass,onclick:function(){m.route.set("/"+r)}},[m("i.material-icons",icon),m("b",title),]);}
return[make_route_link("home","Home","dashboard"),make_route_link("content","Content","folder","requires_admin"),make_route_link("people","People","people","requires_admin"),make_route_link("enroll","Enroll","assignment","requires_admin"),make_route_link("records","Records","insert_chart","requires_admin"),make_route_link("config","settings","settings","requires_admin"),];}
return{viewTop:viewTop,viewBottom:viewBottom,viewError:viewError,loadSiteConfig:loadSiteConfig,siteConfig:siteConfig,viewLogoImg:viewLogoImg,customConfig:customConfig,};};var Main=MainComponent();function NoTenant(){var box_style={width:"500px",margin:"2em auto",background:"white",borderRadius:"4px",boxShadow:"4px  4px 4px #CCC"};var head_style={background:"#666",color:"#FFF",fontSize:"30px",textAlign:"center",borderRadius:"4px 4px 0 0",padding:"1em"};var para_style={margin:"2em"};var logo_style={width:"300px",margin:"1em auto",display:"block"}
var imgsrc="https://s3.amazonaws.com/static.perclms.com/common/ui/default_logo.svg";function view(){return m(".box",{style:box_style},[m(".head",{style:head_style},"No LMS Here"),m("img",{src:imgsrc,style:logo_style}),m("p",{style:para_style},St.noTenantMessage),m("br"),]);}
return{view:view};}
var mrs=m.route.set;m.route.set=function(path,data,options){mrs(path,data,options);window.scrollTo(0,0);}
var mrl=m.route.link;m.route.link=function(vnode){mrl(vnode);window.scrollTo(0,0);}
var default_route=Login.is_logged_in()?"/home":"/login";m.route(document.body,default_route,{"/login":Login,"/home":Home,"/player/:content_id":Player,"/catalog":Catalog,"/change-pwd/:access_token":ChangePwd,"/forgot-pwd":ForgotPwd,"/content":Content,"/content/new/:type":ContentEd,"/content/:content_id":ContentViewer,"/content/:content_id/edit":ContentEd,"/content/:content_id/edit-cb":CbEd,"/content/:content_id/edit-scorm":ScormEd,"/content/:content_id/edit-lpath":LpathEd,"/people":People,"/people/metatags":PeopleMetaTags,"/people/new":PersonEd,"/people/import":PeopleImport,"/people/:person_id":PersonEd,"/enroll":Erules,"/records":Records,"/records/edit":RecordEdit,"/records/edit/person/:person_id/content/:content_id":RecordEdit,"/records/content":RecordContent,"/records/people":RecordPeople,"/records/cb":RecordCb,"/records/cb/:content_id":RecordCb,"/records/content/:content_id":RecordContent,"/records/people/:person_id":RecordPeople,"/config":Config,"/no-tenant":NoTenant,});
var CustomConfig=(function(){function get(key){if(key=="additional_interface"){return[m("h3","Payment options"),m("a",{href:"/billing/"},"Edit or add payment method"),];}
return Main.siteConfig()[key];}
return{get:get};})();